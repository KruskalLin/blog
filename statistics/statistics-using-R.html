
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>statistics using R Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="statistics-formulas.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="./">
            
                <a href="./">
            
                    
                    STATISTICS
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="2.1.1" data-path="statistics-using-R.html">
            
                <a href="statistics-using-R.html">
            
                    
                    statistics using R
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="statistics-formulas.html">
            
                <a href="statistics-formulas.html">
            
                    
                    statistics formulas
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../computer-vision/">
            
                <a href="../computer-vision/">
            
                    
                    COMPUTER VISION
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="../computer-vision/lane-detection.html">
            
                <a href="../computer-vision/lane-detection.html">
            
                    
                    lane detection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="../computer-vision/stereo-matching.html">
            
                <a href="../computer-vision/stereo-matching.html">
            
                    
                    stereo matching
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="../computer-vision/lidar-fusion.html">
            
                <a href="../computer-vision/lidar-fusion.html">
            
                    
                    lidar fusion
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.4" data-path="../computer-vision/segmentation.html">
            
                <a href="../computer-vision/segmentation.html">
            
                    
                    segmentation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.5" data-path="../computer-vision/DCNN.html">
            
                <a href="../computer-vision/DCNN.html">
            
                    
                    DCNN
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../data-mining/">
            
                <a href="../data-mining/">
            
                    
                    DATA MINING
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../data-mining/text-mining-procedure.html">
            
                <a href="../data-mining/text-mining-procedure.html">
            
                    
                    text mining procedure
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../neural-network/">
            
                <a href="../neural-network/">
            
                    
                    NEURAL NETWORK
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1" data-path="../neural-network/neural-network.html">
            
                <a href="../neural-network/neural-network.html">
            
                    
                    neural network
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2" data-path="../neural-network/nonconvex-optimization.html">
            
                <a href="../neural-network/nonconvex-optimization.html">
            
                    
                    nonconvex optimization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.3" data-path="../neural-network/neural-attack.html">
            
                <a href="../neural-network/neural-attack.html">
            
                    
                    neural attack
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../miscellaneous/">
            
                <a href="../miscellaneous/">
            
                    
                    MISCELLANEOUS
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1.1" data-path="../miscellaneous/images-loading.html">
            
                <a href="../miscellaneous/images-loading.html">
            
                    
                    images loading
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.2" data-path="../miscellaneous/convert-mathjax.html">
            
                <a href="../miscellaneous/convert-mathjax.html">
            
                    
                    convert mathjax
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.3" data-path="../miscellaneous/hashmap.html">
            
                <a href="../miscellaneous/hashmap.html">
            
                    
                    hashmap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.4" data-path="../miscellaneous/linkedhashmap.html">
            
                <a href="../miscellaneous/linkedhashmap.html">
            
                    
                    linkedhashmap
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >statistics using R</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p>&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x5C0F;&#x7684;R&#x6316;&#x6398;&#x7EFC;&#x8FF0;</p>
<h2 id="&#x83B7;&#x53D6;&#x6570;&#x636E;">&#x83B7;&#x53D6;&#x6570;&#x636E;</h2>
<p>&#x83B7;&#x53D6; <img src="https://latex.codecogs.com/gif.latex?Excel" alt="formula"> &#x6570;&#x636E;</p>
<pre><code class="lang-R">&gt; <span class="hljs-keyword">library</span>(readxl)
&gt; data &lt;- read_excel(<span class="hljs-string">&quot;data/xxx.xlsx&quot;</span>)
&gt; View(data)
</code></pre>
<p>&#x83B7;&#x53D6; <img src="https://latex.codecogs.com/gif.latex?CSV" alt="formula"> &#x6570;&#x636E;&#xFF08;&#x8F6C;&#x6362;&#x5F97;&#x5230;&#xFF0C;&#x65B9;&#x4FBF;&#x89E3;&#x51B3;&#x4E00;&#x4E9B;&#x4EE5;&#x524D;&#x7248;&#x672C;&#x6587;&#x4EF6;ANSI&#x7F16;&#x7801;&#x95EE;&#x9898;&#xFF09;</p>
<pre><code class="lang-R">&gt; <span class="hljs-keyword">library</span>(readr)
&gt; data &lt;- read_csv(<span class="hljs-string">&quot;data/xxx.csv&quot;</span>)
&gt; View(data)
</code></pre>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;4&#x4EFD;&#x6570;&#x636E;&#x4EE5;&#x4EE5;&#x4E0B;&#x5F62;&#x5F0F;&#x5448;&#x73B0;</p>
<table>
<thead>
<tr>
<th>&#x8EAB;&#x9AD8;&#xFF08;cm&#xFF09;</th>
<th>&#x81C2;&#x5C55;&#xFF08;cm&#xFF09;</th>
<th>&#x811A;&#x957F;&#xFF08;cm&#xFF09;</th>
<th>&#x817F;&#x957F;&#xFF08;cm&#xFF09;</th>
<th>&#x4F53;&#x91CD;&#xFF08;kg&#xFF09;</th>
</tr>
</thead>
<tbody>
<tr>
<td>178.0</td>
<td>166.0</td>
<td>26.0</td>
<td>106</td>
<td>70.5</td>
</tr>
<tr>
<td>171.0</td>
<td>172.0</td>
<td>25.5</td>
<td>95</td>
<td>57.0</td>
</tr>
</tbody>
</table>
<p>&#x4E3A;&#x4E86;&#x4F7F;&#x7528;&#x65B9;&#x4FBF;&#x91CD;&#x547D;&#x540D;&#x4E3A;</p>
<table>
<thead>
<tr>
<th>height</th>
<th>armSpan</th>
<th>footLength</th>
<th>legLength</th>
<th>weight</th>
</tr>
</thead>
<tbody>
<tr>
<td>178.0</td>
<td>166.0</td>
<td>26.0</td>
<td>106</td>
<td>70.5</td>
</tr>
<tr>
<td>171.0</td>
<td>172.0</td>
<td>25.5</td>
<td>95</td>
<td>57.0</td>
</tr>
</tbody>
</table>
<h2 id="&#x57FA;&#x672C;&#x4FE1;&#x606F;&#x4E0E;&#x7EDF;&#x8BA1;&#x91CF;">&#x57FA;&#x672C;&#x4FE1;&#x606F;&#x4E0E;&#x7EDF;&#x8BA1;&#x91CF;</h2>
<h3 id="&#x4F4D;&#x7F6E;&#x7684;&#x5EA6;&#x91CF;">&#x4F4D;&#x7F6E;&#x7684;&#x5EA6;&#x91CF;</h3>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x7684;&#x7EDF;&#x8BA1;&#x91CF;&#x5305;&#x62EC;&#x6700;&#x5C0F;&#x503C;&#x3001;&#x6700;&#x5927;&#x503C;&#x3001;&#x7B2C;&#x4E00;&#x3001;&#x7B2C;&#x4E09;&#x56DB;&#x5206;&#x4F4D;&#x6570;&#x3001;&#x4E2D;&#x4F4D;&#x6570;&#x3001;&#x5747;&#x503C;</p>
</blockquote>
<p>&#x5229;&#x7528;R&#x4E2D;&#x7684;&#x51FD;&#x6570;</p>
<pre><code class="lang-R">&gt; summary(data)
</code></pre>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6570;&#x636E;&#x6BCF;&#x4E00;&#x5217;&#x7684;&#x4FE1;&#x606F;</p>
<p>&#x8FD9;&#x91CC;&#x4E0D;&#x7ED9;&#x51FA;&#xFF08;&#x9690;&#x79C1;&#x4FDD;&#x62A4;&#xFF09;</p>
<p>&#x8FD9;&#x91CC;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;<code>quantile</code>&#x3001;<code>mean</code>&#x3001;<code>median</code>&#x7B49;&#x51FD;&#x6570;&#xFF0C;&#x6BD4;&#x5982;</p>
<pre><code class="lang-R">&gt; quntile(girls2015$height)
</code></pre>
<p> &#x53EF;&#x4EE5;&#x5F97;&#x5230;</p>
<table>
<thead>
<tr>
<th>&#x5206;&#x4F4D;&#x6570;</th>
<th>0%</th>
<th>25%</th>
<th>50%</th>
<th>75%</th>
<th>100%</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x6570;&#x503C;</td>
<td>153</td>
<td>163</td>
<td>165</td>
<td>170</td>
<td>174</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>&#x4ECE;<code>summary</code>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6CA1;&#x6709;&#x7F3A;&#x5931;&#x503C;&#xFF0C;&#x4F46;&#x4E5F;&#x53EF;&#x4EE5;&#x5F88;&#x5FEB;&#x7684;&#x770B;&#x5230;&#x6709;&#x5F02;&#x5E38;&#x503C;&#xFF08;&#x8B6C;&#x5982;2015&#x7537;&#x751F;&#x811A;&#x957F;&#x9879;&#x6709;100cm&#xFF0C;&#x662F;&#x4E0D;&#x7B26;&#x5408;&#x5E38;&#x7406;&#x7684;&#xFF09;&#xFF0C;&#x6709;&#x6570;&#x636E;&#x683C;&#x5F0F;&#x4E0D;&#x4E00;&#x7684;&#x503C;&#xFF08;2015&#x5973;&#x751F;&#x7684;&#x811A;&#x957F;&#x5355;&#x4F4D;&#x4E3A;mm&#xFF09;&#x7B49;</p>
<p>&#x7EDF;&#x4E00;&#x91CF;&#x7EB2;&#x540E;</p>
<p><code>2015&#x5973;&#x751F;</code></p>
<p>&#x8FD9;&#x91CC;&#x4E0D;&#x7ED9;&#x51FA;&#xFF08;&#x9690;&#x79C1;&#x4FDD;&#x62A4;&#xFF09;</p>
<p><strong>&#x7C97;&#x7565;&#x7684;&#x7ED3;&#x8BBA;&#xFF1A;</strong>&#x6211;&#x4EEC;&#x4ECE;&#x4E0A;&#x8FF0;&#x7684;&#x7EDF;&#x8BA1;&#x91CF;&#x53EF;&#x4EE5;&#x4F30;&#x8BA1;&#xFF0C;2015&#x5E74;&#x7537;&#x751F;&#x548C;2018&#x5E74;&#x7537;&#x751F;&#x3001;2015&#x5E74;&#x5973;&#x751F;&#x548C;2018&#x5E74;&#x5973;&#x751F;&#x5404;&#x7C7B;&#x6570;&#x503C;&#x5DEE;&#x522B;&#x4E0D;&#x5927;&#xFF08;&#x9664;&#x4E86;&#x53EF;&#x80FD;&#x7684;&#x5F02;&#x5E38;&#x503C;&#xFF09;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x5F88;&#x53EF;&#x80FD;&#x5206;&#x5E03;&#x4E00;&#x81F4;&#xFF0C;&#x53E6;&#x5916;&#x6240;&#x6709;&#x7684;&#x6570;&#x636E;&#x5747;&#x4E3A;&#x8FDE;&#x7EED;&#x503C;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8FDE;&#x7EED;&#x53D8;&#x91CF;&#x4E2D;&#x7684;<strong>&#x533A;&#x95F4;&#x53D8;&#x91CF;</strong>&#xFF0C;&#x4E0B;&#x65B9;&#x7684;&#x5206;&#x6790;&#x7701;&#x7565;&#x5BF9;&#x5206;&#x7C7B;&#x53D8;&#x91CF;&#x4EE5;&#x53CA;&#x5176;&#x4ED6;&#x8FDE;&#x7EED;&#x53D8;&#x91CF;&#x7684;&#x8003;&#x5BDF;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x4F4D;&#x7F6E;&#x7684;&#x8003;&#x5BDF;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x76F4;&#x65B9;&#x56FE;&#x3001;&#x6838;&#x5BC6;&#x5EA6;&#x4F30;&#x8BA1;&#x56FE;&#x6765;&#x8003;&#x5BDF;&#xFF0C;&#x4E4B;&#x540E;&#x7684;&#x5206;&#x5E03;&#x4F30;&#x8BA1;&#x4E5F;&#x4F1A;&#x7528;&#x5230;&#x3002;&#x8B6C;&#x5982;&#x5BF9;&#x4E8E;2018&#x5E74;&#x7537;&#x751F;&#x7684;&#x8EAB;&#x9AD8;</p>
<pre><code class="lang-R">&gt; hist(boys2018$height, freq=<span class="hljs-literal">FALSE</span>)
&gt; lines(density(boys2018$height), col = <span class="hljs-string">&quot;red&quot;</span>)
</code></pre>
<p><img src="img/boys2018height.png" alt="boys2015height"></p>
<h3 id="&#x5206;&#x6563;&#x7A0B;&#x5EA6;&#x548C;&#x5206;&#x5E03;&#x5F62;&#x72B6;&#x7684;&#x5EA6;&#x91CF;">&#x5206;&#x6563;&#x7A0B;&#x5EA6;&#x548C;&#x5206;&#x5E03;&#x5F62;&#x72B6;&#x7684;&#x5EA6;&#x91CF;</h3>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x65B9;&#x5DEE;&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?S%5E2%20%3D%20%5Cfrac%7B1%7D%7Bn-1%7D%20%5Csum_%7Bi%3D1%7D%5En%7B%28x_i-%5Coverline%7Bx%7D%29%7D" alt="formula"></p>
<p>&#x504F;&#x5EA6;&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?G%3D%5Cfrac%7Bn%7D%7B%28n-1%29%28n-2%29s%5E2%7D%20%5Csum_%7Bi%3D1%7D%5En%7B%28x_i-%5Coverline%7Bx%7D%29%5E3%7D" alt="formula"></p>
<p>&#x5CF0;&#x5EA6;&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?K%3D%5Cfrac%7Bn%28n%2B1%29%7D%7B%28n-1%29%28n-2%29%28n-3%29s%5E4%7D%20%5Csum_%7Bi%3D1%7D%5En%7B%28x_i-%5Coverline%7Bx%7D%29%5E4%7D-3%5Cfrac%7B%28n-1%29%5E2%7D%7B%28n-2%29%28n-3%29%7D" alt="formula"></p>
</blockquote>
<p>&#x901A;&#x8FC7;&#x51FD;&#x6570;<code>var</code>&#x3001;<code>sd</code>&#x3001;<code>skewness</code>&#x3001;<code>kurtosis</code>&#x5206;&#x522B;&#x6C42;&#x5F97;&#x65B9;&#x5DEE;&#x3001;&#x6807;&#x51C6;&#x5DEE;&#x3001;&#x504F;&#x5EA6;&#x3001;&#x5CF0;&#x5EA6;&#xFF0C;&#x8FD9;&#x91CC;&#x7531;&#x4E8E;&#x4E0D;&#x901A;&#x8FC7;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#x5BF9;&#x6570;&#x636E;&#x9884;&#x5904;&#x7406;&#xFF0C;&#x4E0D;&#x5217;&#x51FA;&#x5168;&#x90E8;&#x6570;&#x636E;&#x3002;&#x8B6C;&#x5982;&#x5BF9;2015&#x5E74;&#x7537;&#x751F;</p>
<pre><code class="lang-R">&gt; apply(boys2015, <span class="hljs-number">2</span>, var)
</code></pre>
<p><code>2015&#x7537;&#x751F;</code></p>
<table>
<thead>
<tr>
<th></th>
<th>height</th>
<th>armSpan</th>
<th>footLength</th>
<th>legLength</th>
<th>weight</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x65B9;&#x5DEE;</td>
<td>39.26</td>
<td>1012.37</td>
<td>68.27</td>
<td>138.64</td>
<td>95.73</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;2015&#x5E74;&#x7537;&#x751F;&#x7684;&#x81C2;&#x5C55;&#x65B9;&#x5DEE;&#x975E;&#x5E38;&#x5927;&#xFF0C;&#x7B26;&#x5408;&#x4E4B;&#x524D;&#x7684;&#x89C2;&#x5BDF;&#xFF0C;&#x5373;&#x5B58;&#x5728;&#x5F02;&#x5E38;&#x503C;</p>
<p>&#x5BF9;&#x4E8E;&#x5206;&#x6563;&#x7A0B;&#x5EA6;&#x7684;&#x8003;&#x5BDF;&#xFF0C;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x830E;&#x53F6;&#x56FE;&#x3001;&#x7BB1;&#x578B;&#x56FE;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x9488;&#x5BF9;&#x5728;&#x4F4D;&#x7F6E;&#x5EA6;&#x91CF;&#x4E2D;&#x89C2;&#x5BDF;&#x5230;&#x7684;&#x5F02;&#x5E38;&#x6570;&#x636E;&#xFF08;&#x5927;&#x90E8;&#x5206;&#x4E3A;2015&#x5E74;&#x7684;&#x7537;&#x751F;&#x6570;&#x636E;&#xFF09;&#x753B;&#x51FA;&#x5BF9;&#x5E94;&#x7684;&#x830E;&#x53F6;&#x56FE;&#x548C;&#x7BB1;&#x578B;&#x56FE;(&#x8FD9;&#x91CC;&#x53EA;&#x5217;&#x51FA;&#x4E00;&#x90E8;&#x5206;)</p>
<p>&#x830E;&#x53F6;&#x56FE;&#x5229;&#x7528;</p>
<pre><code class="lang-R">&gt; stem(boys2015$xxx)
</code></pre>
<p><code>2015&#x7537;&#x751F;&#x81C2;&#x5C55;&#x830E;&#x53F6;&#x56FE;</code></p>
<pre><code>&#x8FD9;&#x91CC;&#x4E0D;&#x7ED9;&#x51FA;&#xFF08;&#x9690;&#x79C1;&#x4FDD;&#x62A4;&#xFF09;
</code></pre><p>&#x7BB1;&#x578B;&#x56FE;&#x5219;&#x5229;&#x7528;</p>
<pre><code>boxplot(boys2015$xxx)
</code></pre><p><code>2015&#x7537;&#x751F;&#x81C2;&#x5C55;&#x7BB1;&#x578B;&#x56FE;</code>
<img src="img/boys2015armSpan.png" alt="boys2015armSpan"></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x4E0D;&#x540C;&#x7684;&#x65B9;&#x6CD5;&#x7684;&#x51FA;&#x7684;&#x76F4;&#x89C2;&#x7ED3;&#x679C;&#x57FA;&#x672C;&#x4E00;&#x81F4;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x5BF9;&#x4E8E;2015&#x7537;&#x751F;&#x7684;<strong>&#x811A;&#x957F;&#x3001;&#x81C2;&#x5C55;&#x3001;&#x817F;&#x957F;</strong>&#xFF0C;&#x5176;&#x6570;&#x636E;&#x5F02;&#x5E38;&#x503C;&#x53EF;&#x4EE5;&#x5F88;&#x76F4;&#x89C2;&#x7684;&#x83B7;&#x53D6;&#xFF0C;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x5F02;&#x5E38;&#x503C;&#x7684;&#x53BB;&#x9664;</p>
<p><code>&#x4E00;&#x822C;&#x60C5;&#x51B5;&#x4E0B;&#x7684;&#x6570;&#x636E;&#x6E05;&#x6D17;&#x8FD8;&#x9700;&#x8981;&#x91CD;&#x590D;&#x6570;&#x636E;&#x68C0;&#x6D4B;&#x6216;&#x8005;&#x6570;&#x636E;&#x53D8;&#x6362;&#xFF0C;&#x8FD9;&#x91CC;&#x7531;&#x4E8E;&#x662F;&#x8FDE;&#x7EED;&#x53D8;&#x91CF;&#x4E14;&#x6CA1;&#x6709;&#x91CD;&#x590D;&#x6570;&#x636E;&#xFF0C;&#x4E0D;&#x9700;&#x8981;</code></p>
<h2 id="&#x5F02;&#x5E38;&#x503C;&#x53BB;&#x9664;">&#x5F02;&#x5E38;&#x503C;&#x53BB;&#x9664;</h2>
<h3 id="&#x5355;&#x5C5E;&#x6027;outlier">&#x5355;&#x5C5E;&#x6027;outlier</h3>
<p>&#x9488;&#x5BF9;&#x5355;&#x503C;&#x5219;&#x4EE5;2015&#x7537;&#x751F;&#x7684;<strong>&#x811A;&#x957F;</strong>&#x4E3A;&#x4F8B;</p>
<h4 id="&#x7BB1;&#x7EBF;&#x56FE;&#x622A;&#x65AD;"><a href="">&#x7BB1;&#x7EBF;&#x56FE;&#x622A;&#x65AD;</a></h4>
<blockquote>
<p>&#x6BD4;&#x8F83;&#x7ECF;&#x5178;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5373;&#x5254;&#x9664;&#x5355;&#x503C; <img src="https://latex.codecogs.com/gif.latex?Q_1-1.5IQR" alt="formula"> &#x4E0E; <img src="https://latex.codecogs.com/gif.latex?Q_3%20%2B%201.5IQR" alt="formula"> &#x4E4B;&#x5916;&#x7684;&#x503C;&#xFF0C;&#x5176;&#x4E2D; <img src="https://latex.codecogs.com/gif.latex?IQR%20%3D%20Q_3%20-%20Q_1" alt="formula"></p>
</blockquote>
<pre><code class="lang-R">&gt; filboys2015 &lt;- boys2015 %&gt;% filter((footLength&lt;(quantile(footLength, <span class="hljs-number">0.75</span>)+<span class="hljs-number">1.5</span>*(quantile(footLength, <span class="hljs-number">0.75</span>)-quantile(footLength, <span class="hljs-number">0.25</span>))))&amp;(footLength&gt;(quantile(footLength, <span class="hljs-number">0.25</span>)-<span class="hljs-number">1.5</span>*(quantile(footLength, <span class="hljs-number">0.75</span>)-quantile(footLength, <span class="hljs-number">0.25</span>)))))
</code></pre>
<p>&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<code>summary</code>&#x51FD;&#x6570;&#x770B;&#x5230;&#x66F4;&#x65B0;&#x540E;&#x7684;&#x7ED3;&#x679C;</p>
<table>
<thead>
<tr>
<th></th>
<th>&#x6700;&#x5C0F;&#x503C;</th>
<th>&#x7B2C;&#x4E00;&#x56DB;&#x5206;&#x4F4D;&#x6570;</th>
<th>&#x4E2D;&#x4F4D;&#x6570;</th>
<th>&#x7B2C;&#x4E09;&#x56DB;&#x5206;&#x4F4D;&#x6570;</th>
<th>&#x6700;&#x5927;&#x503C;</th>
<th>&#x5E73;&#x5747;&#x503C;</th>
</tr>
</thead>
<tbody>
<tr>
<td>footLength</td>
<td>23</td>
<td>25</td>
<td>26</td>
<td>27</td>
<td>29</td>
<td>25.76</td>
</tr>
</tbody>
</table>
<h4 id="pauta-criterion"><a href="">Pauta Criterion</a></h4>
<blockquote>
<p>&#x6BD4;&#x8F83;&#x7ECF;&#x5178;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5373; <img src="https://latex.codecogs.com/gif.latex?3%5Csigma" alt="formula"> &#x539F;&#x5219;&#xFF0C;&#x5254;&#x9664;&#x5355;&#x503C; <img src="https://latex.codecogs.com/gif.latex?%5Cmu%20%5Cpm%203%5Csigma" alt="formula"> &#x4E4B;&#x5916;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x8981;&#x6C42;&#x6837;&#x672C;&#x81F3;&#x5C11;&#x4E3A;10</p>
</blockquote>
<pre><code class="lang-R">&gt; filboys2015 &lt;- boys2015 %&gt;% filter((footLength&lt;(mean(footLength)+<span class="hljs-number">3</span>*sd(footLength)))&amp;(footLength&gt;(mean(footLength)-<span class="hljs-number">3</span>*sd(footLength))))
</code></pre>
<p>&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<code>summary</code>&#x51FD;&#x6570;&#x770B;&#x5230;&#x66F4;&#x65B0;&#x540E;&#x7684;&#x7ED3;&#x679C;</p>
<table>
<thead>
<tr>
<th></th>
<th>&#x6700;&#x5C0F;&#x503C;</th>
<th>&#x7B2C;&#x4E00;&#x56DB;&#x5206;&#x4F4D;&#x6570;</th>
<th>&#x4E2D;&#x4F4D;&#x6570;</th>
<th>&#x7B2C;&#x4E09;&#x56DB;&#x5206;&#x4F4D;&#x6570;</th>
<th>&#x6700;&#x5927;&#x503C;</th>
<th>&#x5E73;&#x5747;&#x503C;</th>
</tr>
</thead>
<tbody>
<tr>
<td>footLength</td>
<td>21</td>
<td>25</td>
<td>26</td>
<td>27</td>
<td>30</td>
<td>25.7</td>
</tr>
</tbody>
</table>
<h4 id="grubbs-criterion"><a href="">Grubbs Criterion</a></h4>
<blockquote>
<p>&#x9ED8;&#x8BA4;&#x68C0;&#x6D4B;&#x7684;&#x5355;&#x503C;&#x662F;<strong>&#x6B63;&#x6001;&#x5206;&#x5E03;</strong>&#xFF0C;&#x5229;&#x7528;&#x5047;&#x8BBE;&#x68C0;&#x9A8C;&#x8FDB;&#x884C;&#x5355;&#x503C;&#x5254;&#x9664;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x5C31;&#x662F;&#x68C0;&#x9A8C;&#x4E0E;&#x4E0E;&#x5747;&#x503C;&#x7684;&#x5DEE;&#x5F02;&#xFF0C;&#x7C7B;&#x4F3C;&#x7684;&#x8FD8;&#x6709;<a href="">Dixon</a>&#x68C0;&#x9A8C;&#x7B49;</p>
<p>&#x8BBE; <img src="https://latex.codecogs.com/gif.latex?G%3D%5Cfrac%7Bmax%28%7Cx_i-%5Coverline%7Bx%7D%7C%29%7D%7B%5Csigma%7D" alt="formula"></p>
<p>&#x62D2;&#x7EDD;&#x57DF; <img src="https://latex.codecogs.com/gif.latex?%5Cchi_0%3D%5C%7BG%3E%5Cfrac%7BN-1%7D%7B%5Csqrt%7BN%7D%7D%5Csqrt%7B%5Cfrac%7Bt%5E2%28N-2%29%7D%7BN-2%2Bt%5E2%28N-2%29%7D%7D%5C%7D" alt="formula">  &#x5176;&#x4E2D;&#x663E;&#x8457;&#x6027;&#x6C34;&#x5E73; <img src="https://latex.codecogs.com/gif.latex?a%20%3D%20%5Cfrac%7B%5Calpha%7D%7B2N%7D" alt="formula"> &#xFF0C; <img src="https://latex.codecogs.com/gif.latex?N" alt="formula"> &#x4E3A;&#x603B;&#x6570;&#x91CF;&#xFF0C;<img src="https://latex.codecogs.com/gif.latex?%5Calpha" alt="formula"> &#x4E3A;&#x81EA;&#x5DF1;&#x5B9A;&#x4E49;&#x7684;&#x663E;&#x8457;&#x6027;</p>
</blockquote>
<pre><code class="lang-R">&gt; grubbs.test(boys2015$footLength)
</code></pre>
<p>&#x5F97;&#x5230;&#x7ED3;&#x679C;</p>
<pre><code>    Grubbs test for one outlier

data:  boys2015$footLength
G = 8.885000, U = 0.037419, p-value &lt; 2.2e-16
alternative hypothesis: highest value 100 is an outlier
</code></pre><p>&#x53EF;&#x89C1;&#x68C0;&#x6D4B;&#x51FA;&#x4E86;&#x5F02;&#x5E38;&#x503C;</p>
<h3 id="&#x591A;&#x5C5E;&#x6027;outlier">&#x591A;&#x5C5E;&#x6027;outlier</h3>
<h4 id="&#x7BB1;&#x7EBF;&#x56FE;&#x622A;&#x65AD;"><a href="">&#x7BB1;&#x7EBF;&#x56FE;&#x622A;&#x65AD;</a></h4>
<blockquote>
<p>&#x5B9E;&#x9645;&#x4E0A;&#x5C31;&#x662F;&#x5C06;&#x4E24;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x4EE5;&#x4E0A;&#x7684;&#x7BB1;&#x7EBF;&#x56FE;&#x4EE5;&#x903B;&#x8F91;&#x4E0E;&#x6216;&#x8005;&#x903B;&#x8F91;&#x6216;&#x7684;&#x65B9;&#x5F0F;&#x7EC4;&#x5408;&#xFF0C;&#x8FC7;&#x6EE4;&#x65B9;&#x5F0F;&#x7C7B;&#x540C;&#x4E8E;&#x5355;&#x5C5E;&#x6027;</p>
</blockquote>
<pre><code class="lang-R">&gt; df&lt;-data.frame(boys2015$legLength,boys2015$armSpan)
&gt; tmp1&lt;-which(boys2015$legLength %<span class="hljs-keyword">in</span>% boxplot.stats(boys2015$legLength)$out) 
&gt; tmp2&lt;-which(boys2015$armSpan %<span class="hljs-keyword">in</span>% boxplot.stats(boys2015$armSpan)$out)
&gt; u1&lt;-union(tmp1,tmp2)
&gt; plot(df) 
&gt; points(df[u1,],col=<span class="hljs-string">&quot;red&quot;</span>,pch=<span class="hljs-string">&quot;x&quot;</span>,cex=<span class="hljs-number">2</span>) <span class="hljs-comment"># &#x6807;&#x51FA;&#x5F02;&#x5E38;&#x503C;&#x70B9;</span>
</code></pre>
<p><img src="img/outlier.png" alt="outlier"></p>
<h4 id="&#x57FA;&#x4E8E;&#x8DDD;&#x79BB;&#x7684;&#x5254;&#x9664;"><a href="">&#x57FA;&#x4E8E;&#x8DDD;&#x79BB;&#x7684;&#x5254;&#x9664;</a></h4>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x8DDD;&#x79BB;&#x4F7F;&#x7528;<a href="">Mahalanobis Distance</a>&#xFF0C;&#x5F53;&#x7136;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a href="">Euclidean Distance</a>&#x3001;<a href="">&#x4F59;&#x5F26;&#x8DDD;&#x79BB;</a>&#x7B49;&#xFF0C;&#x5177;&#x4F53;&#x89C1;<a href="">&#x805A;&#x7C7B;&#x5206;&#x6790;</a></p>
<p><a href="">Mahalanobis Distance</a>&#x4E3B;&#x8981;&#x8BA1;&#x7B97;&#x7684;&#x662F;&#x6837;&#x672C;&#x4E4B;&#x95F4;&#x7684;&#x534F;&#x65B9;&#x5DEE;&#x8DDD;&#x79BB;&#xFF0C;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x4E3A;&#x4E24;&#x4E2A;&#x670D;&#x4ECE;&#x540C;&#x4E00;&#x5206;&#x5E03;&#x5E76;&#x4E14;&#x5176;&#x534F;&#x65B9;&#x5DEE;&#x77E9;&#x9635;&#x4E3A;&#x3A3;&#x7684;&#x968F;&#x673A;&#x53D8;&#x91CF;&#x4E4B;&#x95F4;&#x7684;&#x5DEE;&#x5F02;&#x7A0B;&#x5EA6;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;&#x5254;&#x9664;&#x662F;&#x57FA;&#x4E8E;&#x5206;&#x5E03;&#x7684;&#xFF0C;&#x5177;&#x4F53;&#x7B97;&#x6CD5;&#x8BE6;&#x89C1;<a href="https://e-archivo.uc3m.es/bitstream/handle/10016/15548/multivariate_prieto_TECHNOMETRICS_2001_ps.pdf?sequence=1" target="_blank">&#x8BBA;&#x6587;</a></p>
<p>&#x5BF9;&#x4E8E;<a href="">Mahalanobis Distance</a>&#xFF0C;<img src="https://latex.codecogs.com/gif.latex?D%28X_i%2CX_j%29%20%3D%20%5Csqrt%7B%28X_i-X_j%29%5ETS%5E%7B-1%7D%28X_i-X_j%29%7D" alt="formula"> &#x5176;&#x4E2D; <img src="https://latex.codecogs.com/gif.latex?S" alt="formula"> &#x4E3A;&#x5168;&#x90E8; <img src="https://latex.codecogs.com/gif.latex?X" alt="formula"> &#x6837;&#x672C;&#x7684;&#x534F;&#x65B9;&#x5DEE;&#x77E9;&#x9635;</p>
</blockquote>
<pre><code class="lang-R">&gt; res &lt;-aq.plot(boys2015)
&gt; which(res$outliers==<span class="hljs-literal">T</span>)
</code></pre>
<p><img src="img/md.png" alt="md"></p>
<p><code>&#x56DB;&#x4E2A;&#x56FE;&#x6709;&#x4E0D;&#x540C;&#x7684;&#x610F;&#x601D;&#xFF0C;&#x6211;&#x4EEC;&#x987A;&#x65F6;&#x9488;&#x7F16;&#x53F7;&#x56FE;&#xFF0C;&#x56FE;1&#x4E3A;&#x539F;&#x59CB;&#x6570;&#x636E;&#xFF0C;&#x56FE;2&#x4E3A;Chi&#x65B9;&#x5206;&#x5E03;&#x4E0B;Mahalanobis Distance&#x6392;&#x5E8F;&#x56FE;&#xFF0C;&#x84DD;&#x8272;&#x7AD6;&#x7EBF;&#x4E3A;&#x9608;&#x503C;&#x5373;&#x67D0;&#x5206;&#x4F4D;&#x6570;&#xFF0C;&#x56FE;3&#x548C;&#x56FE;4&#x5B9E;&#x9645;&#x4E0A;&#x53D6;&#x5F97;&#x662F;&#x4E0D;&#x540C;&#x5206;&#x4F4D;&#x6570;&#x4E0B;&#x7684;&#x5F02;&#x5E38;&#x503C;&#x60C5;&#x51B5;</code></p>
<p>&#x5F02;&#x5E38;&#x503C;&#x7F16;&#x53F7;</p>
<pre><code>[1]  4  5 12 13 14 21 27 30 40 55 57 81 82 83
</code></pre><h4 id="local-outlier-factor"><a href="">Local Outlier Factor</a></h4>
<blockquote>
<p>LOF&#x601D;&#x60F3;&#x5373;&#x57FA;&#x4E8E;&#x8DDD;&#x79BB;&#x7684;&#x5254;&#x9664;&#xFF0C;&#x901A;&#x8FC7;&#x8BA1;&#x7B97;&#x5C40;&#x90E8;&#x5BC6;&#x5EA6;&#x8BBE;&#x7F6E;&#x9608;&#x503C;&#x53BB;&#x9664;&#x5F02;&#x5E38;&#x503C;&#xFF0C;&#x4EE5;&#x4E0B;&#x7ED9;&#x51FA;&#x5B9A;&#x4E49;</p>
</blockquote>
<table>
<thead>
<tr>
<th>LOF Algorithm</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x5B9A;&#x4E49;&#x6B65;&#x9AA4;&#xFF1A;<br>1. <img src="https://latex.codecogs.com/gif.latex?d%28p%2Co%29" alt="formula">   &#x4E3A;&#x4E24;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x8DDD;&#x79BB;&#xFF0C;&#x53EF;&#x4EE5;&#x662F;<a href="">Mahalanobis Distance</a>&#x7B49;<br>2. <img src="https://latex.codecogs.com/gif.latex?d_k%28p%29%3Dd%28p%2Co%29" alt="formula"> &#x5176;&#x4E2D;&#x81F3;&#x5C11;&#x6709;k&#x4E2A;&#x70B9; <img src="https://latex.codecogs.com/gif.latex?o_i%5Cin%20C%5C%7Bx%5Cnotin%20p%5C%7D" alt="formula"> &#x6EE1;&#x8DB3; <img src="https://latex.codecogs.com/gif.latex?d%28p%2Co_i%29%5Cle%20d%28p%2Co%29" alt="formula">&#xFF0C;&#x81F3;&#x591A;&#x6709;k-1&#x4E2A;&#x70B9; <img src="https://latex.codecogs.com/gif.latex?o_i%5Cnotin%20C%5C%7Bx%5Cne%20p%5C%7D" alt="formula"> &#x6EE1;&#x8DB3; <img src="https://latex.codecogs.com/gif.latex?d%28p%2Co_i%29%3Cd%28p%2Co%29" alt="formula"> &#xFF0C;&#x5373;&#x7B2C;k&#x8DDD;&#x79BB;&#x70B9;<br>3. <img src="https://latex.codecogs.com/gif.latex?N_k%28p%29" alt="formula"> &#x4E3A;&#x7B2C;k&#x8DDD;&#x79BB;&#x4EE5;&#x5185;&#x7684;&#x6240;&#x6709;&#x70B9;<br> 4. <img src="https://latex.codecogs.com/gif.latex?reach_k%28p%2Co%29%20%3D%20max%5C%7Bd_k%28o%29%2Cd%28p%2Co%29%5C%7D" alt="formula"> <br>5. &#x5C40;&#x90E8;&#x5BC6;&#x5EA6; <img src="https://latex.codecogs.com/gif.latex?lrd_k%28%20p%20%29%3D1/%28%5Cfrac%7B%5Csum_%7Bo%5Cin%20N_k%28%20p%20%29%7D%7Breach_k%28p%2Co%29%7D%7D%7B%5C%7CN_k%28%20p%20%29%5C%7C%7D%29" alt="formula"> <br>6. <img src="https://latex.codecogs.com/gif.latex?LOF_k%28%20p%20%29%20%3D%20%5Cfrac%7B%5Csum_%7Bo%5Cin%20N_k%28%20p%20%29%7D%7B%5Cfrac%7Blrd_k%28o%29%7D%7Blrd_k%28%20p%20%29%7D%7D%7D%7B%5C%7CN_k%28%20p%20%29%5C%7C%7D" alt="formula"> &#x5373;p&#x7684;&#x90BB;&#x57DF;&#x70B9;<img src="https://latex.codecogs.com/gif.latex?N_k%28%20p%20%29" alt="formula">&#x7684;&#x5C40;&#x90E8;&#x53EF;&#x8FBE;&#x5BC6;&#x5EA6;&#x4E0E;&#x70B9;p&#x7684;&#x5C40;&#x90E8;&#x53EF;&#x8FBE;&#x5BC6;&#x5EA6;&#x4E4B;&#x6BD4;&#x7684;&#x5E73;&#x5747;&#x6570;&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x6BD4;&#x503C;&#x8D8A;&#x63A5;&#x8FD1;1&#xFF0C;&#x8BF4;&#x660E;p&#x7684;&#x5176;&#x90BB;&#x57DF;&#x70B9;&#x5BC6;&#x5EA6;&#x5DEE;&#x4E0D;&#x591A;<br></td>
</tr>
</tbody>
</table>
<pre><code class="lang-R">&gt; out.scores&lt;-lofactor(boys2015,k=<span class="hljs-number">10</span>) <span class="hljs-comment"># &#x8BA1;&#x7B97;&#x6BCF;&#x4E2A;&#x6837;&#x672C;LOF</span>
&gt; plot(density(out.scores)) <span class="hljs-comment"># &#x753B;&#x51FA;&#x5BC6;&#x5EA6;&#x56FE;</span>
&gt; out&lt;-order(out.scores,decreasing=<span class="hljs-literal">TRUE</span>)[<span class="hljs-number">1</span>:<span class="hljs-number">5</span>] <span class="hljs-comment"># &#x7B5B;&#x9009;&#x524D;5&#x4E2A;&#x53EF;&#x80FD;&#x5F02;&#x5E38;&#x503C;</span>
&gt; out
</code></pre>
<p>&#x5F97;&#x5230;</p>
<pre><code>[1]  5 57 14 82 83
</code></pre><p><img src="img/density.png" alt="density"></p>
<p>&#x5F53;&#x7136;&#x4E5F;&#x53EF;&#x4EE5;&#x5728;PCA&#x7ED3;&#x679C;&#x56FE;&#x4E0A;&#x7ED8;&#x5236;</p>
<pre><code class="lang-R">&gt; n&lt;-nrow(boys2015)
&gt; labels&lt;-<span class="hljs-number">1</span>:n
&gt; labels[-out]&lt;-<span class="hljs-string">&quot;.&quot;</span>
&gt; biplot(prcomp(boys2015),cex=<span class="hljs-number">0.8</span>,xlabs=labels)
</code></pre>
<p><img src="img/PCA.png" alt="PCA"></p>
<p>PCA&#x8BE6;&#x89C1;<a href="#&#x4E3B;&#x6210;&#x5206;&#x5206;&#x6790;">&#x4E3B;&#x6210;&#x5206;&#x5206;&#x6790;</a></p>
<h4 id="&#x805A;&#x7C7B;"><a href="">&#x805A;&#x7C7B;</a></h4>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x7528;&#x7684;&#x662F;Kmean&#xFF0C;&#x8BE6;&#x89C1;<a href="#&#x805A;&#x7C7B;&#x5206;&#x6790;">&#x805A;&#x7C7B;&#x5206;&#x6790;</a>&#xFF0C;&#x8FD9;&#x91CC;&#x7684;&#x8DDD;&#x79BB;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x5E73;&#x65B9;&#x5DEE;</p>
</blockquote>
<pre><code class="lang-R">&gt; kmeans.result&lt;-kmeans(boys2015,centers=<span class="hljs-number">3</span>)
&gt; kmeans.result$centers
&gt; centers &lt;- kmeans.result$centers[kmeans.result$cluster, ]
&gt; distances&lt;-sqrt(rowSums((boys2015-centers)^<span class="hljs-number">2</span>))
&gt; out&lt;-order(distances,decreasing=<span class="hljs-literal">TRUE</span>)[<span class="hljs-number">1</span>:<span class="hljs-number">5</span>]
&gt; out 
&gt; boys2015[out,]
</code></pre>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x7ED3;&#x679C;</p>
<pre><code>    height  armSpan footLength legLength   weight
1 181.0938 185.1875   26.62500 103.37500 75.37500
2 177.0000  17.0000   25.66667  92.66667 67.66667
3 172.8163 171.1020   26.62245  93.42857 63.73469

[1] 82 83 12 27 55

   height armSpan footLength legLength weight
82    177     181        100        26     78
83    184     242         24       115     90
12    170     164         24        71     51
27    172     156         22       104     82
55    169     165         23        72     51
</code></pre><p>&#x5728;&#x6B64;&#x6570;&#x636E;&#x96C6;&#x4E0A;&#xFF0C;&#x5BF9;&#x4E8E;Kmean&#x7684;&#x7ED3;&#x679C;&#x6765;&#x8BF4;&#xFF0C;&#x5254;&#x9664;&#x6548;&#x679C;&#x76F4;&#x89C2;&#x4E0A;&#x6CA1;&#x6709;LOF&#x6765;&#x5F97;&#x597D;</p>
<p><strong>&#x4EE5;&#x4E0B;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4E3A;&#x8865;&#x5145;</strong></p>
<h4 id="isolation-forest"><a href="">Isolation Forest</a></h4>
<blockquote>
<p>&#x4ECE;&#x8BAD;&#x7EC3;&#x6570;&#x636E;&#x4E2D;&#x968F;&#x673A;&#x9009;&#x62E9;&#x82E5;&#x5E72;&#x4E2A;&#x70B9;&#x6837;&#x672C;&#x70B9;&#x4F5C;&#x4E3A;subsample&#xFF0C;&#x901A;&#x8FC7;&#x9012;&#x5F52;&#x6784;&#x5EFA;&#x591A;&#x4E2A;iTree&#x7EC4;&#x5408;&#x6210;Forest&#xFF0C;&#x5BF9;&#x6BCF;&#x4E2A;&#x6837;&#x672C;x&#x8BA1;&#x7B97;&#x5176;&#x5E73;&#x5747;&#x904D;&#x5386;&#x7684;&#x9AD8;&#x5EA6;&#xFF0C;&#x5E76;&#x8BBE;&#x5B9A;&#x9608;&#x503C;&#xFF0C;&#x5C0F;&#x4E8E;&#x9608;&#x503C;&#x9AD8;&#x5EA6;&#x7684;&#x6837;&#x672C;&#x6700;&#x65E9;&#x88AB;<strong>&#x5B64;&#x7ACB;</strong>&#xFF0C;&#x6781;&#x6709;&#x53EF;&#x80FD;&#x662F;&#x5F02;&#x5E38;&#x503C;</p>
</blockquote>
<p>iTree&#x6784;&#x5EFA;&#x65B9;&#x6CD5;&#xFF1A;</p>
<table>
<thead>
<tr>
<th>Isolation Tree Algorithm</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>&#xFF08;&#x8BE6;&#x89C1;<a href="">&#x5468;&#x5FD7;&#x534E;</a>&#x8001;&#x5E08;&#x8BBA;&#x6587;&#xFF09;</em><br>&#x7B97;&#x6CD5;&#x8F93;&#x5165;&#xFF1A;&#x73B0;&#x5728;&#x7684;&#x6570;&#x636E; X&#x3001;&#x73B0;&#x5728;&#x7684;&#x6811;&#x9AD8;&#x5EA6; e&#x3001;&#x6811;&#x9AD8;&#x5EA6;&#x9650;&#x5236; l<br>&#x7B97;&#x6CD5;&#x8F93;&#x51FA;&#xFF1A;&#x4E00;&#x9897;iTree<br>&#x7B97;&#x6CD5;&#x5927;&#x81F4;&#x6D41;&#x7A0B;&#xFF1A;&#x968F;&#x673A;&#x9009;&#x62E9;&#x4E00;&#x4E2A;&#x5C5E;&#x6027;&#x7684;&#x4E00;&#x4E2A;&#x503C;&#xFF0C;&#x5BF9;&#x8FD9;&#x4E2A;&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x5DE6;&#x53F3;&#x5212;&#x5206;&#xFF08;&#x7C7B;&#x4F3C;&#x5FEB;&#x6392;&#xFF09;&#xFF0C;&#x9012;&#x5F52;&#x6784;&#x9020;&#x5DE6;&#x5B50;&#x5973;&#x548C;&#x53F3;&#x5B50;&#x5973;&#xFF0C;&#x76F4;&#x5230;&#x4F20;&#x5165;&#x51C0;&#x6570;&#x636E;&#x53EA;&#x6709;&#x4E00;&#x6761;&#x6216;&#x8005;&#x6811;&#x9AD8;&#x5EA6; e &#x5230;&#x4E86;&#x9650;&#x5236; l</td>
</tr>
</tbody>
</table>
<p><strong>&#x7ED3;&#x679C;</strong>&#xFF1A;&#x5BF9;&#x4E8E;2015&#x5E74;&#x7684;&#x6570;&#x636E;&#x6211;&#x4EEC;&#x7528;&#x6700;&#x7B80;&#x5355;&#x7684;<strong>&#x7BB1;&#x7EBF;&#x56FE;&#x622A;&#x65AD;</strong>&#x65B9;&#x6CD5;&#xFF0C;&#x5BF9;2015&#x5E74;&#x7537;&#x751F;&#x6570;&#x636E;&#x7684;&#x5168;&#x90E8;&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x68C0;&#x6D4B;&#xFF0C;&#x5254;&#x9664;&#x4E86;&#x81C2;&#x5C55;&#x3001;&#x817F;&#x957F;&#x7684;&#x6574;&#x884C;&#x5F02;&#x5E38;&#x503C;</p>
<p>&#x53EF;&#x5F97;&#x5230;2015&#x5E74;&#x7537;&#x751F;&#x6570;&#x636E;&#x7684;<code>summary</code></p>
<p>&#x8FD9;&#x91CC;&#x4E0D;&#x7ED9;&#x51FA;&#xFF08;&#x9690;&#x79C1;&#x4FDD;&#x62A4;&#xFF09;</p>
<h2 id="&#x7F3A;&#x5931;&#x503C;&#x5904;&#x7406;">&#x7F3A;&#x5931;&#x503C;&#x5904;&#x7406;</h2>
<p>&#x6211;&#x4EEC;&#x7684;&#x6570;&#x636E;&#x662F;&#x6CA1;&#x6709;&#x7F3A;&#x5931;&#x503C;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x4E3A;&#x4E86;&#x8865;&#x5145;&#x8FD9;&#x4E00;&#x5757;&#x7684;&#x65B9;&#x6CD5;&#x53EA;&#x80FD;&#x751F;&#x9020;&#x7F3A;&#x5931;&#x503C;&#x2026; &#x7ED9;&#x81C2;&#x5C55;&#x548C;&#x817F;&#x957F;&#x5404;&#x9020;5&#x4E2A;&#x7F3A;&#x5931;&#x503C;</p>
<pre><code class="lang-R">&gt; nonBoys2015 &lt;- filboys2015
&gt; nonBoys2015[sample(<span class="hljs-number">1</span>:nrow(nonBoys2015),<span class="hljs-number">5</span>),<span class="hljs-string">&quot;armSpan&quot;</span>]&lt;-<span class="hljs-literal">NA</span>
&gt; nonBoys2015[sample(<span class="hljs-number">1</span>:nrow(nonBoys2015),<span class="hljs-number">5</span>),<span class="hljs-string">&quot;legLength&quot;</span>]&lt;-<span class="hljs-literal">NA</span>
</code></pre>
<p>&#x67E5;&#x770B;&#x7F3A;&#x5931;&#x60C5;&#x51B5;</p>
<pre><code class="lang-R">&gt; md.pattern(nonBoys2015)
&gt; aggr(filboys2015csv,prop=<span class="hljs-literal">T</span>,numbers=<span class="hljs-literal">T</span>)
</code></pre>
<pre><code>   height footLength weight armSpan legLength   
70      1          1      1       1         1  0
5       1          1      1       1         0  1
5       1          1      1       0         1  1
        0          0      0       5         5 10
</code></pre><p><img src="img/pattern.png" alt="pattern"></p>
<p><img src="img/vim.png" alt="vim"></p>
<p><code>&#x7F3A;&#x5931;&#x503C;&#x5904;&#x7406;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5220;&#x9664;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x6781;&#x5927;&#x4F3C;&#x7136;&#x6CD5;&#xFF0C;&#x4F46;&#x66F4;&#x591A;&#x7684;&#x662F;&#x4F7F;&#x7528;&#x63D2;&#x8865;&#x6CD5;&#xFF0C;&#x56E0;&#x6B64;&#x4E0B;&#x9762;&#x4ECB;&#x7ECD;&#x7684;&#x5168;&#x90E8;&#x90FD;&#x662F;&#x63D2;&#x8865;&#x6CD5;</code></p>
<h3 id="&#x5747;&#x503C;&#x4E2D;&#x4F4D;&#x6570;&#x586B;&#x5145;"><a href="">&#x5747;&#x503C;/&#x4E2D;&#x4F4D;&#x6570;&#x586B;&#x5145;</a></h3>
<blockquote>
<p>&#x76F4;&#x63A5;&#x586B;&#x4E2D;&#x4F4D;&#x6570;&#x548C;&#x5747;&#x503C;&#xFF0C;&#x6216;&#x8005;&#x5176;&#x4ED6;&#x53EF;&#x80FD;&#x7684;&#x7EDF;&#x8BA1;&#x91CF;</p>
</blockquote>
<p>&#x6BD4;&#x5982;&#x5BF9;&#x4E8E;&#x5747;&#x503C;&#x63D2;&#x8865;</p>
<pre><code class="lang-R">&gt; tmpNonBoys2015 &lt;- nonBoys2015
&gt; tmpNonBoys2015$armSpan=impute(tmpNonBoys2015$armSpan, mean)
&gt; tmpNonBoys2015$legLength=impute(tmpNonBoys2015$legLength, mean)
</code></pre>
<p>&#x5BF9;&#x4E8E;&#x5747;&#x503C;&#xFF0C;&#x6211;&#x4EEC;&#x6BD4;&#x8F83;&#x548C;&#x771F;&#x5B9E;&#x503C;&#x7684;&#x5DEE;&#x522B;&#xFF0C;&#x6BD4;&#x5982;&#x81C2;&#x5C55;</p>
<pre><code class="lang-R">&gt; actuals&lt;-filboys2015$armSpan[is.na(nonBoys2015$armSpan)]
&gt; predicteds1&lt;-rep(mean(nonBoys2015$armSpan,na.rm=<span class="hljs-literal">TRUE</span>),length(actuals))
&gt; regr.eval(actuals,predicteds1)
</code></pre>
<pre><code>        mae         mse        rmse        mape 
 6.89866667 83.87537778  9.15835017  0.03744818
</code></pre><p>&#x5176;&#x4E2D;&#xFF0C;mae&#x4E3A;&#x5E73;&#x5747;&#x7EDD;&#x5BF9;&#x8BEF;&#x5DEE;&#xFF1B;mse&#x4E3A;&#x5747;&#x65B9;&#x8BEF;&#x5DEE;&#xFF1B;rmse&#x4E3A;&#x5747;&#x65B9;&#x6839;&#x8BEF;&#x5DEE;&#xFF1B;mape&#x4E3A;&#x5E73;&#x5747;&#x7EDD;&#x5BF9;&#x767E;&#x5206;&#x8BEF;&#x5DEE;</p>
<h3 id="&#x57FA;&#x4E8E;&#x8DDD;&#x79BB;&#x7684;&#x63D2;&#x8865;"><a href="">&#x57FA;&#x4E8E;&#x8DDD;&#x79BB;&#x7684;&#x63D2;&#x8865;</a></h3>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x6307;&#x7684;&#x662F;kNN&#x63D2;&#x503C;</p>
</blockquote>
<table>
<thead>
<tr>
<th>kNN Algorithm</th>
</tr>
</thead>
<tbody>
<tr>
<td>1. &#x5B9A;&#x4E49;&#x8DDD;&#x79BB;<img src="https://latex.codecogs.com/gif.latex?d%28p%2Co%29" alt="formula">&#xFF0C; &#x8DDD;&#x79BB;&#x53EF;&#x4EE5;&#x662F;<a href="">Mahalanobis Distance</a>&#x7B49;<br>2. &#x8BA1;&#x7B97;&#x7F3A;&#x5931;&#x6570;&#x636E;&#x5176;&#x4ED6;&#x5C5E;&#x6027;&#x6784;&#x6210;&#x5411;&#x91CF;&#x548C;&#x6240;&#x6709;&#x6837;&#x672C;&#x7684;&#x8DDD;&#x79BB; <img src="https://latex.codecogs.com/gif.latex?d%28p%27%2C%20o_i%29" alt="formula"><br>3. &#x5FEB;&#x901F;&#x6392;&#x5E8F;&#x5F97;&#x5230;&#x6700;&#x8FD1;&#x7684;k&#x4E2A;&#x8DDD;&#x79BB;<br>4. &#x53CD;&#x8DDD;&#x79BB;&#x52A0;&#x6743;&#x63D2;&#x503C;&#xFF1A;&#x8BBE; <img src="https://latex.codecogs.com/gif.latex?%5Clambda_i%3D%5Cfrac%7B1/d_i%7D%7B%5Csum%7Bd_i%7D%7D" alt="formula"> &#x5219;&#x63D2;&#x5165;&#x503C;&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?x%3D%20%5Csum%7B%5Clambda_ix_i%7D" alt="formula"> &#x5176;&#x4E2D; <img src="https://latex.codecogs.com/gif.latex?x_i" alt="formula"> &#x4E3A;&#x7F3A;&#x5931;&#x6240;&#x5728;&#x5C5E;&#x6027;&#x7684;&#x6BCF;&#x884C;&#x503C;</td>
</tr>
</tbody>
</table>
<p>kNN&#x53C2;&#x6570;&#x7528;&#x51FD;&#x6570;&#x9ED8;&#x8BA4;</p>
<pre><code class="lang-R">&gt; tmpNonBoys2015 &lt;- data.frame(nonBoys2015)
&gt; knnOutput&lt;-knnImputation(tmpNonBoys2015)
&gt; predicts&lt;-knnOutput[is.na(nonBoys2015$armSpan),<span class="hljs-string">&quot;armSpan&quot;</span>]
&gt; regr.eval(actuals,predicts)
</code></pre>
<pre><code>        mae         mse        rmse        mape 
 4.11180323 32.17874356  5.67263110  0.02212056
</code></pre><p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5BF9;&#x4E8E;&#x81C2;&#x5C55;&#x6765;&#x8BF4;&#x8BEF;&#x5DEE;&#x90FD;&#x6709;&#x6240;&#x4E0B;&#x964D;</p>
<h3 id="regression"><a href="">Regression</a></h3>
<blockquote>
<p>&#x5229;&#x7528;&#x56DE;&#x5F52;&#x51FD;&#x6570;&#x5219;&#x81EA;&#x8EAB;&#x5C5E;&#x6027;&#x4F5C;&#x4E3A;&#x56E0;&#x53D8;&#x91CF;&#xFF0C;&#x5176;&#x4F59;&#x53D8;&#x91CF;&#x4F5C;&#x4E3A;&#x81EA;&#x53D8;&#x91CF;&#xFF0C;&#x901A;&#x8FC7;&#x5176;&#x7279;&#x5F81;&#x6765;&#x8FDB;&#x884C;&#x56DE;&#x5F52;&#x9884;&#x6D4B;&#xFF0C;&#x5176;&#x4E2D;&#x53EF;&#x4EE5;&#x5BFB;&#x627E;&#x548C;&#x81EA;&#x8EAB;&#x53D8;&#x91CF;&#x6709;&#x5F3A;&#x76F8;&#x5173;&#x5173;&#x7CFB;&#x7684;&#x53D8;&#x91CF;&#x8FDB;&#x884C;&#x7EBF;&#x6027;&#x56DE;&#x5F52;&#x9884;&#x6D4B;&#xFF0C;&#x6216;&#x8005;&#x63D0;&#x53D6;&#x7279;&#x5F81;&#x540E;&#x5229;&#x7528;&#x51B3;&#x7B56;&#x6811;&#x56DE;&#x5F52;&#x65B9;&#x6CD5;&#x6765;&#x9884;&#x6D4B;&#x3002;</p>
<p>&#x4E00;&#x822C;&#x65B9;&#x6CD5;&#x6709;<a href="">&#x7EBF;&#x6027;&#x56DE;&#x5F52;</a>&#x3001;<a href="http://localhost:9000/login" target="_blank">&#x903B;&#x8F91;&#x56DE;&#x5F52;</a>&#x3001;<a href="">&#x51B3;&#x7B56;&#x6811;(CART&#x7B49;)</a>&#x3001;<a href="">Random Forest</a>&#xFF0C;&#x5177;&#x4F53;&#x505A;&#x6CD5;&#x89C1;&#x4E0B;<a href="#Model-Analyse-&amp;-Evaluation">Model Analyse &amp; Evaluation</a>&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x56DE;&#x5F52;&#x6811;</p>
</blockquote>
<pre><code class="lang-R">&gt; anova_mod&lt;-rpart(armSpan~.-height, data=nonBoys2015[!is.na(nonBoys2015$armSpan),], na.action=na.omit, method=<span class="hljs-string">&quot;anova&quot;</span>) 
&gt; armSpan_pred&lt;-predict(anova_mod, nonBoys2015[is.na(nonBoys2015$armSpan),])
&gt; regr.eval(actuals, armSpan_pred)
</code></pre>
<pre><code>        mae         mse        rmse        mape 
 5.54722222 49.36275386  7.02586321  0.03012357
</code></pre><p>&#x8FD9;&#x91CC;&#x662F;&#x53D6;height&#x4F5C;&#x4E3A;&#x56DE;&#x5F52;&#x56E0;&#x53D8;&#x91CF;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6548;&#x679C;&#x6CA1;&#x6709;kNN&#x586B;&#x8865;&#x6765;&#x5F97;&#x597D;</p>
<h3 id="&#x591A;&#x91CD;&#x63D2;&#x8865;"><a href="">&#x591A;&#x91CD;&#x63D2;&#x8865;</a></h3>
<blockquote>
<p>&#x591A;&#x91CD;&#x63D2;&#x8865;&#x65B9;&#x6CD5;&#x6BD4;&#x8F83;&#x590D;&#x6742;&#xFF0C;&#x8FD9;&#x91CC;&#x4E0D;&#x7ED9;&#x51FA;&#x5177;&#x4F53;&#x7B97;&#x6CD5;&#x3002;&#x5927;&#x81F4;&#x6D41;&#x7A0B;&#x5C31;&#x662F;&#x5BF9;&#x6BCF;&#x4E2A;&#x7F3A;&#x5931;&#x503C;&#x6784;&#x9020;m&#x4E2A;&#x586B;&#x8865;&#x503C;&#xFF08;&#x56DE;&#x5F52;&#x65B9;&#x6CD5;&#x6216;&#x8005;MLE&#x7B49;&#xFF09;&#xFF0C;&#x4EA7;&#x751F;&#x4E86;m&#x4E2A;&#x6570;&#x636E;&#x96C6;&#xFF0C;&#x5BF9;m&#x4E2A;&#x6570;&#x636E;&#x96C6;&#x518D;&#x8FDB;&#x884C;&#x65B9;&#x6CD5;&#x5904;&#x7406;&#xFF0C;&#x5F97;&#x5230;m&#x4E2A;&#x7ED3;&#x679C;&#xFF0C;&#x5BF9;&#x8FD9;m&#x4E2A;&#x7ED3;&#x679C;&#x518D;&#x8FDB;&#x884C;&#x6574;&#x5408;&#xFF08;pool&#xFF09;&#xFF0C;&#x7136;&#x540E;&#x8FDB;&#x884C;&#x5206;&#x5E03;&#x4F30;&#x8BA1;&#x3002;&#x8FD9;&#x91CC;&#x7684;&#x56DE;&#x5F52;&#x6A21;&#x578B;&#x4F7F;&#x7528;<a href="">Random Forest</a></p>
</blockquote>
<pre><code class="lang-R">&gt; miceMod&lt;-mice(nonBoys2015[,], method=<span class="hljs-string">&quot;rf&quot;</span>)
&gt; miceOutput&lt;-complete(miceMod)
&gt; armSpan_pred&lt;-miceOutput[is.na(nonBoys2015$armSpan),<span class="hljs-string">&quot;armSpan&quot;</span>]
&gt; regr.eval(armSpan_actu,armSpan_pred)
</code></pre>
<pre><code>        mae         mse        rmse        mape 
 7.00000000 83.80000000  9.15423399  0.03800034
</code></pre><p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6548;&#x679C;&#x4ECD;&#x7136;&#x6CA1;&#x6709;kNN&#x6765;&#x5F97;&#x597D;</p>
<p>&#x5176;&#x4ED6;&#x65B9;&#x6CD5;&#x8FD8;&#x6709;<a href="">Bag Imputation</a>&#x3001;<a href="">Expectation Maximization</a>&#x7B49;</p>
<p><strong>&#x7ED3;&#x679C;&#xFF1A;</strong>&#x5B9E;&#x9645;&#x4E0A;&#x6211;&#x4EEC;&#x539F;&#x672C;&#x6570;&#x636E;&#x5E76;&#x6CA1;&#x6709;&#x7F3A;&#x5931;&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x662F;&#x7B80;&#x5355;&#x6BD4;&#x8F83;&#x4E00;&#x4E0B;&#x65B9;&#x6CD5;&#x4E4B;&#x95F4;&#x7684;&#x5F02;&#x540C;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x539F;&#x672C;&#x8FC7;&#x6EE4;&#x7684;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x4E0B;&#x4E00;&#x6B65;&#x5206;&#x6790;</p>
<h2 id="&#x5206;&#x5E03;&#x4F30;&#x8BA1;&#x68C0;&#x9A8C;&#xFF08;&#x53C2;&#x6570;&#x4F30;&#x8BA1;&#x4E0E;&#x5047;&#x8BBE;&#x68C0;&#x9A8C;&#xFF09;">&#x5206;&#x5E03;&#x4F30;&#x8BA1;&#x68C0;&#x9A8C;&#xFF08;&#x53C2;&#x6570;&#x4F30;&#x8BA1;&#x4E0E;&#x5047;&#x8BBE;&#x68C0;&#x9A8C;&#xFF09;</h2>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5F97;&#x5230;&#x7684;&#x6570;&#x636E;&#x662F;&#x6E05;&#x6D17;&#x8FC7;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x9700;&#x8981;&#x8FDB;&#x4E00;&#x6B65;&#x7684;&#x5206;&#x6790;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x8FDB;&#x884C;&#x5BF9;2015&#x5E74;&#x7537;&#x751F;&#x6570;&#x636E;&#x7684;&#x5206;&#x6790;&#x8F85;&#x4EE5;2018&#x5E74;&#x7537;&#x751F;&#x6570;&#x636E;&#x4EE5;&#x89E3;&#x51B3;&#x5148;&#x524D;&#x63D0;&#x51FA;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<h3 id="&#x5355;&#x603B;&#x4F53;&#x4F30;&#x8BA1;&#x68C0;&#x9A8C;">&#x5355;&#x603B;&#x4F53;&#x4F30;&#x8BA1;&#x68C0;&#x9A8C;</h3>
<p>&#x5355;&#x5143;&#x5206;&#x6790;&#x4EE5;<strong>2015&#x5E74;&#x7537;&#x751F;&#x817F;&#x957F;</strong>&#x4E3A;&#x4F8B;&#xFF0C;&#x753B;&#x51FA;&#x5176;&#x76F4;&#x65B9;&#x5BC6;&#x5EA6;&#x56FE;&#x3001;&#x7ECF;&#x9A8C;&#x5206;&#x5E03;&#x56FE;&#x3001;QQ&#x56FE;</p>
<pre><code class="lang-R">&gt; hist(filboys2015$legLength, freq = <span class="hljs-literal">FALSE</span>)
&gt; lines(density(filboys2015$legLength), col = <span class="hljs-string">&quot;blue&quot;</span>)
</code></pre>
<p><img src="img/legLength.png" alt="legLength"></p>
<pre><code class="lang-R">&gt; plot(ecdf(filboys2015$legLength),verticals = <span class="hljs-literal">TRUE</span>, do.p = <span class="hljs-literal">FALSE</span>)
</code></pre>
<p><img src="img/filboys.png" alt="filboys"></p>
<pre><code class="lang-R">&gt; qqnorm(filboys2015$legLength)
&gt; qqline(filboys2015$legLength)
</code></pre>
<p><img src="img/Rplot01.png" alt="Rplot01"></p>
<p>&#x867D;&#x7136;&#x548C;&#x6B63;&#x6001;&#x5206;&#x5E03;&#x6709;&#x5DEE;&#x8DDD;&#xFF0C;&#x4F46;&#x6211;&#x4EEC;&#x4F9D;&#x7136;&#x5148;&#x8FDB;&#x884C;&#x53C2;&#x6570;&#x7684;&#x4F30;&#x8BA1;</p>
<h4 id="&#x77E9;&#x4F30;&#x8BA1;">&#x77E9;&#x4F30;&#x8BA1;</h4>
<p>&#x77E9;&#x4F30;&#x8BA1; <img src="https://latex.codecogs.com/gif.latex?%5Chat%7B%5Cmu%7D%20%3D%20%5Coverline%7BX%7D" alt="formula">  &#x4E0E;  <img src="https://latex.codecogs.com/gif.latex?%5Chat%7B%5Csigma%5E2%7D%20%3D%20%5Ctilde%7BS%5E2%7D" alt="formula"> </p>
<p>&#x6613;&#x5F97;&#x5230; <img src="https://latex.codecogs.com/gif.latex?%5Chat%7B%5Cmu%7D%20%3D%2098.25" alt="formula">  &#x4E0E;  <img src="https://latex.codecogs.com/gif.latex?%5Chat%7B%5Csigma%5E2%7D%20%3D%2077.44" alt="formula"> </p>
<h4 id="&#x6781;&#x5927;&#x4F3C;&#x7136;&#x4F30;&#x8BA1;">&#x6781;&#x5927;&#x4F3C;&#x7136;&#x4F30;&#x8BA1;</h4>
<p>&#x6211;&#x4EEC;&#x8BBE;&#x603B;&#x4F53;&#x7B26;&#x5408;&#x6B63;&#x6001;&#x5206;&#x5E03; <img src="https://latex.codecogs.com/gif.latex?N%28%5Cmu%2C%20%5Csigma%5E2%29" alt="formula">&#xFF0C;&#x5BF9;&#x5E94;&#x4F3C;&#x7136;&#x51FD;&#x6570;&#x4E3A;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0Aln%20L%28%5Cmu%2C%5Csigma%5E2%3Bx%29%3D-%5Cfrac%7Bn%7D%7B2%7Dln%282%5Cpi%5Csigma%5E2%29-%5Cfrac%7B%5Csum_%7Bi%3D1%7D%5E%7Bn%7D%7B%28x_i-%5Cmu%29%5E2%7D%7D%7B2%5Csigma%5E2%7D%0A" alt="formula"></p>
<p>&#x5373;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Cbegin%7Barray%7D%7Blr%7D%0A%5Cfrac%7B%5Cpartial%7Bln%20L%28%5Cmu%2C%5Csigma%5E2%3Bx%29%7D%7D%7B%5Cpartial%7B%5Cmu%7D%7D%3D0%2C%20%5C%5C%0A%5Cfrac%7B%5Cpartial%7Bln%20L%28%5Cmu%2C%5Csigma%5E2%3Bx%29%7D%7D%7B%5Cpartial%7B%5Csigma%7D%7D%3D0%0A%5Cend%7Barray%7D%0A" alt="formula"></p>
<p>&#x6C42;&#x5BFC;&#x540E;&#x53EF;&#x4EE5;&#x89E3;&#x5F97;  <img src="https://latex.codecogs.com/gif.latex?%5Chat%7B%5Cmu%7D%20%3D%20%5Coverline%7BX%7D" alt="formula">  &#x4E0E; <img src="https://latex.codecogs.com/gif.latex?%5Chat%7B%5Csigma%5E2%7D%20%3D%20S%5E2" alt="formula"> &#xFF0C;&#x8FDB;&#x4E00;&#x6B65;&#x53EF;&#x4EE5;&#x8BC1;&#x660E;&#x4F3C;&#x7136;&#x51FD;&#x6570;&#x7684;&#x4E8C;&#x9636;Hessa&#x77E9;&#x9635;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Cbegin%7Bbmatrix%7D%0A%5Cfrac%7B%5Cpartial%7B%5E2f%7D%7D%7B%5Cpartial%7B%5Cmu%7D%5E2%7D%20%26%20%5Cfrac%7B%5Cpartial%7B%5E2f%7D%7D%7B%5Cpartial%7B%5Cmu%7D%5Cpartial%7B%5Csigma%7D%5E2%7D%20%5C%5C%0A%5Cfrac%7B%5Cpartial%7B%5E2f%7D%7D%7B%5Cpartial%7B%5Csigma%7D%5E2%5Cpartial%7B%5Cmu%7D%7D%20%26%20%5Cfrac%7B%5Cpartial%7B%5E2f%7D%7D%7B%5Cpartial%7B%5Csigma%7D%5E2%5Cpartial%7B%5Csigma%7D%5E2%7D%0A%5Cend%7Bbmatrix%7D%0A" alt="formula"></p>
<p>&#x4E3A;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Cbegin%7Bbmatrix%7D%0A-%5Cfrac%7Bn%7D%7B%5Csigma%5E2%7D%20%26%200%5C%5C%0A0%20%26%20-%5Cfrac%7Bn%7D%7B2%5Csigma%5E4%7D%0A%5Cend%7Bbmatrix%7D%0A" alt="formula"></p>
<p>&#x5373;&#x4E3A;&#x8D1F;&#x5B9A;&#x77E9;&#x9635;</p>
<p>&#x56E0;&#x800C;&#x89E3;&#x5F97;  <img src="https://latex.codecogs.com/gif.latex?%5Chat%7B%5Cmu%7D%20%3D%20%5Coverline%7BX%7D" alt="formula">  &#x4E0E; <img src="https://latex.codecogs.com/gif.latex?%5Chat%7B%5Csigma%5E2%7D%20%3D%20S%5E2" alt="formula"> &#x4E3A;&#x6700;&#x5927;&#x89E3;&#x3002;</p>
<p>&#x6613;&#x5F97;&#x5230; <img src="https://latex.codecogs.com/gif.latex?%5Chat%7B%5Cmu%7D%20%3D%2098.25" alt="formula">  &#x4E0E;  <img src="https://latex.codecogs.com/gif.latex?%5Chat%7B%5Csigma%5E2%7D%20%3D%2075.52" alt="formula"> </p>
<h4 id="&#x533A;&#x95F4;&#x4F30;&#x8BA1;">&#x533A;&#x95F4;&#x4F30;&#x8BA1;</h4>
<p>&#x5747;&#x503C; <img src="https://latex.codecogs.com/gif.latex?%5Cmu" alt="formula"> &#x7684;&#x533A;&#x95F4;&#x4F30;&#x8BA1;&#xFF1A;</p>
<p>&#x6211;&#x4EEC;&#x5047;&#x8BBE; <img src="https://latex.codecogs.com/gif.latex?%5Csigma%5E2" alt="formula"> &#x672A;&#x77E5;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x533A;&#x95F4; <img src="https://latex.codecogs.com/gif.latex?%5B%5Coverline%7BX%7D%20-%20%5Cfrac%7B%20%5Ctilde%7BS%7D%7D%7B%5Csqrt%7Bn%7D%7Dt_%7B%5Calpha/2%7D%28n-1%29%2C%5Coverline%7BX%7D%20%2B%20%5Cfrac%7B%20%5Ctilde%7BS%7D%7D%7B%5Csqrt%7Bn%7D%7Dt_%7B%5Calpha/2%7D%28n-1%29%5D" alt="formula"> &#xFF0C;&#x5176;&#x4E2D;&#x5DF2;&#x7ECF;&#x6C42;&#x5F97; <img src="https://latex.codecogs.com/gif.latex?%5Coverline%7BX%7D%20%3D%2098.25" alt="formula"> &#xFF0C;<img src="https://latex.codecogs.com/gif.latex?%5Ctilde%7BS%7D%20%3D%208.80" alt="formula"> &#x548C; <img src="https://latex.codecogs.com/gif.latex?n%3D80" alt="formula"></p>
<pre><code class="lang-R">&gt; tmp&lt;-sd(filboys2015$legLength)/sqrt(<span class="hljs-number">80</span>)*qt(<span class="hljs-number">1</span>-<span class="hljs-number">0.05</span>/<span class="hljs-number">2</span>,<span class="hljs-number">80</span>-<span class="hljs-number">1</span>); df&lt;-<span class="hljs-number">80</span>-<span class="hljs-number">1</span>
&gt; xb&lt;-mean(filboys2015$legLength)
&gt; data.frame(mean=xb, df=df, a=xb-tmp, b=xb+tmp)
</code></pre>
<p>&#x56E0;&#x6B64;&#x533A;&#x95F4;&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?%5B96.29%2C%20100.21%5D" alt="formula"></p>
<p>&#x65B9;&#x5DEE; <img src="https://latex.codecogs.com/gif.latex?%5Csigma%5E2" alt="formula"> &#x7684;&#x533A;&#x95F4;&#x4F30;&#x8BA1;&#xFF1A;</p>
<p>&#x6211;&#x4EEC;&#x5047;&#x8BBE; <img src="https://latex.codecogs.com/gif.latex?%5Cmu" alt="formula"> &#x672A;&#x77E5;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x533A;&#x95F4; <img src="https://latex.codecogs.com/gif.latex?%5B%5Cfrac%7B%28n-1%29%5Ctilde%7BS%7D%5E2%7D%7B%5Cchi%5E2_%7B%5Calpha/2%7D%28n-1%29%7D%2C%5Cfrac%7B%28n-1%29%5Ctilde%7BS%7D%5E2%7D%7B%5Cchi%5E2_%7B1-%5Calpha/2%7D%28n-1%29%7D%5D" alt="formula">&#xFF0C;&#x5176;&#x4E2D;&#x5DF2;&#x7ECF;&#x6C42;&#x5F97;  <img src="https://latex.codecogs.com/gif.latex?%5Ctilde%7BS%7D%20%3D%208.80" alt="formula"> &#x548C; <img src="https://latex.codecogs.com/gif.latex?n%3D80" alt="formula"></p>
<pre><code class="lang-R">&gt; interval_var1&lt;-<span class="hljs-keyword">function</span>(x, mu=<span class="hljs-literal">Inf</span>, alpha=<span class="hljs-number">0.05</span>){
+     n&lt;-length(x)
+     <span class="hljs-keyword">if</span> (mu&lt;<span class="hljs-literal">Inf</span>){
+         S2 &lt;- sum((x-mu)^<span class="hljs-number">2</span>)/n; df &lt;- n
+     }
+     <span class="hljs-keyword">else</span>{
+         S2 &lt;- var(x); df &lt;- n-<span class="hljs-number">1</span>
+     }
+     a&lt;-df*S2/qchisq(<span class="hljs-number">1</span>-alpha/<span class="hljs-number">2</span>,df)
+     b&lt;-df*S2/qchisq(alpha/<span class="hljs-number">2</span>,df)
+     data.frame(var=S2, df=df, a=a, b=b)
+ }
&gt; 
&gt; 
&gt; interval_var1(filboys2015$legLength)
</code></pre>
<p>&#x56E0;&#x6B64;&#x533A;&#x95F4;&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?%5B58.00%2C%20108.63%5D" alt="formula"></p>
<h4 id="&#x53C2;&#x6570;&#x5047;&#x8BBE;">&#x53C2;&#x6570;&#x5047;&#x8BBE;</h4>
<p><a href=""> <img src="https://latex.codecogs.com/gif.latex?H_0%3A" alt="formula"> &#x7537;&#x751F;&#x817F;&#x957F;&#x5747;&#x503C; <img src="https://latex.codecogs.com/gif.latex?%5Cmu%3D%5Coverline%7BX%7D" alt="formula"> </a> <img src="https://latex.codecogs.com/gif.latex?%5Cleftrightarrow" alt="formula"> <a href=""> <img src="https://latex.codecogs.com/gif.latex?H_1%3A" alt="formula"> &#x7537;&#x751F;&#x817F;&#x957F;&#x5747;&#x503C; <img src="https://latex.codecogs.com/gif.latex?%5Cmu%20%5Cne%20%5Coverline%7BX%7D" alt="formula"> </a></p>
<blockquote>
<p>&#x65B9;&#x6CD5;&#x7C7B;&#x4F3C;&#x4E8E;&#x53C2;&#x6570;&#x4F30;&#x8BA1;&#xFF0C;&#x5F15;&#x5165;&#x4E86;p-value&#x7684;&#x8BA1;&#x7B97;</p>
</blockquote>
<pre><code class="lang-R">&gt; P_value&lt;-<span class="hljs-keyword">function</span>(cdf, x, paramet=numeric(<span class="hljs-number">0</span>), side=<span class="hljs-number">0</span>, n){
+     n&lt;-length(paramet)
+     P&lt;-<span class="hljs-keyword">switch</span>(n+<span class="hljs-number">1</span>,
+               cdf(x),
+               cdf(x, paramet),
+               cdf(x, paramet[<span class="hljs-number">1</span>], paramet[<span class="hljs-number">2</span>]),
+               cdf(x, paramet[<span class="hljs-number">1</span>], paramet[<span class="hljs-number">2</span>], paramet[<span class="hljs-number">3</span>])
+     )
+     <span class="hljs-keyword">if</span>(side&lt;<span class="hljs-number">0</span>){<span class="hljs-keyword">return</span>(P)}
+     <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(side&gt;<span class="hljs-number">0</span>){<span class="hljs-keyword">return</span>(<span class="hljs-number">1</span>-P)}
+     <span class="hljs-keyword">else</span>{
+         <span class="hljs-keyword">if</span>(P&lt;<span class="hljs-number">1</span>/<span class="hljs-number">2</span>){<span class="hljs-keyword">return</span>(<span class="hljs-number">2</span>*P)}
+         <span class="hljs-keyword">else</span>{<span class="hljs-keyword">return</span>(<span class="hljs-number">2</span>*(<span class="hljs-number">1</span>-P))}
+     }
+ }

&gt; mean.test1&lt;-<span class="hljs-keyword">function</span>(x, mu=<span class="hljs-number">0</span>, sigma=-<span class="hljs-number">1</span>, side=<span class="hljs-number">0</span>){
+     n&lt;-length(x); xb&lt;-mean(x)
+     <span class="hljs-keyword">if</span> (sigma&gt;<span class="hljs-number">0</span>){
+         z&lt;-(xb-mu)/(sigma/sqrt(n))
+         P&lt;-P_value(pnorm, z, side=side)
+         data.frame(mean=xb, df=n, Z=z, P_value=P)
+     }
+     <span class="hljs-keyword">else</span>{
+         t&lt;-(xb-mu)/(sd(x)/sqrt(n))
+         P&lt;-P_value(pt, t, paramet=n-<span class="hljs-number">1</span>, side=side)
+         data.frame(mean=xb, df=n-<span class="hljs-number">1</span>, <span class="hljs-literal">T</span>=t, P_value=P)
+     }
+ }
&gt; mean.test1(filboys2015$legLength, mu=mean(filboys2015$legLength))
</code></pre>
<p>&#x5F97;&#x5230; <img src="https://latex.codecogs.com/gif.latex?p-value%3E%5Calpha" alt="formula">&#xFF0C;&#x63A5;&#x53D7;&#x539F;&#x5047;&#x8BBE;</p>
<p><code>&#x5B9E;&#x9645;&#x4E0A;&#x8FD9;&#x6837;&#x505A;&#x6CA1;&#x6709;&#x610F;&#x4E49;&#xFF0C;&#x56E0;&#x4E3A;&#x5047;&#x8BBE;&#x68C0;&#x9A8C;&#x4F7F;&#x7528;&#x7684;&#x5047;&#x8BBE;&#x5206;&#x5E03;&#x7684;&#x5747;&#x503C;&#x5C31;&#x662F;&#x603B;&#x4F53;&#x5747;&#x503C;&#xFF0C;&#x6240;&#x4EE5;p-value&#x4E00;&#x5B9A;&#x4E3A;1</code></p>
<h4 id="&#x975E;&#x53C2;&#x5047;&#x8BBE;">&#x975E;&#x53C2;&#x5047;&#x8BBE;</h4>
<p><a href=""><img src="https://latex.codecogs.com/gif.latex?H_0%3A" alt="formula"> &#x7537;&#x751F;&#x817F;&#x957F;&#x7B26;&#x5408;&#x6B63;&#x6001;&#x5206;&#x5E03; <img src="https://latex.codecogs.com/gif.latex?N%28%5Cmu%2C%20%5Csigma%5E2%29" alt="formula"> &#xFF0C;&#x5176;&#x4E2D; <img src="https://latex.codecogs.com/gif.latex?%5Chat%7B%5Cmu%7D%20%3D%20%5Coverline%7BX%7D" alt="formula">  &#x4E14; <img src="https://latex.codecogs.com/gif.latex?%5Chat%7B%5Csigma%5E2%7D%20%3D%20S%5E2" alt="formula"> </a> <img src="https://latex.codecogs.com/gif.latex?%5Cleftrightarrow" alt="formula"> <a href=""><img src="https://latex.codecogs.com/gif.latex?H_1%3A" alt="formula"> &#x7537;&#x751F;&#x817F;&#x957F;&#x4E0D;&#x7B26;&#x5408;&#x6B63;&#x6001;&#x5206;&#x5E03;<img src="https://latex.codecogs.com/gif.latex?N%28%5Cmu%2C%20%5Csigma%5E2%29" alt="formula"> &#xFF0C;&#x5176;&#x4E2D; <img src="https://latex.codecogs.com/gif.latex?%5Chat%7B%5Cmu%7D%20%3D%20%5Coverline%7BX%7D" alt="formula"> </a></p>
<p><img src="https://latex.codecogs.com/gif.latex?%5Cchi%5E2" alt="formula">  &#x68C0;&#x9A8C;&#xFF1A;</p>
<p>&#x8BB0; <img src="https://latex.codecogs.com/gif.latex?C%20%3D%20%5Csum%7B%5Cfrac%7B%28v_i-np_i%29%5E2%7D%7Bnp_i%7D%7D" alt="formula"> &#x6709;&#x62D2;&#x7EDD;&#x57DF; <img src="https://latex.codecogs.com/gif.latex?%5Cchi_0%3D%5C%7B%5Cchi_n%5E2%3EC%5C%7D" alt="formula"></p>
<pre><code>&gt; A&lt;-table(cut(filboys2015$legLength, br=c(0,70,80,90,100,110,116)))
&gt; p&lt;-pnorm(c(70,80,90,100,110,117), mean(filboys2015$legLength), sd(filboys2015$legLength))
&gt; p&lt;-c(p[1], p[2]-p[1], p[3]-p[2], p[4]-p[3], p[5]-p[4], 1-p[5])
&gt; chisq.test(A,p=p)
</code></pre><p>&#x5176;&#x4E2D;&#x5206;&#x6BB5;&#x53EF;&#x4EE5;&#x4ECE;&#x7A0B;&#x5E8F;&#x4EE3;&#x7801;&#x4E2D;&#x770B;&#x5230;&#xFF0C;&#x5F97;&#x5230;</p>
<pre><code>X-squared = 7.1257, df = 5, p-value = 0.2115
</code></pre><p><img src="https://latex.codecogs.com/gif.latex?p-value%3E%5Calpha" alt="formula">&#xFF0C;&#x6545;&#x539F;&#x5047;&#x8BBE;&#x6210;&#x7ACB;</p>
<p><img src="https://latex.codecogs.com/gif.latex?K.S." alt="formula"> &#x68C0;&#x9A8C;&#xFF1A;</p>
<pre><code class="lang-R">&gt; ks.test(jitter(filboys2015$legLength),<span class="hljs-string">&quot;pnorm&quot;</span>,mean(filboys2015$legLength),sd(filboys2015$legLength))
</code></pre>
<p>&#x5176;&#x4E2D;&#x6570;&#x503C;&#x4E2D;&#x6709;&#x91CD;&#x590D;&#x503C;&#xFF0C;&#x56E0;&#x6B64;&#x7528;<code>jitter</code>&#x51FD;&#x6570;&#x505A;&#x5C0F;&#x6270;&#x52A8;&#xFF0C;&#x603B;&#x7ED3;&#x679C;&#x5F97;&#x5230;</p>
<pre><code>D = 0.12576, p-value = 0.1461
alternative hypothesis: two-sided
</code></pre><p><img src="https://latex.codecogs.com/gif.latex?p-value%3E%5Calpha" alt="formula">&#xFF0C;&#x6545;&#x539F;&#x5047;&#x8BBE;&#x6210;&#x7ACB;</p>
<h3 id="&#x53CC;&#x603B;&#x4F53;&#x4F30;&#x8BA1;&#x68C0;&#x9A8C;">&#x53CC;&#x603B;&#x4F53;&#x4F30;&#x8BA1;&#x68C0;&#x9A8C;</h3>
<p>&#x6211;&#x4EEC;&#x53D6;<strong>2018&#x5E74;&#x7537;&#x751F;&#x817F;&#x957F;</strong>&#x4F5C;&#x4E3A;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x603B;&#x4F53;&#xFF0C;&#x753B;&#x51FA;&#x5176;&#x76F4;&#x65B9;&#x5BC6;&#x5EA6;&#x56FE;&#x3001;&#x7ECF;&#x9A8C;&#x5206;&#x5E03;&#x56FE;&#x3001;QQ&#x56FE;</p>
<pre><code class="lang-R">&gt; hist(boys2018$legLength, freq = <span class="hljs-literal">FALSE</span>)
&gt; lines(density(boys2018$legLength), col = <span class="hljs-string">&quot;blue&quot;</span>)
</code></pre>
<p><img src="img/2018boys.png" alt="2018boys"></p>
<pre><code class="lang-R">&gt; plot(ecdf(boys2018$legLength),verticals = <span class="hljs-literal">TRUE</span>, do.p = <span class="hljs-literal">FALSE</span>)
</code></pre>
<p><img src="img/boys2018ecdf.png" alt="boys2018ecdf"></p>
<pre><code class="lang-R">&gt; qqnorm(boys2018$legLength)
&gt; qqline(boys2018$legLength)
</code></pre>
<p><img src="img/boys2018qq.png" alt="boys2018qq"></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;2018&#x5E74;&#x7537;&#x751F;&#x817F;&#x957F;&#x6570;&#x636E;&#x4E5F;&#x8FD1;&#x4F3C;&#x6B63;&#x6001;&#x5206;&#x5E03;&#xFF0C;&#x5E76;&#x4E14;&#x6570;&#x636E;&#x5206;&#x5E03;&#x5F88;&#x7C7B;&#x4F3C;&#x4E8E;2015&#x5E74;&#x7684;&#x7537;&#x751F;&#x6570;&#x636E;</p>
<h4 id="&#x533A;&#x95F4;&#x4F30;&#x8BA1;">&#x533A;&#x95F4;&#x4F30;&#x8BA1;</h4>
<p>&#x6211;&#x4EEC;&#x4F30;&#x8BA1; <img src="https://latex.codecogs.com/gif.latex?%5Cmu_1-%5Cmu_2" alt="formula"> &#x7684;&#x53C2;&#x6570;&#x533A;&#x95F4;&#xFF0C;&#x6CE8;&#x610F;R&#x4E2D;&#x5BF9;&#x4E24;&#x4E2A;&#x6837;&#x672C;&#x6570;&#x4E0D;&#x540C;&#x4E14;&#x65B9;&#x5DEE;&#x672A;&#x77E5;&#x7684;&#x72EC;&#x7ACB;&#x6837;&#x672C;&#x7684;&#x8BA1;&#x7B97;&#xFF0C;&#x5176;&#x4E2D;</p>
<p><img src="https://latex.codecogs.com/gif.latex?T%20%3D%20%5Cfrac%7B%5Coverline%7BX%7D-%5Coverline%7BY%7D-%28%5Cmu_1-%5Cmu_2%29%7D%7B%5Csqrt%7B%5Cfrac%7B%5Ctilde%7BS%7D_1%5E2%7D%7Bn_1%7D%2B%5Cfrac%7B%5Ctilde%7BS%7D_2%5E2%7D%7Bn_2%7D%7D%7D%20%5Csim%20t%28v%29" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?v%3D%28%5Cfrac%7B%5Csigma_1%5E2%7D%7Bn_1%7D%2B%5Cfrac%7B%5Csigma_2%5E2%7D%7Bn_2%7D%29%5E2/%28%5Cfrac%7B%5Csigma_1%5E4%7D%7Bn_1%5E2%28n_1-1%29%7D%2B%5Cfrac%7B%5Csigma_2%5E4%7D%7Bn_2%5E2%28n_2-1%29%7D%29" alt="formula"></p>
<p>&#x8FD1;&#x4F3C;&#x4F7F;&#x7528; <img src="https://latex.codecogs.com/gif.latex?%5Chat%7Bv%7D%3D%28%5Cfrac%7B%5Ctilde%7BS%7D_1%5E2%7D%7Bn_1%7D%2B%5Cfrac%7B%5Ctilde%7BS%7D_2%5E2%7D%7Bn_2%7D%29%5E2/%28%5Cfrac%7B%5Ctilde%7BS%7D_1%5E4%7D%7Bn_1%5E2%28n_1-1%29%7D%2B%5Cfrac%7B%5Ctilde%7BS%7D_2%5E4%7D%7Bn_2%5E2%28n_2-1%29%7D%29" alt="formula"></p>
<pre><code class="lang-R">interval_estimate2&lt;-<span class="hljs-keyword">function</span>(x, y,
    sigma=c(-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>), var.equal=<span class="hljs-literal">FALSE</span>, alpha=<span class="hljs-number">0.05</span>){
    n1&lt;-length(x); n2&lt;-length(y)
    xb&lt;-mean(x); yb&lt;-mean(y)
    <span class="hljs-keyword">if</span> (all(sigma&gt;=<span class="hljs-number">0</span>)){
        tmp&lt;-qnorm(<span class="hljs-number">1</span>-alpha/<span class="hljs-number">2</span>)*sqrt(sigma[<span class="hljs-number">1</span>]^<span class="hljs-number">2</span>/n1+sigma[<span class="hljs-number">2</span>]^<span class="hljs-number">2</span>/n2)
        df&lt;-n1+n2
    }
    <span class="hljs-keyword">else</span>{
        <span class="hljs-keyword">if</span> (var.equal == <span class="hljs-literal">TRUE</span>){
            Sw&lt;-((n1-<span class="hljs-number">1</span>)*var(x)+(n2-<span class="hljs-number">1</span>)*var(y))/(n1+n2-<span class="hljs-number">2</span>)
            tmp&lt;-sqrt(Sw*(<span class="hljs-number">1</span>/n1+<span class="hljs-number">1</span>/n2))*qt(<span class="hljs-number">1</span>-alpha/<span class="hljs-number">2</span>,n1+n2-<span class="hljs-number">2</span>)
            df&lt;-n1+n2-<span class="hljs-number">2</span>
        }
        <span class="hljs-keyword">else</span>{
            S1&lt;-var(x); S2&lt;-var(y)
            nu&lt;-(S1/n1+S2/n2)^<span class="hljs-number">2</span>/(S1^<span class="hljs-number">2</span>/n1^<span class="hljs-number">2</span>/(n1-<span class="hljs-number">1</span>)+S2^<span class="hljs-number">2</span>/n2^<span class="hljs-number">2</span>/(n2-<span class="hljs-number">1</span>))
            tmp&lt;-qt(<span class="hljs-number">1</span>-alpha/<span class="hljs-number">2</span>, nu)*sqrt(S1/n1+S2/n2)
            df&lt;-nu
        }
    }
    data.frame(mean=xb-yb, df=df, a=xb-yb-tmp, b=xb-yb+tmp)
}
&gt; interval_estimate2(boys2018$legLength,filboys2015$legLength)
</code></pre>
<p>&#x5F97;&#x5230;</p>
<pre><code>  mean       df        a        b
1 1.067073 159.8948 -1.66276 3.796906
</code></pre><p>&#x5373;&#x533A;&#x95F4; <img src="https://latex.codecogs.com/gif.latex?%5B-1.66%2C3.80%5D" alt="formula"></p>
<p>&#x6211;&#x4EEC;&#x4F30;&#x8BA1; <img src="https://latex.codecogs.com/gif.latex?%5Csigma_1%5E2/%5Csigma_2%5E2" alt="formula"> &#x7684;&#x533A;&#x95F4;&#xFF0C;&#x5176;&#x4E2D;&#x7F6E;&#x4FE1;&#x533A;&#x95F4; <img src="https://latex.codecogs.com/gif.latex?%5B%5Cfrac%7BS_1%5E2/S_2%5E2%7D%7BF_%7B%5Calpha/2%7D%28n_1-1%2Cn_2-1%29%7D%2C%5Cfrac%7BS_1%5E2/S_2%5E2%7D%7BF_%7B1-%5Calpha/2%7D%28n_1-1%2Cn_2-1%29%7D%5D" alt="formula"></p>
<pre><code class="lang-R">&gt; interval_var2&lt;-<span class="hljs-keyword">function</span>(x,y,
        mu=c(<span class="hljs-literal">Inf</span>, <span class="hljs-literal">Inf</span>), alpha=<span class="hljs-number">0.05</span>){
    n1&lt;-length(x); n2&lt;-length(y)
    <span class="hljs-keyword">if</span> (all(mu&lt;<span class="hljs-literal">Inf</span>)){
        Sx2&lt;-<span class="hljs-number">1</span>/n1*sum((x-mu[<span class="hljs-number">1</span>])^<span class="hljs-number">2</span>); Sy2&lt;-<span class="hljs-number">1</span>/n2*sum((y-mu[<span class="hljs-number">2</span>])^<span class="hljs-number">2</span>)
        df1&lt;-n1; df2&lt;-n2
    }
    <span class="hljs-keyword">else</span>{
        Sx2&lt;-var(x); Sy2&lt;-var(y); df1&lt;-n1-<span class="hljs-number">1</span>; df2&lt;-n2-<span class="hljs-number">1</span>
    }
    r&lt;-Sx2/Sy2
    a&lt;-r/qf(<span class="hljs-number">1</span>-alpha/<span class="hljs-number">2</span>,df1,df2)
    b&lt;-r/qf(alpha/<span class="hljs-number">2</span>,df1,df2)
    data.frame(rate=r, df1=df1, df2=df2, a=a, b=b)
}
&gt; interval_var2(boys2018$legLength,filboys2015$legLength)
</code></pre>
<p>&#x5F97;&#x5230;</p>
<pre><code>       rate df1 df2         a        b
1 0.9983889  81  79 0.6416813 1.551476
</code></pre><p>&#x5373;&#x533A;&#x95F4; <img src="https://latex.codecogs.com/gif.latex?%5B0.64%2C%201.55%5D" alt="formula"></p>
<h4 id="&#x53C2;&#x6570;&#x5047;&#x8BBE;">&#x53C2;&#x6570;&#x5047;&#x8BBE;</h4>
<p><a href=""><img src="https://latex.codecogs.com/gif.latex?H_0%3A" alt="formula"> &#x7537;&#x751F;&#x817F;&#x957F;&#x5747;&#x503C; <img src="https://latex.codecogs.com/gif.latex?%5Cmu_1%3D%5Cmu_2" alt="formula"> </a> <img src="https://latex.codecogs.com/gif.latex?%5Cleftrightarrow" alt="formula"> <a href=""><img src="https://latex.codecogs.com/gif.latex?H_1%3A" alt="formula"> &#x7537;&#x751F;&#x817F;&#x957F;&#x5747;&#x503C; <img src="https://latex.codecogs.com/gif.latex?%5Cmu_1%20%5Cne%20%5Cmu_2" alt="formula"> </a></p>
<blockquote>
<p>&#x65B9;&#x6CD5;&#x7C7B;&#x4F3C;&#x4E8E;&#x53C2;&#x6570;&#x4F30;&#x8BA1;&#xFF0C;&#x5F15;&#x5165;&#x4E86;p-value&#x7684;&#x8BA1;&#x7B97;&#xFF0C;&#x8FD9;&#x91CC;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x914D;&#x5BF9;&#xFF0C;&#x5982;&#x679C;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x914D;&#x5BF9;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>t.test</code>&#x5E76;&#x5728;&#x53C2;&#x6570;&#x7F6E;<code>paired=True</code>&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x624B;&#x5199;</p>
</blockquote>
<pre><code class="lang-R">&gt; mean.test2&lt;-<span class="hljs-keyword">function</span>(x, y,
+                      sigma=c(-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>), var.equal=<span class="hljs-literal">FALSE</span>, side=<span class="hljs-number">0</span>){
+     n1&lt;-length(x); n2&lt;-length(y)
+     xb&lt;-mean(x); yb&lt;-mean(y)
+     <span class="hljs-keyword">if</span> (all(sigma&gt;<span class="hljs-number">0</span>)){
+         z&lt;-(xb-yb)/sqrt(sigma[<span class="hljs-number">1</span>]^<span class="hljs-number">2</span>/n1+sigma[<span class="hljs-number">2</span>]^<span class="hljs-number">2</span>/n2)
+         P&lt;-P_value(pnorm, z, side=side)
+         data.frame(mean=xb-yb, df=n1+n2, Z=z, P_value=P)
+     }
+     <span class="hljs-keyword">else</span>{
+         <span class="hljs-keyword">if</span> (var.equal == <span class="hljs-literal">TRUE</span>){
+             Sw&lt;-sqrt(((n1-<span class="hljs-number">1</span>)*var(x)+(n2-<span class="hljs-number">1</span>)*var(y))/(n1+n2-<span class="hljs-number">2</span>))
+             t&lt;-(xb-yb)/(Sw*sqrt(<span class="hljs-number">1</span>/n1+<span class="hljs-number">1</span>/n2))
+             nu&lt;-n1+n2-<span class="hljs-number">2</span>
+         }
+         <span class="hljs-keyword">else</span>{
+             S1&lt;-var(x); S2&lt;-var(y)
+             nu&lt;-(S1/n1+S2/n2)^<span class="hljs-number">2</span>/(S1^<span class="hljs-number">2</span>/n1^<span class="hljs-number">2</span>/(n1-<span class="hljs-number">1</span>)+S2^<span class="hljs-number">2</span>/n2^<span class="hljs-number">2</span>/(n2-<span class="hljs-number">1</span>))
+             t&lt;-(xb-yb)/sqrt(S1/n1+S2/n2)
+         }
+         P&lt;-P_value(pt, t, paramet=nu, side=side)
+         data.frame(mean=xb-yb, df=nu, <span class="hljs-literal">T</span>=t, P_value=P)
+     }
+ }
&gt; mean.test2(boys2018$legLength,filboys2015$legLength)
</code></pre>
<p>&#x5F97;&#x5230;</p>
<pre><code>      mean       df         T   P_value
1 1.067073 159.8948 0.7719795 0.4412661
</code></pre><p>&#x5F97;&#x5230; <img src="https://latex.codecogs.com/gif.latex?p-value%3E%5Calpha" alt="formula">&#xFF0C;&#x63A5;&#x53D7;&#x539F;&#x5047;&#x8BBE;</p>
<p><a href=""><img src="https://latex.codecogs.com/gif.latex?H_0%3A" alt="formula"> &#x7537;&#x751F;&#x817F;&#x957F;&#x5747;&#x503C; <img src="https://latex.codecogs.com/gif.latex?%5Csigma_1%5E2%3D%5Csigma_2%5E2" alt="formula"> </a> <img src="https://latex.codecogs.com/gif.latex?%5Cleftrightarrow" alt="formula"> <a href=""><img src="https://latex.codecogs.com/gif.latex?H_1%3A" alt="formula"> &#x7537;&#x751F;&#x817F;&#x957F;&#x5747;&#x503C; <img src="https://latex.codecogs.com/gif.latex?%5Csigma_1%5E2%5Cne%20%5Csigma_2%5E2" alt="formula"> </a></p>
<blockquote>
<p>&#x65B9;&#x6CD5;&#x7C7B;&#x4F3C;&#x4E8E;&#x53C2;&#x6570;&#x4F30;&#x8BA1;&#xFF0C;&#x5F15;&#x5165;&#x4E86;p-value&#x7684;&#x8BA1;&#x7B97;</p>
</blockquote>
<pre><code class="lang-R">&gt; var.test2&lt;-<span class="hljs-keyword">function</span>(x, y, mu=c(<span class="hljs-literal">Inf</span>, <span class="hljs-literal">Inf</span>), side=<span class="hljs-number">0</span>){
+     n1&lt;-length(x); n2&lt;-length(y)
+     <span class="hljs-keyword">if</span> (all(mu&lt;<span class="hljs-literal">Inf</span>)){
+         Sx2&lt;-sum((x-mu[<span class="hljs-number">1</span>])^<span class="hljs-number">2</span>)/n1; Sy2&lt;-sum((y-mu[<span class="hljs-number">2</span>])^<span class="hljs-number">2</span>)/n2
+         df1=n1; df2=n2
+     }
+     <span class="hljs-keyword">else</span>{
+         Sx2&lt;-var(x); Sy2&lt;-var(y); df1=n1-<span class="hljs-number">1</span>; df2=n2-<span class="hljs-number">1</span>
+     } 
+     r&lt;-Sx2/Sy2
+     P&lt;-P_value(pf, r, paramet=c(df1, df2), side=side)
+     data.frame(rate=r, df1=df1, df2=df2, <span class="hljs-literal">F</span>=r, P_value=P)
+ }
&gt; 
&gt; var.test2(boys2018$legLength,filboys2015$legLength)
</code></pre>
<p>&#x5F97;&#x5230;&#x7ED3;&#x679C;</p>
<pre><code>       rate df1 df2         F   P_value
1 0.9983889  81  79 0.9983889 0.9935202
</code></pre><p>&#x5F97;&#x5230; <img src="https://latex.codecogs.com/gif.latex?p-value%3E%5Calpha" alt="formula">&#xFF0C;&#x63A5;&#x53D7;&#x539F;&#x5047;&#x8BBE;</p>
<h4 id="&#x975E;&#x53C2;&#x5047;&#x8BBE;">&#x975E;&#x53C2;&#x5047;&#x8BBE;</h4>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x4E3B;&#x8981;&#x6307;<a href="">&#x53CC;&#x603B;&#x4F53;K.S.&#x68C0;&#x9A8C;</a>
&#x5047;&#x8BBE;&#x4E24;&#x5E74;&#x7537;&#x751F;&#x817F;&#x957F;&#x7684;&#x5206;&#x5E03;&#x51FD;&#x6570;&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?F%28x%29" alt="formula"> &#x4E0E; <img src="https://latex.codecogs.com/gif.latex?G%28x%29" alt="formula"></p>
</blockquote>
<p><a href=""><img src="https://latex.codecogs.com/gif.latex?H_0%3A" alt="formula"> &#x5206;&#x5E03;&#x51FD;&#x6570; <img src="https://latex.codecogs.com/gif.latex?F%28x%29%3DG%28x%29" alt="formula"> </a> <img src="https://latex.codecogs.com/gif.latex?%5Cleftrightarrow" alt="formula"> <a href=""><img src="https://latex.codecogs.com/gif.latex?H_1%3A" alt="formula"> &#x5206;&#x5E03;&#x51FD;&#x6570; <img src="https://latex.codecogs.com/gif.latex?F%28x%29%5Cne%20G%28x%29" alt="formula"> </a></p>
<pre><code class="lang-R">&gt; ks.test(boys2018$legLength,filboys2015$legLength)
</code></pre>
<pre><code class="lang-R">D = <span class="hljs-number">0.094207</span>, p-value = <span class="hljs-number">0.865</span>
alternative hypothesis: two-sided
</code></pre>
<p>&#x5F97;&#x5230; <img src="https://latex.codecogs.com/gif.latex?p-value%3E%5Calpha" alt="formula">&#xFF0C;&#x63A5;&#x53D7;&#x539F;&#x5047;&#x8BBE;</p>
<blockquote>
<p>&#x5F53;&#x7136;&#x4E5F;&#x53EF;&#x4EE5;&#x7528; <a href="">Wilcoxon&#x79E9;&#x68C0;&#x9A8C;</a></p>
</blockquote>
<pre><code class="lang-R">&gt; wilcox.test(boys2018$legLength,filboys2015$legLength,alternative=<span class="hljs-string">&quot;less&quot;</span>,exact=<span class="hljs-literal">FALSE</span>,correct=<span class="hljs-literal">FALSE</span>)
</code></pre>
<p>&#x5F97;&#x5230;</p>
<pre><code>W = 3526, p-value = 0.7955
alternative hypothesis: true location shift is less than 0
</code></pre><p>&#x5F97;&#x5230; <img src="https://latex.codecogs.com/gif.latex?p-value%3E%5Calpha" alt="formula">&#xFF0C;&#x63A5;&#x53D7;&#x539F;&#x5047;&#x8BBE;</p>
<h4 id="&#x72EC;&#x7ACB;&#x6027;&#x68C0;&#x9A8C;">&#x72EC;&#x7ACB;&#x6027;&#x68C0;&#x9A8C;</h4>
<p><code>&#x72EC;&#x7ACB;&#x6027;&#x68C0;&#x9A8C;&#x5206;&#x6563;&#x5728;&#x4E0D;&#x540C;&#x6A21;&#x5757;&#x91CC;&#xFF0C;&#x4E00;&#x822C;&#x60C5;&#x51B5;&#x4E0B;&#x7684;&#x72EC;&#x7ACB;&#x6027;&#x68C0;&#x9A8C;&#x6709;&#x8FDE;&#x7EED;&#x578B;&#x53D8;&#x91CF;&#x4E4B;&#x95F4;&#x7684;&#xFF0C;&#x5B9E;&#x9645;&#x5C31;&#x662F;&#x76F8;&#x5173;&#x5206;&#x6790;&#xFF0C;&#x8FDE;&#x7EED;&#x578B;&#x548C;&#x5206;&#x7C7B;&#x53D8;&#x91CF;&#x4E4B;&#x95F4;&#x7684;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x65B9;&#x5DEE;&#x5206;&#x6790;&#xFF0C;&#x8FD8;&#x6709;&#x5206;&#x7C7B;&#x53D8;&#x91CF;&#x4E4B;&#x95F4;&#x7684;&#x4E00;&#x822C;&#x4F7F;&#x7528;chi-square test&#xFF0C;&#x800C;&#x8FD9;&#x91CC;&#x6CA1;&#x6709;&#x4E24;&#x4E2A;&#x4EE5;&#x4E0A;&#x7684;&#x5206;&#x7C7B;&#x53D8;&#x91CF;&#xFF0C;&#x56E0;&#x6B64;&#x4E0D;&#x505A;&#x5206;&#x7C7B;&#x53D8;&#x91CF;&#x7684;&#x72EC;&#x7ACB;&#x6027;&#x68C0;&#x9A8C;</code></p>
<h3 id="&#x591A;&#x5143;&#x4F30;&#x8BA1;&#x68C0;&#x9A8C;">&#x591A;&#x5143;&#x4F30;&#x8BA1;&#x68C0;&#x9A8C;</h3>
<p>&#x6211;&#x4EEC;&#x53D6;2018&#x5E74;&#x6E05;&#x6D17;&#x540E;&#x7684;&#x7537;&#x751F;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x5206;&#x6790;</p>
<p><code>&#x5B9E;&#x9645;&#x4E0A;&#x8FD9;&#x4E00;&#x5757;&#x5341;&#x5206;&#x91CD;&#x8981;&#xFF0C;&#x5BF9;&#x4E8E;&#x6570;&#x636E;&#x7684;&#x5206;&#x6790;&#x4EC5;&#x4ECE;&#x4E00;&#x5143;&#x6765;&#x770B;&#x662F;&#x7247;&#x9762;&#x7684;</code></p>
<h4 id="&#x534F;&#x65B9;&#x5DEE;&#x77E9;&#x9635;&#x4F30;&#x8BA1;">&#x534F;&#x65B9;&#x5DEE;&#x77E9;&#x9635;&#x4F30;&#x8BA1;</h4>
<p>&#x5B9A;&#x4E49;&#x8D44;&#x6599;&#x9635;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Cbegin%7Bbmatrix%7D%0AX_%7B11%7D%20%26%20X_%7B12%7D%20%26%20%5Cddots%20%26%20X%7B1p%7D%5C%5C%0AX_%7B21%7D%20%26%20X_%7B22%7D%20%26%20%5Cddots%20%26%20X%7B2p%7D%5C%5C%0A%5Cvdots%20%26%20%5Cvdots%20%26%20%5Cddots%20%20%26%20%5Cvdots%20%20%5C%5C%0AX_%7Bn1%7D%20%26%20X_%7Bn2%7D%20%26%20%5Cddots%20%26%20X%7Bnp%7D%0A%5Cend%7Bbmatrix%7D%0A" alt="formula"></p>
<p>&#x5B9A;&#x4E49;&#x5411;&#x91CF; <img src="https://latex.codecogs.com/gif.latex?X_%7B%28a%29%7D%3D%28X_%7Ba1%7D%2CX_%7Ba2%7D%2C...%2CX_%7Bap%7D%29%5ET" alt="formula"> &#x6709;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Cmu%20%3D%20%5Csum%5Cfrac%7B1%7D%7Bn%7DX_%7B%28a%29%7D%0A" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AS%20%3D%20%5Csum%7B%28X_%7B%28a%29%7D-%5Coverline%7BX%7D%29%28%28X_%7B%28a%29%7D-%5Coverline%7BX%7D%29%5ET%7D%0A" alt="formula"></p>
<p>&#x6211;&#x4EEC;&#x5BB9;&#x6613;&#x5F97;&#x5230;&#x4F3C;&#x7136;&#x51FD;&#x6570;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AlnL%28%5Cmu%2C%5CSigma%29%3D-%5Cfrac%7B1%7D%7B2%7Dpnln%282%5Cpi%29-%5Cfrac%7Bn%7D%7B2%7Dln%7C%5CSigma%7C-%5Cfrac%7B1%7D%7B2%7D%5Csum%28X_i-%5Cmu%29%5ET%5CSigma%5E%7B-1%7D%28X_i-%5Cmu%29%0A" alt="formula"></p>
<p>&#x7531; <img src="https://latex.codecogs.com/gif.latex?%5Cfrac%7B%5Cpartial%7BX%5ETAX%7D%7D%7B%5Cpartial%7BX%7D%7D%3D2AX" alt="formula"> &#x548C; <img src="https://latex.codecogs.com/gif.latex?%5Cfrac%7B%5Cpartial%7BX%5ETAX%7D%7D%7B%5Cpartial%7BA%7D%7D%3DXX%5ET" alt="formula"> &#x548C; <img src="https://latex.codecogs.com/gif.latex?%5Cfrac%7B%5Cpartial%7Bln%7CA%7C%7D%7D%7B%5Cpartial%7BA%7D%7D%3DA%5E%7B-1%7D" alt="formula"> &#x53EF;&#x4EE5;&#x6C42;&#x5F97;&#x6781;&#x503C; <img src="https://latex.codecogs.com/gif.latex?%5Chat%7B%5Cmu%7D%20%3D%20%5Coverline%7BX%7D" alt="formula"> &#x4E0E; <img src="https://latex.codecogs.com/gif.latex?%5Chat%7B%5CSigma%7D%3D%5Cfrac%7B1%7D%7Bn%7DS" alt="formula"></p>
<p>&#x5728;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<code>MASS</code>&#x5305;&#x4E2D;&#x7684;&#x4F30;&#x8BA1;&#x51FD;&#x6570;&#xFF0C;&#x56E0;&#x4E3A;&#x4ED6;&#x7684;&#x505A;&#x6CD5;&#x66F4;&#x52A0;&#x7684;&#x7A33;&#x5065;&#xFF0C;&#x8BE6;&#x7EC6;&#x53EF;&#x4EE5;&#x53C2;&#x8003;<code>MASS</code><a href="https://cran.r-project.org/web/packages/MASS/MASS.pdf" target="_blank">&#x6587;&#x6863;</a></p>
<pre><code class="lang-R">&gt; cov.rob(filboys2015)
</code></pre>
<pre><code>$center
    height    armSpan footLength  legLength     weight 
 176.26562  175.70312   25.82031   99.17188   67.37500 

$cov
              height  armSpan footLength legLength    weight
height     22.515625 26.22297   4.159598 17.001240 19.438492
armSpan    26.222966 45.51364   5.850570 16.972470 23.906746
footLength  4.159598  5.85057   2.193390  1.888517  5.727183
legLength  17.001240 16.97247   1.888517 40.493800 14.791667
weight     19.438492 23.90675   5.727183 14.791667 78.365079

$msg
[1] &quot;16 singular samples of size 6 out of 3000&quot;

$crit
[1] 30.99061

$best
 [1]  2  3  9 13 14 15 16 21 22 23 24 30 32 33 34 35 36 37 39 40 42 44 45 46 47 48
[27] 49 50 52 56 57 58 59 63 65 67 69 70 71 74 75 76 77

$n.obs
[1] 80
</code></pre><p>&#x53EF;&#x5728;<code>cov</code>&#x680F;&#x5F97;&#x5230;&#x534F;&#x65B9;&#x5DEE;&#x77E9;&#x9635;&#x7684;&#x4F30;&#x8BA1;</p>
<h4 id="&#x6B63;&#x6001;&#x68C0;&#x9A8C;">&#x6B63;&#x6001;&#x68C0;&#x9A8C;</h4>
<p><code>&#x591A;&#x5143;&#x5047;&#x8BBE;&#x68C0;&#x9A8C;&#x6709;&#x5F88;&#x591A;&#x65B9;&#x6CD5;&#xFF0C;&#x56E0;&#x4E3A;&#x591A;&#x5143;&#x53EF;&#x4EE5;&#x6784;&#x9020;&#x51FA;&#x8BB8;&#x591A;&#x5206;&#x5E03;&#x6BD4;&#x5982;Wishart&#x5206;&#x5E03;&#x6216;&#x8005;Hoteling&#x5206;&#x5E03;&#x7B49;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x505A;&#x7A7A;&#x95F4;&#x7B26;&#x53F7;&#x548C;&#x79E9;&#x68C0;&#x9A8C;&#xFF0C;&#x8FD9;&#x91CC;&#x4F5C;&#x4E3A;TODO&#x9879;</code></p>
<p>&#x8FD9;&#x91CC;&#x4F7F;&#x7528;<a href="">Shapiro-Wilk</a>&#x6B63;&#x6001;&#x68C0;&#x9A8C;&#x6CD5;</p>
<pre><code class="lang-R">&gt; mshapiro.test(t(filboys2015))
</code></pre>
<p>&#x5F97;&#x5230;</p>
<pre><code>    Shapiro-Wilk normality test

data:  Z
W = 0.61171, p-value = 3.167e-13
</code></pre><p>&#x53EF;&#x89C1;&#x62D2;&#x7EDD;&#x539F;&#x5047;&#x8BBE;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x7B26;&#x5408;&#x591A;&#x5143;&#x6B63;&#x6001;&#x5206;&#x5E03;</p>
<p>&#x53E6;&#x5916;&#x53EF;&#x4EE5;&#x753B;&#x51FA;QQ&#x56FE;</p>
<pre><code class="lang-R">&gt; center&lt;-colMeans(filboys2015)
&gt; n&lt;-nrow(filboys2015)
&gt; p&lt;-ncol(filboys2015)
&gt; cov&lt;-cov(filboys2015)
&gt; d&lt;-mahalanobis(filboys2015, center, cov)
&gt; coord&lt;-qqplot(qchisq(ppoints(n),df=p), d, main=<span class="hljs-string">&quot;QQ Plot Assessing Multivariate Normality&quot;</span>, ylab=<span class="hljs-string">&quot;Mahalanobis D2&quot;</span>)
&gt; abline(a=<span class="hljs-number">0</span>, b=<span class="hljs-number">1</span>)
</code></pre>
<p><img src="img/qq.png" alt="qq"></p>
<p><strong>&#x7ED3;&#x8BBA;</strong>&#xFF1A;&#x5BF9;&#x5176;&#x4ED6;&#x6570;&#x636E;&#x4E5F;&#x7ECF;&#x8FC7;&#x68C0;&#x9A8C;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8FD1;&#x4F3C;&#x8BA4;&#x4E3A;&#x603B;&#x4F53;&#x6570;&#x636E;&#x5C5E;&#x4E8E;&#x6B63;&#x6001;&#x5206;&#x5E03;</p>
<h2 id="&#x76F8;&#x5173;&#x5206;&#x6790;">&#x76F8;&#x5173;&#x5206;&#x6790;</h2>
<h3 id="&#x4E00;&#x5143;&#x7EBF;&#x6027;&#x76F8;&#x5173;&#x5206;&#x6790;">&#x4E00;&#x5143;&#x7EBF;&#x6027;&#x76F8;&#x5173;&#x5206;&#x6790;</h3>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x4EE5;2018&#x5E74;&#x7537;&#x751F;&#x817F;&#x957F;&#x6570;&#x636E;&#x548C;2018&#x5E74;&#x7537;&#x751F;&#x8EAB;&#x9AD8;&#x4E3A;&#x4F8B;</p>
</blockquote>
<p>&#x753B;&#x51FA;&#x6563;&#x70B9;&#x56FE;&#x6709;</p>
<pre><code class="lang-R">&gt; plot(filboys2018$legLength, filboys2018$height)
</code></pre>
<p><img src="img/height_legLength.png" alt="height_legLength"></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x817F;&#x957F;&#x548C;&#x8EAB;&#x9AD8;&#x6709;&#x6BD4;&#x8F83;&#x5F31;&#x7684;&#x6B63;&#x76F8;&#x5173;&#x5173;&#x7CFB;</p>
<p>&#x5BF9;&#x4E8E;&#x6570;&#x636E;&#xFF0C;&#x5BB9;&#x6613;&#x5F97;&#x5230;&#x5BF9;&#x4E8E;&#x56DE;&#x5F52;&#x65B9;&#x7A0B; <img src="https://latex.codecogs.com/gif.latex?y%3D%5Cbeta_0%2B%5Cbeta_1x%2B%20%5Cepsilon" alt="formula"> &#x7684;&#x4F30;&#x8BA1;&#x503C;&#x5373;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Chat%7B%5Cbeta_1%7D%3D%5Cfrac%7Bl_%7Bxy%7D%7D%7Bl_%7Bxx%7D%7D%0A" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Chat%7B%5Cbeta_0%7D%3D%5Coverline%7By%7D-%5Chat%7B%5Cbeta_1%7D%5Coverline%7Bx%7D%0A" alt="formula"></p>
<p>&#x5E76;&#x4E14;&#x6709;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AVar%28%5Chat%7B%5Cbeta_1%7D%29%3D%5Cfrac%7B%5Csigma%5E2%7D%7Bl_%7Bxx%7D%7D%0A" alt="formula"></p>
<p>&#x6211;&#x4EEC;&#x4F7F;&#x7528;</p>
<pre><code class="lang-R">&gt; lm.sol&lt;-lm(filboys2018$height ~ <span class="hljs-number">1</span>+filboys2018$legLength)
&gt; summary(lm.sol)
</code></pre>
<p>&#x53EF;&#x4EE5;&#x5F97;&#x5230;</p>
<pre><code>Residuals:
    Min      1Q  Median      3Q     Max 
-9.7477 -3.3405 -0.4951  3.3768 10.3760 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           139.04026    9.19274  15.125  &lt; 2e-16 ***
filboys2018$legLength   0.37457    0.09101   4.116 0.000104 ***
---
Signif. codes:  0 &#x2018;***&#x2019; 0.001 &#x2018;**&#x2019; 0.01 &#x2018;*&#x2019; 0.05 &#x2018;.&#x2019; 0.1 &#x2018; &#x2019; 1

Residual standard error: 4.979 on 70 degrees of freedom
Multiple R-squared:  0.1948,    Adjusted R-squared:  0.1833 
F-statistic: 16.94 on 1 and 70 DF,  p-value: 0.0001039
</code></pre><p>&#x53EF;&#x4EE5;&#x5F97;&#x5230; <img src="https://latex.codecogs.com/gif.latex?%5Cbeta_0%3D139" alt="formula"> &#x4E14; <img src="https://latex.codecogs.com/gif.latex?%5Cbeta_1%3D0.37" alt="formula">
&#x4E5F;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x533A;&#x95F4;&#x4F30;&#x8BA1;&#xFF0C;&#x5BB9;&#x6613;&#x8BC1;&#x660E;&#x5F97;&#x5230;&#x6027;&#x8D28;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AT_i%3D%5Cfrac%7B%5Chat%7B%5Cbeta_i%7D-%5Cbeta_i%7D%7Bsd%28%5Chat%7B%5Cbeta_i%7D%29%7D%20%5Csim%20t%28n-2%29%0A" alt="formula"></p>
<pre><code class="lang-R">&gt; beta.int&lt;-<span class="hljs-keyword">function</span>(fm,alpha=<span class="hljs-number">0.05</span>){
    A&lt;-summary(fm)$coefficients
    df&lt;-fm$df.residual
    left&lt;-A[,<span class="hljs-number">1</span>]-A[,<span class="hljs-number">2</span>]*qt(<span class="hljs-number">1</span>-alpha/<span class="hljs-number">2</span>, df)
    right&lt;-A[,<span class="hljs-number">1</span>]+A[,<span class="hljs-number">2</span>]*qt(<span class="hljs-number">1</span>-alpha/<span class="hljs-number">2</span>, df)
    rowname&lt;-dimnames(A)[[<span class="hljs-number">1</span>]]
    colname&lt;-c(<span class="hljs-string">&quot;Estimate&quot;</span>, <span class="hljs-string">&quot;Left&quot;</span>, <span class="hljs-string">&quot;Right&quot;</span>)
    matrix(c(A[,<span class="hljs-number">1</span>], left, right), ncol=<span class="hljs-number">3</span>,
    dimnames = list(rowname, colname ))
}
&gt; beta.int(lm.sol)
</code></pre>
<p>&#x53EF;&#x4EE5;&#x5F97;&#x5230;</p>
<pre><code>                        Estimate        Left       Right
(Intercept)           139.0402615 120.7059189 157.3746041
filboys2018$legLength   0.3745662   0.1930588   0.5560735
</code></pre><p>&#x6545; <img src="https://latex.codecogs.com/gif.latex?%5Cbeta_0" alt="formula"> &#x533A;&#x95F4; [120.71, 157.37] &#xFF0C;<img src="https://latex.codecogs.com/gif.latex?%5Cbeta_1" alt="formula"> &#x533A;&#x95F4; [0.19, 0.56]</p>
<p>&#x8FDB;&#x4E00;&#x6B65;&#x68C0;&#x9A8C;  <img src="https://latex.codecogs.com/gif.latex?%5Cbeta_1" alt="formula"> &#x663E;&#x8457;&#x6027;&#xFF0C;&#x8BB0; <img src="https://latex.codecogs.com/gif.latex?%5Csigma" alt="formula"> &#x7684;&#x4F30;&#x8BA1;&#x91CF;  <img src="https://latex.codecogs.com/gif.latex?%5Chat%7B%5Csigma%7D%5E2%3D%5Cfrac%7BQ_e%7D%7Bn-2%7D" alt="formula"> &#x5728; <img src="https://latex.codecogs.com/gif.latex?%5Cbeta_1%3D0" alt="formula"> &#x539F;&#x5047;&#x8BBE;&#x4E0B;&#x6709;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AT%20%3D%20%5Cfrac%7B%5Chat%7B%5Cbeta_1%7D%7D%7Bsd%28%5Chat%7B%5Cbeta_1%7D%29%7D%20%5Csim%20t%28n-2%29%0A" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AF%20%3D%20T%5E2%20%5Csim%20F%281%2Cn-2%29%0A" alt="formula"></p>
<p>&#x5B9E;&#x9645;&#x4E0A;&#x4E0A;&#x9762;&#x7684;&#x7ED3;&#x679C;&#x5DF2;&#x7ECF;&#x628A;&#x5BF9;&#x5E94;&#x7684;p-value&#x6C42;&#x4E86;&#x51FA;&#x6765;&#xFF0C;&#x5E76;&#x4E14;&#x5BF9;&#x4E8E;T&#x68C0;&#x9A8C;&#x548C;F&#x68C0;&#x9A8C;&#x90FD;&#x6709; <img src="https://latex.codecogs.com/gif.latex?p-value%3C%5Calpha" alt="formula"> &#x6545;&#x62D2;&#x7EDD;&#x539F;&#x5047;&#x8BBE;&#xFF0C;&#x4E5F;&#x5C31;&#x662F; <img src="https://latex.codecogs.com/gif.latex?%5Cbeta_1%20%E2%89%A0%200" alt="formula"></p>
<p>&#x8FDB;&#x4E00;&#x6B65;&#x6211;&#x4EEC;&#x753B;&#x51FA;&#x5176;&#x56FE;&#x50CF;&#x6709;</p>
<p><img src="img/line.png" alt="line"></p>
<h3 id="&#x591A;&#x5143;&#x7EBF;&#x6027;&#x76F8;&#x5173;&#x5206;&#x6790;">&#x591A;&#x5143;&#x7EBF;&#x6027;&#x76F8;&#x5173;&#x5206;&#x6790;</h3>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x4EE5;2018&#x5E74;&#x7537;&#x751F;&#x6570;&#x636E;&#x4E3A;&#x4F8B;</p>
</blockquote>
<p>&#x6211;&#x4EEC;&#x9996;&#x5148;&#x753B;&#x51FA;&#x6563;&#x70B9;&#x56FE;&#x548C;&#x70ED;&#x56FE;</p>
<pre><code class="lang-R">&gt; plot(filboys2018)
&gt; corrgram(filboys2018,order=<span class="hljs-literal">TRUE</span>,lower.panel=panel.shade)
</code></pre>
<p><img src="img/2018boysr.png" alt="2018boysr"></p>
<p><img src="img/res.png" alt="res"></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;height&#x548C;&#x5927;&#x591A;&#x6570;&#x53D8;&#x91CF;&#x6709;&#x5173;</p>
<p>&#x5BF9;&#x4E8E;&#x56DE;&#x5F52;&#x65B9;&#x7A0B; <img src="https://latex.codecogs.com/gif.latex?Y%3DX%5Cbeta%2B%5Cepsilon" alt="formula"> &#xFF0C;&#x5176;&#x4E2D; <img src="https://latex.codecogs.com/gif.latex?E%28%5Cepsilon%29%20%3D%200" alt="formula"> &#x4E14; <img src="https://latex.codecogs.com/gif.latex?Var%28%5Cepsilon%29%3D%5Csigma%5E2I_n" alt="formula"></p>
<p>&#x53EF;&#x4EE5;&#x6C42;&#x5F97;
<img src="https://latex.codecogs.com/gif.latex?%0A%5Chat%7B%5Cbeta%7D%20%3D%20%28X%5ETX%29%5E%7B-1%7DX%5ETY%0A" alt="formula"></p>
<p>&#x8BB0; <img src="https://latex.codecogs.com/gif.latex?%5Chat%7B%5Csigma%7D%5E2%3D%5Cfrac%7BQ_e%7D%7Bn-2%7D" alt="formula"> &#x4E14; <img src="https://latex.codecogs.com/gif.latex?c_%7Bii%7D" alt="formula"> &#x4E3A; <img src="https://latex.codecogs.com/gif.latex?%28X%5ETX%29%5E%7B-1%7D" alt="formula"> &#x5BF9;&#x89D2;&#x7EBF;&#x4E0A;&#x5143;&#x7D20;&#x6709;
<img src="https://latex.codecogs.com/gif.latex?%0Asd%28%5Chat%7B%5Cbeta_i%7D%29%3D%5Chat%7B%5Csigma%7D%5Csqrt%7Bc_%7Bii%7D%7D%0A" alt="formula"></p>
<p>&#x8FDB;&#x4E00;&#x6B65;&#x5BF9;&#x56DE;&#x5F52;&#x7CFB;&#x6570;&#x548C;&#x65B9;&#x7A0B;&#x505A;&#x68C0;&#x9A8C;&#xFF0C;&#x6211;&#x4EEC;&#x6709;&#x6027;&#x8D28;&#xFF1A;
&#x5F53;&#x539F;&#x5047;&#x8BBE;&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?%5Cbeta_i%3D0" alt="formula"> &#x65F6;
<img src="https://latex.codecogs.com/gif.latex?%0AT_i%20%3D%20%5Cfrac%7B%5Chat%7B%5Cbeta_i%7D%7D%7B%5Chat%7B%5Csigma%7D%5Csqrt%7Bc_%7Bii%7D%7D%7D%20%5Csim%20t%28n-k-1%29%0A" alt="formula"></p>
<p>&#x5F53;&#x539F;&#x5047;&#x8BBE;&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?%5Cbeta_0%20%3D%20%5Cbeta_1%20%3D%20...%20%3D%20%5Cbeta_k%20%3D%200" alt="formula"> &#x65F6;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AF%20%3D%20%5Cfrac%7BU_R/k%7D%7BQ_e/%28n-k-1%29%7D%20%5Csim%20F%28k%2Cn-k-1%29%0A" alt="formula"></p>
<pre><code class="lang-R">&gt; lm.sol&lt;-lm(height ~ armSpan+footLength+legLength, data=filboys2018)
&gt; summary(lm.sol)
</code></pre>
<p>&#x53EF;&#x4EE5;&#x5F97;&#x5230;</p>
<pre><code>Call:
lm(formula = height ~ armSpan + footLength + legLength, data = filboys2018)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.6309 -2.1178  0.1168  2.3009  8.3289 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 66.67289   11.85242   5.625 3.79e-07 ***
armSpan      0.47164    0.07977   5.913 1.21e-07 ***
footLength   0.78728    0.39956   1.970   0.0529 .  
legLength    0.06728    0.07937   0.848   0.3996    
---
Signif. codes:  0 &#x2018;***&#x2019; 0.001 &#x2018;**&#x2019; 0.01 &#x2018;*&#x2019; 0.05 &#x2018;.&#x2019; 0.1 &#x2018; &#x2019; 1

Residual standard error: 3.701 on 68 degrees of freedom
Multiple R-squared:  0.5678,    Adjusted R-squared:  0.5487 
F-statistic: 29.78 on 3 and 68 DF,  p-value: 2.083e-12
</code></pre><p>&#x53EF;&#x4EE5;&#x770B;&#x5230; <img src="https://latex.codecogs.com/gif.latex?%5Cbeta_0" alt="formula"> &#x548C; <img src="https://latex.codecogs.com/gif.latex?%5Cbeta_1" alt="formula"> &#x663E;&#x8457;&#x6027;&#x9AD8;&#x5E76;&#x4E14;&#x660E;&#x663E;&#x9AD8;&#x8FC7; <img src="https://latex.codecogs.com/gif.latex?%5Cbeta_2" alt="formula"> &#x548C; <img src="https://latex.codecogs.com/gif.latex?%5Cbeta_3" alt="formula"></p>
<p>&#x56E0;&#x6B64;&#x5F97;&#x5230;&#x56DE;&#x5F52;&#x5173;&#x7CFB; <img src="https://latex.codecogs.com/gif.latex?height%3D%2066.67%20%2B%200.47%20%2A%20armSpan" alt="formula"></p>
<p>&#x6B64;&#x5916;&#x53EF;&#x4EE5;&#x4F30;&#x8BA1; <img src="https://latex.codecogs.com/gif.latex?%5Cbeta_i" alt="formula"> &#x7684;&#x533A;&#x95F4;</p>
<pre><code class="lang-R">&gt; beta.int(lm.sol)
</code></pre>
<pre><code>               Estimate        Left      Right
(Intercept) 66.67289203 43.02176522 90.3240188
armSpan      0.47164214  0.31246859  0.6308157
footLength   0.78728123 -0.01001885  1.5845813
legLength    0.06727684 -0.09111215  0.2256658
</code></pre><p>&#x5373; <img src="https://latex.codecogs.com/gif.latex?%5Cbeta_0" alt="formula"> &#x533A;&#x95F4;&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?%5B43%2C90%5D" alt="formula">&#xFF0C; <img src="https://latex.codecogs.com/gif.latex?%5Cbeta_1" alt="formula"> &#x533A;&#x95F4;&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?%5B0.3%2C0.6%5D" alt="formula">&#xFF0C; <img src="https://latex.codecogs.com/gif.latex?%5Cbeta_2" alt="formula"> &#x533A;&#x95F4;&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?%5B-0.01%2C1.58%5D" alt="formula">&#xFF0C; <img src="https://latex.codecogs.com/gif.latex?%5Cbeta_3" alt="formula"> &#x533A;&#x95F4;&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?%5B-0.09%2C0.23%5D" alt="formula"></p>
<p>&#x6B64;&#x5916;&#xFF0C;&#x6211;&#x4EEC;&#x518D;&#x7ED9;&#x51FA;&#x5176;&#x4ED6;&#x7684;&#x7EDF;&#x8BA1;</p>
<pre><code class="lang-R">&gt; anova(lm.sol) <span class="hljs-comment"># &#x534F;&#x65B9;&#x5DEE;&#x5206;&#x6790;</span>
&gt; vcov(lm.sol) <span class="hljs-comment"># &#x534F;&#x65B9;&#x5DEE;&#x77E9;&#x9635;</span>
&gt; AIC(lm.sol) <span class="hljs-comment"># AIC&#x503C;</span>
</code></pre>
<pre><code>Analysis of Variance Table

Response: height
           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
armSpan     1 1160.72 1160.72 84.7260 1.444e-13 ***
footLength  1   53.19   53.19  3.8824   0.05287 .  
legLength   1    9.84    9.84  0.7184   0.39964    
Residuals  68  931.58   13.70                      
---
Signif. codes:  0 &#x2018;***&#x2019; 0.001 &#x2018;**&#x2019; 0.01 &#x2018;*&#x2019; 0.05 &#x2018;.&#x2019; 0.1 &#x2018; &#x2019; 1

            (Intercept)      armSpan    footLength     legLength
(Intercept) 140.4797522 -0.473894443 -1.792107e+00 -1.050663e-01
armSpan      -0.4738944  0.006362852 -1.325108e-02 -3.011777e-03
footLength   -1.7921065 -0.013251077  1.596444e-01  5.659089e-07
legLength    -0.1050663 -0.003011777  5.659089e-07  6.300283e-03

[1] 398.6626
</code></pre><p>&#x9664;&#x4E86;&#x57FA;&#x4E8E;&#x6574;&#x4F53;&#x7684;&#x5047;&#x8BBE;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x9010;&#x6B65;&#x56DE;&#x5F52;&#x6765;&#x786E;&#x5B9A;&#x65B9;&#x7A0B;</p>
<blockquote>
<p>&#x9010;&#x6B65;&#x56DE;&#x5F52;&#x987E;&#x540D;&#x601D;&#x4E49;&#x5C31;&#x662F;&#x5C06;&#x53D8;&#x91CF;&#x6839;&#x636E;&#x663E;&#x8457;&#x6027;&#x4E00;&#x6B65;&#x4E00;&#x6B65;&#x5254;&#x9664;&#xFF0C;&#x5229;&#x7528;&#x7684;&#x662F;AIC&#xFF0C;&#x5254;&#x9664;&#x53D8;&#x91CF;&#x76F4;&#x81F3;AIC&#x65E0;&#x6CD5;&#x51CF;&#x5C0F;&#x3002;&#x5254;&#x9664;&#x6709;&#x5411;&#x524D;&#x5254;&#x9664;&#x548C;&#x5411;&#x540E;&#x5254;&#x9664;</p>
</blockquote>
<p><img src="https://latex.codecogs.com/gif.latex?AIC%3D2%28p%2B1%29-2ln%28L%29" alt="formula"> &#x5176;&#x4E2D;p&#x4E3A;&#x53D8;&#x91CF;&#x4E2A;&#x6570;&#xFF0C;L&#x4E3A;&#x4F3C;&#x7136;&#x51FD;&#x6570;&#xFF0C;&#x8FD9;&#x662F;&#x4ECE;&#x4FE1;&#x606F;&#x71B5;&#x5F15;&#x7533;&#x800C;&#x6765;&#x7684;&#xFF0C;AIC&#x8D8A;&#x5C0F;&#x8D8A;&#x5148;&#x88AB;&#x9009;&#x5165; &#x3002;</p>
<pre><code class="lang-R">&gt;  lm.step&lt;-step(lm.sol)
</code></pre>
<p>&#x53EF;&#x4EE5;&#x5F97;&#x5230;</p>
<pre><code>Start:  AIC=192.34
height ~ armSpan + footLength + legLength

             Df Sum of Sq     RSS    AIC
- legLength   1      9.84  941.42 191.09
&lt;none&gt;                     931.58 192.34
- footLength  1     53.19  984.77 194.33
- armSpan     1    478.94 1410.52 220.20

Step:  AIC=191.09
height ~ armSpan + footLength

             Df Sum of Sq     RSS    AIC
&lt;none&gt;                     941.42 191.09
- footLength  1     53.19  994.61 193.05
- armSpan     1    706.31 1647.73 229.40
</code></pre><h3 id="&#x7EBF;&#x6027;&#x76F8;&#x5173;&#x5206;&#x6790;&#x8BCA;&#x65AD;">&#x7EBF;&#x6027;&#x76F8;&#x5173;&#x5206;&#x6790;&#x8BCA;&#x65AD;</h3>
<h4 id="&#x6B8B;&#x5DEE;&#x8BCA;&#x65AD;">&#x6B8B;&#x5DEE;&#x8BCA;&#x65AD;</h4>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x5229;&#x7528;&#x591A;&#x5143;&#x7EBF;&#x6027;&#x5206;&#x6790;&#x4E2D;&#x7684;&#x4F8B;&#x5B50;&#x8FDB;&#x884C;&#x5206;&#x6790;</p>
</blockquote>
<p>&#x6211;&#x4EEC;&#x7531;&#x4E0A;&#x53EF;&#x4EE5;&#x77E5;&#x9053;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Chat%7BY%7D%3DX%5Chat%7B%5Cbeta%7D%3DX%28X%5ETX%29%5E%7B-1%7DX%5ET%0A" alt="formula"></p>
<p>&#x4EE4; <img src="https://latex.codecogs.com/gif.latex?H%3DX%28X%5ETX%29%5E%7B-1%7DX" alt="formula"> &#xFF0C;&#x5F88;&#x5BB9;&#x6613;&#x5F97;&#x5230;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Chat%7B%5Cepsilon%7D%3DY-%5Chat%7BY%7D%3D%28I-H%29Y%0A" alt="formula"></p>
<pre><code>&gt; y.res&lt;-residuals(lm.sol)
&gt; shapiro.test(y.res)
</code></pre><p>&#x5F97;&#x5230;</p>
<pre><code>    Shapiro-Wilk normality test

data:  y.res
W = 0.99194, p-value = 0.93
</code></pre><p>&#x6B8B;&#x5DEE;&#x6EE1;&#x8DB3;&#x6B63;&#x6001;&#x5206;&#x5E03;</p>
<p>&#x6211;&#x4EEC;&#x753B;&#x51FA;&#x6B8B;&#x5DEE;&#x56FE;&#x6709;</p>
<pre><code>&gt; y.res&lt;-resid(lm.sol); y.fit&lt;-predict(lm.sol)
&gt; plot(y.res~y.fit)
</code></pre><p><img src="img/redi.png" alt="redi"></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6B8B;&#x5DEE;&#x6563;&#x843D;&#x5747;&#x5300;&#xFF0C;&#x6211;&#x4EEC;&#x753B;&#x51FA;&#x6B8B;&#x5DEE;&#x56FE;&#x7684;&#x6B8B;&#x5DEE;&#x62DF;&#x5408;&#x56FE;&#xFF0C;qq&#x56FE;&#xFF0C;&#x6807;&#x51C6;&#x5316;&#x7684;&#x6B8B;&#x5DEE;&#x62DF;&#x5408;&#x56FE;&#xFF0C;cook&#x7EDF;&#x8BA1;&#x91CF;</p>
<p><img src="img/1.png" alt="1"></p>
<p><img src="img/2.png" alt="2"></p>
<p><img src="img/3.png" alt="3"></p>
<p><img src="img/4.png" alt="4"></p>
<h4 id="&#x5F71;&#x54CD;&#x5206;&#x6790;">&#x5F71;&#x54CD;&#x5206;&#x6790;</h4>
<blockquote>
<p>&#x5B9E;&#x9645;&#x4E0A;&#x8FD9;&#x91CC;&#x4E5F;&#x662F;<a href="">&#x5F02;&#x5E38;&#x503C;&#x5254;&#x9664;</a></p>
</blockquote>
<p><strong>Leverage</strong></p>
<p>&#x7531;&#x4E8E; <img src="https://latex.codecogs.com/gif.latex?%5Cfrac%7B%5Cpartial%7B%5Chat%7BY_i%7D%7D%7D%7B%5Cpartial%7BY_i%7D%7D%20%3D%20h_%7Bii%7D" alt="formula"> &#x53EF;&#x4EE5;&#x5C06; <img src="https://latex.codecogs.com/gif.latex?h_%7Bii%7D" alt="formula"> &#x4F5C;&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?%5Chat%7BY_i%7D" alt="formula"> &#x7684;&#x6CE2;&#x52A8;&#x60C5;&#x51B5;&#xFF0C;<code>hatvalues</code>&#x65B9;&#x6CD5;&#x6B63;&#x662F;&#x6E90;&#x6B64;&#xFF0C;&#x5176;&#x5B9A;&#x4E49;&#x9AD8;&#x5F71;&#x54CD;&#x529B;&#x6709; <img src="https://latex.codecogs.com/gif.latex?h_%7Bi_0i_0%7D%5Cge%5Cfrac%7Bp%2B1%7D%7Bn%7D" alt="formula"></p>
<pre><code class="lang-R">&gt; x&lt;-hatvalues(lm.sol)
&gt; hat(x)
</code></pre>
<p>&#x5F97;&#x5230;hat&#x503C;</p>
<pre><code> [1] 0.03246480 0.02286559 0.02521203 0.01882099 0.01656375 0.01570633 0.02236702
 [8] 0.02310991 0.02996563 0.02460854 0.01443147 0.02070820 0.02321306 0.02124561
[15] 0.02488378 0.22497581 0.01414895 0.01410585 0.01673542 0.01430929 0.02912389
[22] 0.01411938 0.01389593 0.05926596 0.03089287 0.01895241 0.01410693 0.05695030
[29] 0.03301396 0.06932189 0.02436087 0.05915690 0.02142940 0.02626729 0.01390682
[36] 0.01480688 0.02902800 0.01740637 0.02614754 0.01389072 0.01542304 0.01458261
[43] 0.02412903 0.01436137 0.02302298 0.01447584 0.02605434 0.01492020 0.13630301
[50] 0.01570781 0.02744483 0.02593631 0.01997261 0.02907229 0.02529973 0.02134384
[57] 0.01980937 0.02292906 0.03729968 0.02292093 0.02354883 0.01393528 0.02599842
[64] 0.01792652 0.02431693 0.01393677 0.02046278 0.01615501 0.02084545 0.02877880
[71] 0.01780844 0.01879157
</code></pre><p><strong>DFFITS</strong></p>
<p>&#x5229;&#x7528;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x6837;&#x672C;&#x65B9;&#x5DEE;&#x6765;&#x5224;&#x65AD;&#x6837;&#x672C;&#x7684;&#x5F71;&#x54CD;&#x529B;&#x5373;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AD_i%28%5Csigma%29%3D%5Csqrt%7B%5Cfrac%7Bh_%7Bii%7D%7D%7B1-h_%7Bii%7D%7D%7D%5Cfrac%7B%5Chat%7B%5Cepsilon_%7Bi%7D%7D%7D%7B%5Csigma%5Csqrt%7B1-h_%7Bii%7D%7D%7D%0A" alt="formula"></p>
<p>&#x5F71;&#x54CD;&#x529B;&#x8F83;&#x5927;&#x7684;&#x6570;&#x7B26;&#x5408;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%7CD_i%28%5Csigma%29%7C%3E2%5Csqrt%7B%5Cfrac%7Bp%2B1%7D%7Bn%7D%7D%0A" alt="formula"></p>
<pre><code class="lang-R">&gt; p&lt;-<span class="hljs-number">1</span>; n&lt;-nrow(filboys2018); d&lt;-dffits(lm.sol)
&gt; cf&lt;-<span class="hljs-number">1</span>:n; cf[d&gt;<span class="hljs-number">2</span>*sqrt((p+<span class="hljs-number">1</span>)/n)]
</code></pre>
<pre><code>[1]  1  9 28 30 31 51 56
</code></pre><p><strong>Cook&#x2019;s Distance</strong></p>
<p>&#x53EF;&#x4EE5;&#x5B9A;&#x4E49; Distance</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AD_i%3D%5Cfrac%7B1%7D%7Bp%2B1%7D%28%5Cfrac%7Bh_%7Bii%7D%7D%7B1-h_%7Bii%7D%7D%29r_i%5E2%0A" alt="formula"></p>
<pre><code class="lang-R">&gt; influencePlot(lm.sol)
</code></pre>
<p><img src="img/cook.png" alt="cook"></p>
<p>&#x5728;&#x8FD9;&#x91CC;&#x5706;&#x7684;&#x5927;&#x5C0F;&#x548C;Cook&#x8DDD;&#x79BB;&#x662F;&#x6210;&#x6B63;&#x6BD4;&#x7684;&#xFF0C;<strong>Bonferroni</strong> &#x68C0;&#x6D4B;&#x5F02;&#x5E38;&#x503C;</p>
<pre><code class="lang-R">&gt; outlierTest(lm.sol)
</code></pre>
<pre><code>No Studentized residuals with Bonferonni p &lt; 0.05
Largest |rstudent|:
   rstudent unadjusted p-value Bonferonni p
30 2.505368           0.014669           NA
</code></pre><p>&#x7B26;&#x5408;&#x76F4;&#x89C2;&#x663E;&#x793A;</p>
<p><strong>COVRATIO</strong></p>
<p>covratio&#x6BD4;&#x8F83;&#x7684;&#x662F;&#x53BB;&#x9664;&#x67D0;&#x503C;&#x4E4B;&#x540E;&#x534F;&#x65B9;&#x5DEE;&#x7684;&#x53D8;&#x5316;&#xFF0C;&#x4E0B;&#x6807;&#x610F;&#x5473;&#x7740;&#x5254;&#x9664;&#x4E86;&#x7B2C;&#x51E0;&#x4E2A;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0ACOVRATIO%20%3D%20%5Cfrac%7B%5Chat%7B%5Csigma_%7B%28i%29%7D%7D%5E%7Bp%2B1%7D%7D%7B%5Chat%7B%5Csigma%7D%5E%7Bp%2B1%7D%7D%5Cfrac%7B1%7D%7B1-h_%7Bii%7D%7D%0A" alt="formula"></p>
<p>&#x8DDD;&#x79BB;1&#x8D8A;&#x8FDC;&#x8D8A;&#x6709;&#x5F71;&#x54CD;&#xFF0C;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x6240;&#x6709;&#x7684;covratio</p>
<pre><code class="lang-R">&gt; covratio(lm.sol)
</code></pre>
<pre><code>        1         2         3         4         5         6         7         8 
1.0205162 1.0384683 1.0809780 1.0702756 1.1206153 0.8633260 1.0515415 0.9123826 
        9        10        11        12        13        14        15        16 
0.8739045 0.9589024 1.0667193 1.0888370 0.9976883 1.1271570 1.0822366 1.2970969 
       17        18        19        20        21        22        23        24 
1.1173772 1.0494906 1.1333311 1.0856048 1.0206446 1.1026310 1.1193516 1.2092618 
       25        26        27        28        29        30        31        32 
1.1561789 1.1457841 1.0069911 1.1483356 1.1295030 0.8530834 1.0743253 1.1647340 
       33        34        35        36        37        38        39        40 
0.8967857 1.0826309 1.1183581 1.0582992 1.0733011 1.1012301 1.0539441 1.1226727 
       41        42        43        44        45        46        47        48 
1.1072233 0.9316177 1.0821070 1.1042513 1.0878861 1.0424372 1.1449065 1.1048471 
       49        50        51        52        53        54        55        56 
1.2544314 1.0956020 1.0306151 0.8640927 1.0945977 1.0594028 1.1387814 0.8686899 
       57        58        59        60        61        62        63        64 
0.9279613 1.0756474 1.1795263 0.9678344 1.0804296 1.1204158 1.0709459 1.1384828 
       65        66        67        68        69        70        71        72 
1.0278919 1.1251657 1.0934691 1.0604063 0.7748261 1.0754330 1.0521803 1.0806991
</code></pre><p>&#x4EE5;&#x4E0A;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x7528;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#x5B9E;&#x73B0;</p>
<pre><code class="lang-R">&gt; influence.measures(lm.sol)
</code></pre>
<pre><code>Influence measures of
     lm(formula = height ~ armSpan + footLength + legLength, data = filboys2018) :

      dfb.1_  dfb.armS  dfb.ftLn  dfb.lgLn     dffit cov.r   cook.d    hat inf
1   0.153203 -0.454206  0.177074  0.352125  0.518241 1.021 6.57e-02 0.0990    
2  -0.067713  0.010720  0.000187  0.075453 -0.143681 1.038 5.18e-03 0.0253    
3  -0.011145  0.015269 -0.012647  0.004523 -0.034569 1.081 3.03e-04 0.0216    
4   0.086735 -0.030125 -0.041673 -0.026106 -0.120124 1.070 3.64e-03 0.0331    
5  -0.062679  0.100083 -0.097573  0.039236 -0.162178 1.121 6.64e-03 0.0721    
6   0.113390 -0.084601 -0.228839  0.262055 -0.434164 0.863 4.49e-02 0.0420    
7   0.012665 -0.004093  0.042277 -0.071151 -0.126745 1.052 4.04e-03 0.0262    
8  -0.003148 -0.126067  0.047302  0.176131  0.277642 0.912 1.87e-02 0.0249    
9   0.593325  0.003878 -0.515210 -0.205769  0.738002 0.874 1.28e-01 0.0960   *
10 -0.066153  0.105667  0.013462 -0.114208 -0.220441 0.959 1.20e-02 0.0225    
11 -0.211022  0.149732  0.009749  0.043968  0.260312 1.067 1.69e-02 0.0630    
12 -0.029930  0.008321  0.009274  0.016129 -0.043707 1.089 4.84e-04 0.0292    
13  0.106719 -0.117463  0.021726  0.027860  0.192909 0.998 9.24e-03 0.0247    
14 -0.139181  0.102537  0.093597 -0.090028  0.199258 1.127 1.00e-02 0.0829    
15  0.009203 -0.018288  0.003761  0.012253 -0.031214 1.082 2.47e-04 0.0221    
16 -0.039753  0.069558  0.163114 -0.268914  0.326159 1.297 2.68e-02 0.2022   *
17 -0.000236  0.000173 -0.000307  0.000464  0.000768 1.117 1.50e-07 0.0504    
18 -0.234735  0.144499  0.113994 -0.060234 -0.281486 1.049 1.97e-02 0.0603    
19  0.075181  0.016545 -0.070727 -0.051811 -0.111358 1.133 3.14e-03 0.0726    
20  0.099822 -0.033986 -0.100312  0.045635  0.153999 1.086 5.98e-03 0.0490    
21 -0.005245  0.039922 -0.026141 -0.034798 -0.123612 1.021 3.82e-03 0.0162    
22 -0.109363  0.017998  0.029551  0.096497  0.160531 1.103 6.50e-03 0.0604    
23 -0.043782  0.021997  0.018023  0.004435  0.051855 1.119 6.82e-04 0.0547    
24  0.029193 -0.032179  0.023430 -0.016075  0.051056 1.209 6.61e-04 0.1235   *
25 -0.085070 -0.068976  0.109181  0.109732  0.171893 1.156 7.47e-03 0.0972    
26 -0.004357  0.063808 -0.060211 -0.025955  0.081485 1.146 1.68e-03 0.0783    
27 -0.148465 -0.081731  0.123064  0.213348  0.308181 1.007 2.35e-02 0.0508    
28  0.116831  0.185327 -0.310924 -0.090782  0.344575 1.148 2.97e-02 0.1218    
29  0.027373 -0.115849 -0.064274  0.251353  0.281478 1.130 1.99e-02 0.0997    
30  0.478662 -0.311871  0.361161 -0.610496  0.971400 0.853 2.19e-01 0.1307   *
31  0.035778  0.246258 -0.142356 -0.293597  0.361662 1.074 3.25e-02 0.0882    
32 -0.101726  0.267069 -0.077062 -0.212954  0.302203 1.165 2.30e-02 0.1234    
33 -0.094990  0.218049 -0.116839 -0.103104 -0.310805 0.897 2.33e-02 0.0278    
34 -0.002116  0.003519 -0.000820 -0.001689  0.006482 1.083 1.07e-05 0.0201    
35  0.004661  0.037999 -0.027518 -0.036563  0.054804 1.118 7.61e-04 0.0542    
36 -0.146555  0.062307  0.008779  0.090436 -0.200453 1.058 1.01e-02 0.0459    
37  0.006094 -0.012257  0.010409  0.000917  0.037061 1.073 3.48e-04 0.0163    
38 -0.003036  0.007607 -0.003664 -0.004450 -0.009782 1.101 2.43e-05 0.0366    
39  0.035644  0.013142 -0.036844 -0.032712 -0.097058 1.054 2.37e-03 0.0202    
40 -0.007304  0.009136  0.004197 -0.010198  0.015604 1.123 6.18e-05 0.0551    
41 -0.010672 -0.002349 -0.002820  0.024579  0.032673 1.107 2.71e-04 0.0431    
42  0.333640 -0.368412 -0.034821  0.184896 -0.479735 0.932 5.56e-02 0.0640    
43  0.010384 -0.024675  0.013890  0.011652  0.039401 1.082 3.94e-04 0.0233    
44 -0.049489  0.072146 -0.003657 -0.045867  0.092271 1.104 2.15e-03 0.0486    
45 -0.003440  0.008077 -0.001487 -0.006625  0.013142 1.088 4.38e-05 0.0251    
46 -0.230210  0.002358  0.198664  0.088465  0.308218 1.042 2.36e-02 0.0633    
47  0.149996 -0.029986 -0.123065 -0.007009  0.178788 1.145 8.07e-03 0.0908    
48 -0.032298  0.016034 -0.014440  0.040410  0.068623 1.105 1.19e-03 0.0453    
49  0.020432 -0.182418  0.186029  0.053406  0.228851 1.254 1.32e-02 0.1672   *
50 -0.004981  0.034725  0.011780 -0.071539 -0.089087 1.096 2.01e-03 0.0419    
51  0.364947 -0.303386  0.082127 -0.104352  0.468815 1.031 5.40e-02 0.0927    
52 -0.128106 -0.025662  0.143796  0.036477 -0.285764 0.864 1.96e-02 0.0205    
53 -0.002181  0.001201  0.001241 -0.000360  0.003213 1.095 2.62e-06 0.0307    
54 -0.003656 -0.019178  0.024890  0.003403 -0.070467 1.059 1.25e-03 0.0162    
55 -0.129313  0.010032  0.159192 -0.035615 -0.195983 1.139 9.69e-03 0.0896    
56 -0.218650  0.157594  0.018485  0.036469  0.336814 0.869 2.72e-02 0.0280    
57 -0.109722  0.219488 -0.122529 -0.075481 -0.300936 0.928 2.20e-02 0.0310    
58  0.031193 -0.021445  0.012147 -0.027155 -0.071787 1.076 1.30e-03 0.0252    
59 -0.050761  0.009907  0.072246 -0.037229 -0.092566 1.180 2.17e-03 0.1044   *
60 -0.157231  0.090379  0.051906 -0.001820 -0.227370 0.968 1.27e-02 0.0252    
61 -0.003780  0.027509 -0.011880 -0.029470 -0.051539 1.080 6.73e-04 0.0242    
62 -0.006992 -0.007816  0.017070  0.001496 -0.019922 1.120 1.01e-04 0.0534    
63 -0.033110  0.003832  0.027861  0.003547 -0.063085 1.071 1.01e-03 0.0204    
64  0.062160 -0.053599  0.035028 -0.045735 -0.107667 1.138 2.94e-03 0.0758    
65  0.077772  0.011417 -0.061517 -0.049618  0.147657 1.028 5.46e-03 0.0230    
66  0.008682  0.006052 -0.024037  0.008309  0.029182 1.125 2.16e-04 0.0578    
67  0.002480 -0.001357 -0.002054  0.001195 -0.004365 1.093 4.83e-06 0.0297    
68 -0.024136  0.128230 -0.099960 -0.065782 -0.172082 1.060 7.44e-03 0.0404    
69  0.097134 -0.267474  0.044572  0.251918 -0.423303 0.775 4.17e-02 0.0289   *
70 -0.005540  0.007584 -0.008493  0.004333 -0.030539 1.075 2.36e-04 0.0166    
71 -0.125583  0.059331  0.047847  0.025878  0.166513 1.052 6.96e-03 0.0356    
72 -0.064880 -0.062859 -0.048025  0.261460 -0.299161 1.081 2.24e-02 0.0779
</code></pre><h4 id="&#x591A;&#x91CD;&#x5171;&#x7EBF;&#x6027;">&#x591A;&#x91CD;&#x5171;&#x7EBF;&#x6027;</h4>
<p><strong>&#x6761;&#x4EF6;&#x6570;</strong></p>
<p>&#x5BF9;&#x6B63;&#x5219;&#x5316;&#x540E;&#x7684; <img src="https://latex.codecogs.com/gif.latex?X" alt="formula"> &#xFF0C;&#x8BBE; <img src="https://latex.codecogs.com/gif.latex?X%5ETX" alt="formula"> &#x7684;&#x4E00;&#x4E2A;&#x7279;&#x5F81;&#x503C;&#x4E3A;<img src="https://latex.codecogs.com/gif.latex?%5Clambda" alt="formula">&#xFF0C;<img src="https://latex.codecogs.com/gif.latex?%5Cphi" alt="formula"> &#x4E3A;&#x5176;&#x7279;&#x5F81;&#x5411;&#x91CF;&#xFF0C;&#x957F;&#x5EA6;&#x4E3A;1&#xFF0C;&#x4E14; <img src="https://latex.codecogs.com/gif.latex?%5Cphi%5ET%5Cphi%3D1" alt="formula">
<img src="https://latex.codecogs.com/gif.latex?%0AX%5ETX%5Cphi%3D%5Clambda%5Cphi%5Capprox0%0A" alt="formula"></p>
<p>&#x5BB9;&#x6613;&#x5F97;&#x5230;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AX%5Cphi%5Capprox0%0A" alt="formula"></p>
<p>&#x5B9A;&#x4E49;Kappa&#x6761;&#x4EF6;&#x6570;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0Ak%28X%5ETX%29%3D%7C%7CX%5ETX%7C%7C%2A%7C%7C%28X%5ETX%29%5E%7B-1%7D%7C%7C%3D%5Cfrac%7B%5Clambda_%7Bmax%7D%7BX%5ETX%7D%7D%7B%5Clambda_%7Bmin%7D%7BX%5ETX%7D%7D%0A" alt="formula"></p>
<p>&#x76F4;&#x89C2;&#x4E0A;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5982;&#x679C;&#x6BD4;&#x503C;&#x8F83;&#x9AD8;&#x5219;&#x5171;&#x7EBF;&#x6027;&#x7A0B;&#x5EA6;&#x5F88;&#x5927;</p>
<pre><code class="lang-R">&gt; x&lt;-as.matrix(filboys2018[,<span class="hljs-number">1</span>:<span class="hljs-number">3</span>])
&gt; xx=crossprod(x)
&gt; kappa(xx)
</code></pre>
<pre><code>[1] 38838.06
</code></pre><p>&#x53EF;&#x89C1;&#x5171;&#x7EBF;&#x6027;&#x7A0B;&#x5EA6;&#x5927;</p>
<p><strong>VIF</strong></p>
<p>&#x5B9A;&#x4E49;<strong>&#x65B9;&#x5DEE;&#x81A8;&#x80C0;&#x56E0;&#x5B50;</strong> </p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AVIF%3D%5Cfrac%7B1%7D%7B1-R_j%5E2%7D%0A" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?R_j%5E2" alt="formula"> &#x8868;&#x793A;&#x89E3;&#x91CA;&#x53D8;&#x91CF;j&#x5BF9;&#x5176;&#x4ED6;&#x89E3;&#x91CA;&#x53D8;&#x91CF;&#x8FDB;&#x884C;&#x56DE;&#x5F52;&#x7684;&#x51B3;&#x5B9A;&#x7CFB;&#x6570;&#xFF0C;&#x5F53;VIF&#x6BD4;&#x8F83;&#x5927;&#x7684;&#x65F6;&#x5019;&#x5219;&#x5B58;&#x5728;&#x5171;&#x7EBF;&#x6027;</p>
<pre><code class="lang-R">&gt; vif(lm.sol)
</code></pre>
<pre><code>   armSpan footLength  legLength 
  1.664246   1.287671   1.376563
</code></pre><p>&#x5171;&#x7EBF;&#x6027;&#x7A0B;&#x5EA6;&#x4E00;&#x822C;</p>
<h3 id="&#x5CAD;&#x56DE;&#x5F52;&#x4E0E;lasso&#x56DE;&#x5F52;">&#x5CAD;&#x56DE;&#x5F52;&#x4E0E;Lasso&#x56DE;&#x5F52;</h3>
<p><code>&#x8FD9;&#x662F;&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x591A;&#x91CD;&#x5171;&#x7EBF;&#x6027;&#x800C;&#x51FA;&#x73B0;&#x7684;</code></p>
<p>&#x7531;&#x4E8E;&#x5171;&#x7EBF;&#x6027;&#x4F1A;&#x8BA9; <img src="https://latex.codecogs.com/gif.latex?%5Cbeta" alt="formula"> &#x4F30;&#x8BA1;&#x503C;&#x53D8;&#x5927;&#xFF0C;&#x8FD9;&#x91CC;&#x5F15;&#x5165;&#x60E9;&#x7F5A;&#x9879;&#xFF0C;&#x5BF9;&#x4E8E;&#x5CAD;&#x56DE;&#x5F52;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Chat%7B%5Cbeta%7D_%7Bridge%7D%3Darg%5Cmin%5Climits_%7B%5Cbeta%7D%5C%7B%5Csum%28y_i-%5Cbeta_0-%5Csum%5Cbeta_j%20x_%7Bij%7D%29%5E2%2B%5Clambda%5Csum%5Cbeta_j%5E2%5C%7D%0A" alt="formula">
&#x6216;&#x8005;
<img src="https://latex.codecogs.com/gif.latex?%0A%5Chat%7B%5Cbeta%7D_%7Bridge%7D%3Darg%5Cmin%5Climits_%7B%5Cbeta%7D%5Csum%28y_i-%5Cbeta_0-%5Csum%5Cbeta_j%20x_%7Bij%7D%29%5E2%0A" alt="formula">
<img src="https://latex.codecogs.com/gif.latex?%0Asubject%20%5Cquad%20to%20%5Cquad%20%5Csum%5Cbeta_j%5E2%5Cle%20t%5E2%0A" alt="formula"></p>
<pre><code class="lang-R">&gt; lm.soridge&lt;-lm.ridge(height ~ armSpan + footLength + legLength, data = filboys2018)
&gt; summary(lm.soridge)
</code></pre>
<pre><code>       Length Class  Mode   
coef   3      -none- numeric
scales 3      -none- numeric
Inter  1      -none- numeric
lambda 1      -none- numeric
ym     1      -none- numeric
xm     3      -none- numeric
GCV    1      -none- numeric
kHKB   1      -none- numeric
kLW    1      -none- numeric
</code></pre><p>&#x753B;&#x51FA;&#x5CAD;&#x8FF9;&#x56FE;</p>
<pre><code class="lang-R">&gt; plot(lm.ridge(height ~ .,data = filboys2018[,<span class="hljs-number">1</span>:<span class="hljs-number">4</span>],lambda=seq(<span class="hljs-number">0</span>,<span class="hljs-number">100</span>,<span class="hljs-number">10</span>)))
</code></pre>
<p><img src="img/ridge.png" alt="ridge"></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x53D8;&#x91CF;&#x968F;&#x7CFB;&#x6570;&#x7684;&#x53D8;&#x5316;&#xFF0C;&#x4E24;&#x4E2A;&#x53D8;&#x91CF;&#x8868;&#x73B0;&#x6BD4;&#x8F83;&#x5E73;&#x7A33;&#xFF0C;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x8FC5;&#x901F;&#x8D8B;&#x4E8E;&#x5E73;&#x7A33;&#xFF0C;&#x5728;&#x56FE;&#x4E2D;&#x5171;&#x7EBF;&#x6027;&#x60C5;&#x51B5;&#x4E00;&#x822C;</p>
<p>&#x5BF9;&#x4E8E;Lasso&#x56DE;&#x5F52;
<img src="https://latex.codecogs.com/gif.latex?%0A%5Chat%7B%5Cbeta%7D_%7Bridge%7D%3Darg%5Cmin%5Climits_%7B%5Cbeta%7D%5C%7B%5Csum%28y_i-%5Cbeta_0-%5Csum%5Cbeta_j%20x_%7Bij%7D%29%5E2%2B%5Clambda%5Csum%7C%5Cbeta_j%7C%5C%7D%0A" alt="formula">
&#x6216;&#x8005;
<img src="https://latex.codecogs.com/gif.latex?%0A%5Chat%7B%5Cbeta%7D_%7Bridge%7D%3Darg%5Cmin%5Climits_%7B%5Cbeta%7D%5Csum%28y_i-%5Cbeta_0-%5Csum%5Cbeta_j%20x_%7Bij%7D%29%5E2%0A" alt="formula">
<img src="https://latex.codecogs.com/gif.latex?%0Asubject%20%5Cquad%20to%20%5Cquad%20%5Csum%7C%5Cbeta_j%7C%5Cle%20t%5E2%0A" alt="formula"></p>
<pre><code>&gt; boysMatrix&lt;- as.matrix(filboys2018)
&gt; laa&lt;-lars(x=boysMatrix[,2:4],y=boysMatrix[,1])
&gt; laa
</code></pre><pre><code>
Call:
lars(x = boysMatrix[, 2:4], y = boysMatrix[, 1])
R-squared: 0.568 
Sequence of LASSO moves:
     armSpan footLength legLength
Var        1          2         3
Step       1          2         3
</code></pre><pre><code class="lang-R">&gt; summary(laa)
</code></pre>
<pre><code>LARS/LASSO
Call: lars(x = boysMatrix[, 2:4], y = boysMatrix[, 1])
  Df     Rss      Cp
0  1 2155.33 87.3268
1  2 1143.14 15.4428
2  3  984.10  5.8337
3  4  931.58  4.0000
</code></pre><p>Cp&#x662F;&#x5BF9;&#x5171;&#x7EBF;&#x6027;&#x7684;&#x8BCA;&#x65AD;&#xFF0C;&#x8FD9;&#x8FB9;&#x663E;&#x793A;&#x5171;&#x7EBF;&#x6027;&#x8F83;&#x5C0F;&#xFF0C;&#x753B;&#x51FA;Lasso&#x56FE;</p>
<p><img src="img/lasso.png" alt="lasso"></p>
<h3 id="&#x591A;&#x9879;&#x5F0F;&#x56DE;&#x5F52;">&#x591A;&#x9879;&#x5F0F;&#x56DE;&#x5F52;</h3>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x53EA;&#x8BA8;&#x8BBA;&#x4E00;&#x5143;&#x591A;&#x9879;&#x56DE;&#x5F52;&#xFF0C;&#x53D6;2018&#x5E74;&#x7537;&#x751F;&#x8EAB;&#x9AD8;&#x548C;&#x817F;&#x957F;&#x6570;&#x636E;</p>
</blockquote>
<p><img src="img/height_legLength.png" alt="height_legLength"></p>
<p>&#x6211;&#x4EEC;&#x505A;2&#x6B21;&#x591A;&#x9879;&#x5F0F;&#x7684;&#x56DE;&#x5F52;&#x6709;</p>
<pre><code class="lang-R">&gt; lm.sol&lt;-lm(filboys2018$height~<span class="hljs-number">1</span>+filboys2018$legLength+I(filboys2018$legLength^<span class="hljs-number">2</span>),data=filboys2018)
&gt; summary(lm.sol)
</code></pre>
<pre><code>Call:
lm(formula = filboys2018$height ~ 1 + filboys2018$legLength + 
    I(filboys2018$legLength^2), data = filboys2018)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.6482 -3.2001 -0.6611  3.6058 10.9484 

Coefficients:
                             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                411.398736  96.067660   4.282 5.86e-05 ***
filboys2018$legLength       -5.113082   1.929518  -2.650  0.00997 ** 
I(filboys2018$legLength^2)   0.027523   0.009668   2.847  0.00581 ** 
---
Signif. codes:  0 &#x2018;***&#x2019; 0.001 &#x2018;**&#x2019; 0.01 &#x2018;*&#x2019; 0.05 &#x2018;.&#x2019; 0.1 &#x2018; &#x2019; 1

Residual standard error: 4.744 on 69 degrees of freedom
Multiple R-squared:  0.2795,    Adjusted R-squared:  0.2586 
F-statistic: 13.38 on 2 and 69 DF,  p-value: 1.227e-05
</code></pre><pre><code class="lang-R">&gt; xfit&lt;-seq(<span class="hljs-number">85</span>,<span class="hljs-number">120</span>,len=<span class="hljs-number">72</span>)
&gt; yfit&lt;-predict(lm.sol, data.frame(x=xfit))
&gt; lines(xfit, yfit)
</code></pre>
<p><img src="img/wocao.png" alt="wocao"></p>
<p>&#x5B9E;&#x9645;&#x6548;&#x679C;&#x5E76;&#x4E0D;&#x7406;&#x60F3;</p>
<h3 id="&#x5E7F;&#x4E49;&#x7EBF;&#x6027;&#x56DE;&#x5F52;">&#x5E7F;&#x4E49;&#x7EBF;&#x6027;&#x56DE;&#x5F52;</h3>
<p>&#x4E00;&#x822C;&#x5173;&#x7CFB;&#x6709;</p>
<table>
<thead>
<tr>
<th></th>
<th>&#x8FDE;&#x63A5;&#x51FD;&#x6570;</th>
<th>&#x9006;&#x8FDE;&#x63A5;&#x51FD;&#x6570;&#xFF08;&#x56DE;&#x5F52;&#xFF09;</th>
<th>&#x5178;&#x578B;&#x8BEF;&#x5DEE;&#x51FD;&#x6570;</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x6052;&#x7B49;</td>
<td><img src="https://latex.codecogs.com/gif.latex?X%5ET%5Cbeta%3DE%28Y%29" alt="formula"></td>
<td><img src="https://latex.codecogs.com/gif.latex?E%28Y%29%3DX%5ET%5Cbeta" alt="formula"></td>
<td>&#x6B63;&#x6001;</td>
</tr>
<tr>
<td>&#x5BF9;&#x6570;</td>
<td><img src="https://latex.codecogs.com/gif.latex?X%5ET%5Cbeta%3DlnE%28Y%29" alt="formula"></td>
<td><img src="https://latex.codecogs.com/gif.latex?E%28Y%29%3Dexp%28X%5ET%5Cbeta%29" alt="formula"></td>
<td>Poisson</td>
</tr>
<tr>
<td>Logit</td>
<td><img src="https://latex.codecogs.com/gif.latex?X%5ET%5Cbeta%3DlogitE%28Y%29" alt="formula"></td>
<td><img src="https://latex.codecogs.com/gif.latex?E%28Y%29%3D%5Cfrac%7Bexp%28X%5ET%5Cbeta%29%7D%7B1%2Bexp%28X%5ET%5Cbeta%29%7D" alt="formula"></td>
<td>&#x4E8C;&#x9879;</td>
</tr>
<tr>
<td>&#x9006;</td>
<td><img src="https://latex.codecogs.com/gif.latex?X%5ET%5Cbeta%3DE%28Y%29%5E%7B-1%7D" alt="formula"></td>
<td><img src="https://latex.codecogs.com/gif.latex?E%28Y%29%3D%28X%5ET%5Cbeta%29%5E%7B-1%7D" alt="formula"></td>
<td>Gamma</td>
</tr>
</tbody>
</table>
<p>&#x8FD9;&#x91CC;&#x53EA;&#x4ECB;&#x7ECD;&#x903B;&#x8F91;&#x56DE;&#x5F52;</p>
<h4 id="&#x903B;&#x8F91;&#x56DE;&#x5F52;">&#x903B;&#x8F91;&#x56DE;&#x5F52;</h4>
<p>&#x5BF9;&#x4E8E;&#x4E8C;&#x5206;&#x7C7B;&#x53D8;&#x91CF;&#x6982;&#x7387; <img src="https://latex.codecogs.com/gif.latex?P%3DP%5C%7BY%3D1%7CX_1%2CX_2%2C...%2CX_p%5C%7D" alt="formula"> &#x6709;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AP%3D%5Cfrac%7Bexp%28%5Cbeta_0%2B%5Cbeta_1X_1%2B...%2B%5Cbeta_pX_p%29%7D%7B1%2Bexp%28%5Cbeta_0%2B%5Cbeta_1X_1%2B...%2B%5Cbeta_pX_p%29%7D%0A" alt="formula"></p>
<p>&#x505A;logit&#x53D8;&#x6362;&#x6709;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0Alogit%28P%29%3Dln%28%5Cfrac%7BP%7D%7B1-P%7D%29%3D%5Cbeta_0%2B%5Cbeta_1X_1%2B...%2B%5Cbeta_pX_p%0A" alt="formula"></p>
<p>&#x6211;&#x4EEC;&#x5C06;2018&#x5E74;&#x7537;&#x5973;&#x4F5C;&#x4E3A;&#x5206;&#x7C7B;&#x53D8;&#x91CF;&#xFF0C;&#x8D4B;&#x4E88;&#x7537;&#x4E3A;1&#xFF0C;&#x5973;&#x4E3A;0&#xFF08;&#x4E5F;&#x53EF;&#x4EE5;&#x7537;&#x4E3A;0&#xFF0C;&#x5973;&#x4E3A;1&#xFF09;&#xFF0C;&#x8FDE;&#x63A5;&#x6570;&#x636E;&#x5F97;&#x5230; <code>classFil2018</code> &#x6570;&#x636E;&#xFF0C;&#x65B0;&#x589E;&#x7684;&#x5206;&#x7C7B;&#x6570;&#x636E;&#x540D;&#x4E3A; <code>c</code></p>
<p>&#x9996;&#x5148;&#x5229;&#x7528;&#x8EAB;&#x9AD8;&#x8FDB;&#x884C;&#x4E00;&#x5143;&#x903B;&#x8F91;&#x56DE;&#x5F52;</p>
<pre><code>&gt; glm.sol&lt;-glm(c~height, family=binomial, data=classFil2018)
&gt; summary(glm.sol)
</code></pre><pre><code>Call:
glm(formula = c ~ height, family = binomial, data = classFil2018)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.6189  -0.3614   0.0810   0.4034   1.9376  

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -78.78965   15.20016  -5.183 2.18e-07 ***
height        0.46433    0.08953   5.186 2.15e-07 ***
---
Signif. codes:  0 &#x2018;***&#x2019; 0.001 &#x2018;**&#x2019; 0.01 &#x2018;*&#x2019; 0.05 &#x2018;.&#x2019; 0.1 &#x2018; &#x2019; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 157.807  on 117  degrees of freedom
Residual deviance:  70.022  on 116  degrees of freedom
AIC: 74.022

Number of Fisher Scoring iterations: 6
</code></pre><p>&#x53EF;&#x89C1;&#x6709;&#x5F3A;&#x663E;&#x8457;&#x6027;&#xFF0C;&#x753B;&#x51FA;&#x76F8;&#x5E94;&#x7684;&#x56FE;</p>
<p><img src="img/logistic.png" alt="logistic"></p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x8FDB;&#x884C;&#x591A;&#x5143;&#x7684;&#x5206;&#x6790;&#xFF0C;&#x6211;&#x4EEC;&#x8F93;&#x5165;&#x6240;&#x6709;&#x7684;&#x5143;&#x7D20;</p>
<pre><code class="lang-R">&gt; glm.sol&lt;-glm(c~height+armSpan+footLength+legLength+weight, family=binomial, data=classFil2018)
&gt; summary(glm.sol)
</code></pre>
<pre><code>
Call:
glm(formula = c ~ height + armSpan + footLength + legLength + 
    weight, family = binomial, data = classFil2018)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.98396  -0.26262   0.02957   0.23785   2.10860  

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -74.94164   17.48016  -4.287 1.81e-05 ***
height        0.30241    0.13547   2.232   0.0256 *  
armSpan       0.13348    0.10685   1.249   0.2116    
footLength    0.93599    0.46622   2.008   0.0447 *  
legLength    -0.25732    0.10514  -2.447   0.0144 *  
weight        0.06362    0.06289   1.012   0.3117    
---
Signif. codes:  0 &#x2018;***&#x2019; 0.001 &#x2018;**&#x2019; 0.01 &#x2018;*&#x2019; 0.05 &#x2018;.&#x2019; 0.1 &#x2018; &#x2019; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 157.807  on 117  degrees of freedom
Residual deviance:  45.815  on 112  degrees of freedom
AIC: 57.815

Number of Fisher Scoring iterations: 7
</code></pre><p>&#x5B58;&#x5728;&#x4E0D;&#x663E;&#x8457;&#x7684;&#x53D8;&#x91CF;</p>
<pre><code>&gt; glm.new&lt;-step(glm.sol)
&gt; summary(glm.new)
</code></pre><pre><code>Start:  AIC=57.81
c ~ height + armSpan + footLength + legLength + weight

             Df Deviance    AIC
- weight      1   46.980 56.980
- armSpan     1   47.489 57.489
&lt;none&gt;            45.815 57.815
- footLength  1   50.297 60.297
- height      1   51.890 61.890
- legLength   1   53.449 63.449

Step:  AIC=56.98
c ~ height + armSpan + footLength + legLength

             Df Deviance    AIC
- armSpan     1   48.814 56.814
&lt;none&gt;            46.980 56.980
- footLength  1   54.529 62.529
- legLength   1   54.783 62.783
- height      1   56.670 64.670

Step:  AIC=56.81
c ~ height + footLength + legLength

             Df Deviance    AIC
&lt;none&gt;            48.814 56.814
- legLength   1   55.030 61.030
- footLength  1   60.642 66.642
- height      1   75.722 81.722



Call:
glm(formula = c ~ height + footLength + legLength, family = binomial, 
    data = classFil2018)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.91929  -0.24236   0.03492   0.18853   2.22940  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -82.5004    16.8164  -4.906  9.3e-07 ***
height        0.4328     0.1131   3.827  0.00013 ***
footLength    1.2795     0.4220   3.032  0.00243 ** 
legLength    -0.2244     0.1010  -2.222  0.02629 *  
---
Signif. codes:  0 &#x2018;***&#x2019; 0.001 &#x2018;**&#x2019; 0.01 &#x2018;*&#x2019; 0.05 &#x2018;.&#x2019; 0.1 &#x2018; &#x2019; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 157.807  on 117  degrees of freedom
Residual deviance:  48.814  on 114  degrees of freedom
AIC: 56.814

Number of Fisher Scoring iterations: 7
</code></pre><p>&#x8FDB;&#x4E00;&#x6B65;&#x63D0;&#x9AD8;&#x56DE;&#x5F52;&#x6548;&#x679C;</p>
<h4 id="&#x903B;&#x8F91;&#x56DE;&#x5F52;&#x8BCA;&#x65AD;">&#x903B;&#x8F91;&#x56DE;&#x5F52;&#x8BCA;&#x65AD;</h4>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x9996;&#x5148;&#x4F7F;&#x7528;&#x7EBF;&#x6027;&#x56DE;&#x5F52;&#x4E2D;&#x7684;&#x8BCA;&#x65AD;</p>
<pre><code class="lang-R">&gt; influence.measures(glm.new)
</code></pre>
<pre><code>Influence measures of
     glm(formula = c ~ height + footLength + legLength, family = binomial,      data = classFil2018) :

       dfb.1_  dfb.hght  dfb.ftLn  dfb.lgLn     dffit cov.r   cook.d      hat
1   -3.04e-02  1.77e-02  1.66e-02  3.03e-04  3.48e-02 1.048 6.58e-05 1.43e-02
2   -3.50e-02  3.76e-02  6.48e-02 -7.80e-02  1.04e-01 1.066 6.02e-04 3.75e-02
3   -2.05e-02  1.63e-02  2.29e-02 -1.98e-02  3.31e-02 1.047 5.98e-05 1.38e-02
4   -7.21e-03  3.68e-03  5.88e-03 -9.37e-04  8.46e-03 1.040 3.87e-06 4.74e-03
5   -1.36e-02  8.99e-03  3.51e-02 -3.00e-02  4.44e-02 1.060 1.07e-04 2.50e-02
6   -1.19e-02  4.21e-03  2.69e-02 -1.53e-02  3.02e-02 1.052 4.94e-05 1.74e-02
7   -1.12e-01  3.55e-02  6.35e-02  5.70e-02  1.67e-01 1.065 1.59e-03 4.64e-02
8   -4.36e-03  3.84e-03  1.39e-03 -1.43e-03  4.67e-03 1.039 1.18e-06 2.85e-03
9   -5.56e-02  1.60e-01 -6.95e-02 -1.39e-01  1.93e-01 1.160 2.05e-03 1.16e-01
10  -6.12e-02 -1.92e-01  2.89e-01  1.83e-01  4.72e-01 1.050 1.48e-02 8.89e-02
11  -4.87e-04  3.83e-04  1.87e-04 -1.08e-04  5.01e-04 1.036 1.36e-08 4.20e-04
12  -4.34e-02  6.62e-02  4.50e-02 -9.79e-02  1.18e-01 1.065 7.79e-04 3.92e-02
13  -1.24e-02  1.33e-02  5.44e-03 -1.00e-02  1.61e-02 1.043 1.40e-05 7.78e-03
14  -4.56e-05  3.91e-05  3.15e-05 -3.06e-05  5.40e-05 1.036 1.57e-10 5.56e-05
15  -8.84e-03  7.97e-03  5.52e-03 -6.00e-03  1.09e-02 1.041 6.44e-06 5.46e-03
16  -1.44e-05  1.64e-05  1.51e-05 -2.25e-05  2.65e-05 1.036 3.80e-11 3.63e-05
17  -6.18e-02  3.67e-02  9.14e-03  2.46e-02  7.71e-02 1.067 3.26e-04 3.46e-02
18   4.69e-01 -4.00e-01 -1.18e-01  1.17e-01  6.26e-01 0.743 6.46e-02 3.47e-02
19  -2.61e-03  9.74e-04  2.33e-03  1.30e-04  3.18e-03 1.038 5.47e-07 2.34e-03
20  -1.41e-01  2.34e-01 -1.31e-01 -7.15e-02  3.15e-01 1.071 5.99e-03 7.43e-02
21  -5.60e-02  1.55e-02  7.50e-02 -1.12e-02  9.50e-02 1.056 5.01e-04 2.97e-02
22  -2.90e-03  1.75e-03  1.31e-03  1.98e-04  3.10e-03 1.038 5.18e-07 2.23e-03
23  -6.65e-04  4.56e-04  4.11e-04 -1.76e-04  7.11e-04 1.036 2.73e-08 5.53e-04
24  -9.98e-03  1.50e-02  3.02e-02 -4.24e-02  4.99e-02 1.068 1.35e-04 3.26e-02
25  -1.90e-03  7.94e-04  1.45e-03  1.89e-04  2.21e-03 1.038 2.65e-07 1.72e-03
26  -2.34e-02  3.14e-02 -3.11e-03 -1.73e-02  3.32e-02 1.052 5.99e-05 1.73e-02
27  -1.89e-03  1.25e-03  8.82e-04 -1.31e-04  1.98e-03 1.037 2.11e-07 1.42e-03
28  -1.11e-01  2.71e-01 -1.62e-01 -1.63e-01  3.22e-01 1.197 5.86e-03 1.52e-01
29  -2.60e-01  9.86e-02 -5.66e-02  3.09e-01  4.81e-01 1.219 1.36e-02 1.81e-01
30  -3.09e-04  4.66e-04  2.37e-04 -6.13e-04  6.63e-04 1.037 2.37e-08 7.37e-04
31  -1.45e-03  2.20e-03  3.45e-04 -2.11e-03  2.51e-03 1.038 3.41e-07 2.24e-03
32  -2.44e-04  2.94e-04  8.83e-05 -2.43e-04  3.30e-04 1.036 5.88e-09 3.20e-04
33  -1.39e-02 -2.77e-01  4.64e-01  8.76e-02  5.83e-01 1.128 2.18e-02 1.44e-01
34  -7.75e-03  6.95e-03  4.22e-03 -4.56e-03  9.12e-03 1.040 4.49e-06 4.70e-03
35  -9.37e-03  1.32e-02  2.64e-03 -1.20e-02  1.52e-02 1.044 1.26e-05 9.04e-03
36   2.52e-03  6.19e-02  1.64e-01 -2.84e-01  3.51e-01 1.122 7.27e-03 1.09e-01
37  -1.23e-02  1.05e-02  8.69e-03 -8.28e-03  1.56e-02 1.042 1.31e-05 7.19e-03
38  -4.43e-02  2.00e-02  4.85e-02 -1.28e-02  6.50e-02 1.052 2.33e-04 2.16e-02
39  -2.25e-02  9.94e-03  2.18e-02 -3.38e-03  2.93e-02 1.047 4.66e-05 1.27e-02
40  -5.19e-04  4.87e-04  3.86e-04 -4.54e-04  6.80e-04 1.036 2.50e-08 5.53e-04
41  -3.59e-02  1.85e-02  1.32e-02  1.14e-02  4.27e-02 1.054 9.93e-05 2.06e-02
42  -6.24e-03  3.54e-03  6.38e-03 -2.80e-03  8.15e-03 1.040 3.59e-06 4.54e-03
43  -2.07e-02  1.52e-02  1.65e-02 -1.11e-02  2.63e-02 1.045 3.77e-05 1.06e-02
44  -8.41e-04  8.13e-04  4.25e-04 -5.77e-04  9.90e-04 1.037 5.30e-08 7.49e-04
45  -5.10e-03  5.01e-03  2.90e-03 -3.96e-03  6.41e-03 1.039 2.22e-06 3.65e-03
46  -1.75e-04  1.21e-04  1.07e-04 -4.84e-05  1.86e-04 1.036 1.86e-09 1.68e-04
47   1.38e-01  5.20e-01 -6.61e-01 -5.31e-01  1.05e+00 1.044 9.23e-02 1.73e-01
48  -1.80e-02  1.16e-02  5.17e-03  2.75e-03  2.00e-02 1.046 2.16e-05 1.09e-02
49  -2.68e-03  1.03e-03  4.08e-03 -1.63e-03  4.47e-03 1.039 1.08e-06 3.25e-03
50  -1.58e-01  1.29e-02  8.19e-02  1.60e-01  2.86e-01 1.094 4.80e-03 8.29e-02
51  -1.50e-02  2.78e-02  1.28e-02 -4.08e-02  4.38e-02 1.060 1.04e-04 2.56e-02
52   1.06e-01 -2.29e-01  2.66e-01  1.87e-03  5.01e-01 0.978 1.90e-02 6.54e-02
53  -1.87e-03  1.38e-03  1.31e-03 -8.40e-04  2.12e-03 1.037 2.43e-07 1.40e-03
54  -4.51e-02  3.58e-02  3.02e-02 -2.29e-02  5.92e-02 1.048 1.93e-04 1.83e-02
55   3.69e-01 -8.72e-02 -6.29e-01  2.10e-01  7.55e-01 0.693 1.20e-01 4.13e-02
56  -3.72e-04  3.49e-04  1.16e-04 -1.62e-04  3.99e-04 1.036 8.61e-09 3.45e-04
57  -2.06e-02 -2.02e-01  4.05e-01  1.36e-02  4.89e-01 1.122 1.49e-02 1.28e-01
58  -3.04e-02  1.77e-02  1.66e-02  3.03e-04  3.48e-02 1.048 6.58e-05 1.43e-02
59   2.56e-01 -8.36e-02 -7.44e-01  5.07e-01  9.22e-01 0.696 1.81e-01 5.84e-02
60   8.43e-02 -1.60e-01  2.61e-01 -8.88e-02  4.67e-01 0.999 1.57e-02 6.72e-02
61  -4.99e-02  2.05e-02  4.48e-02 -6.91e-04  6.73e-02 1.053 2.49e-04 2.27e-02
62  -1.25e-01  2.19e-01 -1.03e-01 -1.01e-01  2.77e-01 1.076 4.54e-03 7.09e-02
63  -7.10e-02  7.48e-02  4.73e-02 -6.97e-02  1.27e-01 1.048 9.17e-04 2.96e-02
64  -2.75e-02  1.53e-02  7.10e-03  9.63e-03  3.25e-02 1.053 5.74e-05 1.81e-02
65  -1.41e-02  1.85e-02  3.42e-03 -1.51e-02  2.10e-02 1.046 2.39e-05 1.09e-02
66  -1.96e-01  2.55e-01 -2.01e-01  5.26e-02  4.21e-01 1.090 1.10e-02 1.01e-01
67  -1.75e-03  1.35e-03  1.37e-03 -1.03e-03  2.11e-03 1.037 2.41e-07 1.41e-03
68  -4.59e-02 -1.97e-03  8.67e-02 -6.93e-03  9.76e-02 1.067 5.26e-04 3.77e-02
69  -4.48e-02  1.30e-04  1.33e-01 -5.85e-02  1.55e-01 1.075 1.35e-03 5.11e-02
70  -1.87e-02  1.49e-02  1.77e-02 -1.50e-02  2.70e-02 1.045 3.95e-05 1.13e-02
71  -8.00e-04  6.26e-04  3.99e-04 -2.63e-04  8.45e-04 1.036 3.86e-08 6.39e-04
72  -6.57e-03  9.46e-03  1.23e-02 -1.95e-02  2.20e-02 1.051 2.63e-05 1.56e-02
73   3.15e-01 -1.92e-01 -1.77e-01  6.37e-03 -5.48e-01 0.797 3.92e-02 3.35e-02
74   4.26e-02  1.01e-01 -2.41e-01 -3.23e-02 -4.85e-01 0.913 2.07e-02 4.52e-02
75   5.68e-01 -5.04e-01  2.24e-01 -2.29e-01 -9.07e-01 0.797 1.17e-01 7.56e-02
76   4.71e-01 -3.16e-01  2.43e-01 -4.47e-01 -9.34e-01 0.903 9.21e-02 1.07e-01
77  -4.08e-02  8.22e-02  2.11e-03 -1.03e-01 -3.37e-01 0.974 8.12e-03 3.82e-02
78  -5.16e-02  1.31e-01  2.74e-02 -1.96e-01 -2.14e-01 1.108 2.59e-03 8.22e-02
79  -1.10e-01 -2.28e-01 -2.52e-01  8.56e-01 -1.02e+00 0.933 1.06e-01 1.29e-01
80  -9.84e-02  1.08e-01  4.08e-02 -9.28e-02 -2.65e-01 1.011 4.51e-03 3.77e-02
81   1.22e-01 -4.52e-01  1.94e-01  4.43e-01 -7.15e-01 0.893 5.14e-02 7.30e-02
82  -7.66e-02  9.46e-02  7.63e-02 -1.35e-01 -1.91e-01 1.056 2.13e-03 4.51e-02
83  -7.66e-02  9.46e-02  7.63e-02 -1.35e-01 -1.91e-01 1.056 2.13e-03 4.51e-02
84  -8.25e-02  9.42e-02  5.52e-02 -1.02e-01 -1.58e-01 1.053 1.43e-03 3.79e-02
85  -1.07e-01  9.30e-02  6.47e-02 -7.00e-02 -1.86e-01 1.038 2.05e-03 3.49e-02
86  -8.25e-02  9.42e-02  5.52e-02 -1.02e-01 -1.58e-01 1.053 1.43e-03 3.79e-02
87  -1.30e-01  9.52e-02  4.59e-02 -1.68e-02 -1.93e-01 1.039 2.20e-03 3.67e-02
88  -1.34e-01  9.99e-02  2.86e-02 -1.42e-03 -1.82e-01 1.048 1.93e-03 3.94e-02
89  -3.77e-02  4.33e-02  5.72e-03 -2.64e-02 -4.88e-02 1.053 1.30e-04 1.99e-02
90  -4.59e-02  5.02e-02  5.85e-03 -2.61e-02 -5.74e-02 1.054 1.81e-04 2.20e-02
91  -1.74e-01  1.09e-01 -1.39e-02  9.34e-02 -2.46e-01 1.096 3.50e-03 7.85e-02
92  -2.49e-02  2.49e-02 -1.69e-03 -4.74e-03 -2.89e-02 1.051 4.54e-05 1.58e-02
93  -7.21e-02  5.47e-02  3.25e-02 -1.91e-02 -8.63e-02 1.052 4.14e-04 2.51e-02
94  -5.82e-02  4.99e-02  8.22e-02 -8.47e-02 -1.30e-01 1.062 9.47e-04 3.86e-02
95  -6.41e-02  4.87e-02  4.19e-02 -3.07e-02 -8.30e-02 1.051 3.82e-04 2.40e-02
96  -1.09e-01  5.20e-02  6.45e-02  1.31e-02 -1.44e-01 1.055 1.18e-03 3.68e-02
97  -1.04e-01  5.44e-02  4.76e-02  1.84e-02 -1.31e-01 1.059 9.63e-04 3.69e-02
98  -2.75e-02  2.73e-02  1.33e-02 -2.04e-02 -3.50e-02 1.048 6.68e-05 1.42e-02
99  -2.72e-02  2.59e-02  1.06e-02 -1.53e-02 -3.22e-02 1.047 5.64e-05 1.32e-02
100 -3.49e-02  2.75e-02  5.45e-03 -4.81e-04 -3.83e-02 1.051 7.98e-05 1.77e-02
101 -1.11e-02  9.61e-03  2.21e-04 -1.71e-04 -1.23e-02 1.044 8.14e-06 8.17e-03
102 -4.15e-02  3.49e-02  2.50e-02 -2.39e-02 -5.19e-02 1.049 1.47e-04 1.79e-02
103 -3.30e-02  2.48e-02  1.73e-02 -1.05e-02 -3.73e-02 1.047 7.58e-05 1.43e-02
104 -2.43e-02  1.93e-02  1.02e-02 -7.21e-03 -2.65e-02 1.046 3.82e-05 1.14e-02
105 -4.00e-02  2.51e-02  6.65e-02 -5.07e-02 -8.64e-02 1.062 4.12e-04 3.23e-02
106 -5.51e-02  2.47e-02  7.43e-02 -3.31e-02 -9.38e-02 1.057 4.88e-04 3.02e-02
107 -1.73e-01 -5.76e-03  1.14e-01  1.77e-01 -3.03e-01 1.130 5.29e-03 1.08e-01
108 -5.42e-02  2.69e-02  4.08e-02 -3.90e-03 -6.66e-02 1.053 2.44e-04 2.28e-02
109 -2.30e-02  1.73e-02  1.45e-02 -9.92e-03 -2.67e-02 1.045 3.86e-05 1.11e-02
110 -6.62e-02  2.84e-02  3.34e-02  2.08e-02 -8.08e-02 1.063 3.60e-04 3.20e-02
111 -2.02e-02  1.46e-02  8.49e-03 -3.24e-03 -2.16e-02 1.045 2.52e-05 1.00e-02
    inf
1      
2      
3      
4      
5      
6      
7      
8      
9     *
10     
11     
12     
13     
14     
15     
16     
17     
18    *
19     
20     
21     
22     
23     
24     
25     
26     
27     
28    *
29    *
30     
31     
32     
33    *
34     
35     
36    *
37     
38     
39     
40     
41     
42     
43     
44     
45     
46     
47    *
48     
49     
50     
51     
52     
53     
54     
55    *
56     
57    *
58     
59    *
60     
61     
62     
63     
64     
65     
66     
67     
68     
69     
70     
71     
72     
73    *
74     
75    *
76    *
77     
78    *
79    *
80     
81    *
82     
83     
84     
85     
86     
87     
88     
89     
90     
91     
92     
93     
94     
95     
96     
97     
98     
99     
100    
101    
102    
103    
104    
105    
106    
107   *
108    
109    
110    
111
</code></pre><p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x4E00;&#x4E9B;&#x5F02;&#x5E38;&#x503C;</p>
<p><strong>Wald&#x68C0;&#x9A8C;</strong></p>
<p>&#x7C7B;&#x4F3C;t&#x68C0;&#x9A8C;&#xFF0C;&#x4ED6;&#x5B9A;&#x4E49;Wald&#x7EDF;&#x8BA1;&#x91CF;&#x4E3A;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AW_j%3D%5Cfrac%7B%5Cbeta_j%5E2%7D%7BSE_%7B%5Cbeta_j%7D%5E2%7D%0A" alt="formula"></p>
<p>&#x5176;&#x4E2D; SE &#x8868;&#x793A;&#x7CFB;&#x6570;&#x6807;&#x51C6;&#x8BEF;&#x5DEE;&#xFF0C;&#x8FD9;&#x4E2A;&#x7EDF;&#x8BA1;&#x91CF;&#x7B26;&#x5408; <img src="https://latex.codecogs.com/gif.latex?%5Cchi%5E2" alt="formula"> &#x5206;&#x5E03;</p>
<pre><code>&gt; regTermTest(glm.new)
</code></pre><p><strong>&#x4E8C;&#x5143;&#x56FE;</strong></p>
<p>&#x5728;&#x591A;&#x5143;&#x903B;&#x8F91;&#x56DE;&#x5F52;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8F6C;&#x5316;&#x4E3A;&#x4E00;&#x5143;&#x56DE;&#x5F52;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E0A;&#x9762;&#x7684;&#x505A;&#x6CD5;&#xFF0C;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x5916;&#x90E8;&#x5206;&#x7BB1;&#x51FD;&#x6570;<code>actual_pred_plot</code></p>
<pre><code class="lang-R">&gt; glm.sol&lt;-glm(c~height, family=binomial, data=classFil2018)
&gt; pre&lt;-predict(glm.sol, data.frame(height = classFil2018$height))
&gt; tmp &lt;- classFil2018
&gt; tmp$pre &lt;- pre
&gt; actual_pred_plot  (var.by= as.character(<span class="hljs-string">&quot;height&quot;</span>),
+                    var.response=<span class="hljs-string">&apos;c&apos;</span>,
+                    data=tmp,
+                    var.predict.current=<span class="hljs-string">&apos;pre&apos;</span>,
+                    var.predict.reference=<span class="hljs-literal">NULL</span>,
+                    var.split=<span class="hljs-literal">NULL</span>,
+                    var.by.buckets=<span class="hljs-literal">NULL</span>,
+                    sort.factor=<span class="hljs-literal">FALSE</span>,
+                    errorbars=<span class="hljs-literal">FALSE</span>,
+                    subset.to=<span class="hljs-literal">FALSE</span>,
+                    barline.ratio=<span class="hljs-number">1</span>,
+                    title=<span class="hljs-string">&quot;Actual vs. Predicted&quot;</span>,
+                    make.plot=<span class="hljs-literal">TRUE</span>
+ )
</code></pre>
<p><img src="img/pred.png" alt="pred"></p>
<p>&#x53EF;&#x4EE5;&#x66F4;&#x6E05;&#x695A;&#x7684;&#x770B;&#x5230;&#x9884;&#x6D4B;&#x548C;&#x5B9E;&#x9645;&#x7684;&#x533A;&#x522B;</p>
<h2 id="&#x65B9;&#x5DEE;&#x5206;&#x6790;">&#x65B9;&#x5DEE;&#x5206;&#x6790;</h2>
<p><code>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x5229;&#x7528;&#x7537;&#x5973;&#x5206;&#x7C7B;&#x53D8;&#x91CF;&#x8FDB;&#x884C;&#x65B9;&#x5DEE;&#x5206;&#x6790;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x4ECE;&#x4E1A;&#x52A1;&#x89D2;&#x5EA6;&#x8FD9;&#x6837;&#x505A;&#x4E0D;&#x662F;&#x5F88;&#x5408;&#x9002;&#xFF0C;&#x8FD9;&#x91CC;&#x4E0D;&#x4F1A;&#x4F5C;&#x4E3A;&#x7279;&#x5F81;&#x5DE5;&#x7A0B;&#x7684;&#x4F9D;&#x636E;</code></p>
<h3 id="&#x5355;&#x56E0;&#x7D20;">&#x5355;&#x56E0;&#x7D20;</h3>
<p>&#x5B9A;&#x4E49;
<img src="https://latex.codecogs.com/gif.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Barray%7D%7Blr%7D%0Ax_%7Bij%7D%3D%5Cmu%2Ba_i%2B%5Cepsilon_%7Bij%7D%2Ci%3D1%2C2...%2Cr%2Cj%3D1%2C2...%2Cn_i%20%5C%5C%0A%5Cepsilon_%7Bij%7D%20%5Csim%20N%280%2C%5Csigma%5E2%29%20%5Cquad%20and%20%5Cquad%20independent%5C%5C%0A%5Csum%7Bn_ia_i%7D%20%3D0%0A%5Cend%7Barray%7D%0A%5Cright.%0A" alt="formula"></p>
<p>&#x7B49;&#x4EF7;&#x5047;&#x8BBE;</p>
<p><a href=""><img src="https://latex.codecogs.com/gif.latex?H_0%3A" alt="formula"> <img src="https://latex.codecogs.com/gif.latex?a_1%3Da_2%3D...%3Da_r" alt="formula"> </a> <img src="https://latex.codecogs.com/gif.latex?%5Cleftrightarrow" alt="formula"> <a href=""><img src="https://latex.codecogs.com/gif.latex?H_1%3A" alt="formula"> <img src="https://latex.codecogs.com/gif.latex?a_1%2Ca_2...%2Ca_r" alt="formula"> &#x4E0D;&#x5168;&#x4E3A;0 </a></p>
<p>&#x8003;&#x8651;&#x7EDF;&#x8BA1;&#x91CF; <img src="https://latex.codecogs.com/gif.latex?S_T%3D%5Csum%5Csum%28x_%7Bij%7D-%5Coverline%7Bx%7D%29%5E2" alt="formula">  &#x548C; <img src="https://latex.codecogs.com/gif.latex?S_E%3D%5Csum%5Csum%28x_%7Bij%7D-%5Coverline%7Bx_%7Bi.%7D%7D%29" alt="formula"> &#x548C; <img src="https://latex.codecogs.com/gif.latex?S_A%3D%5Csum%5Csum%28%5Coverline%7Bx_%7Bi.%7D%7D-%5Coverline%7Bx%7D%29" alt="formula"> </p>
<p>&#x6211;&#x4EEC;&#x6709;
<img src="https://latex.codecogs.com/gif.latex?%0AF%3D%5Cfrac%7BS_A/%28r-1%29%7D%7BS_E/%28n-r%29%7D%20%5Csim%20F%28r-1%2Cn-r%29%0A" alt="formula"></p>
<pre><code class="lang-R">&gt; fil2018&lt;-rbind(filboys2018,filgirls2018)
&gt; legLengthData&lt;-data.frame(
+     X=fil2018$legLength,
+     A=factor(c(rep(<span class="hljs-number">1</span>,<span class="hljs-number">72</span>),rep(<span class="hljs-number">2</span>,<span class="hljs-number">46</span>)))
+ )
&gt; legLengthData.aov&lt;-aov(X ~ A, data=legLengthData)
&gt; legLengthData.aov
</code></pre>
<p>&#x5F97;&#x5230;</p>
<pre><code>Call:
   aov(formula = X ~ A, data = legLengthData)

Terms:
                       A Residuals
Sum of Squares   163.007  3842.857
Deg. of Freedom        1       116

Residual standard error: 5.7557
Estimated effects may be unbalanced
</code></pre><h4 id="&#x591A;&#x91CD;&#x6BD4;&#x8F83;">&#x591A;&#x91CD;&#x6BD4;&#x8F83;</h4>
<p><code>&#x5B9E;&#x9645;&#x4E0A;&#x8FD9;&#x91CC;&#x5C31;&#x4E24;&#x4E2A;</code></p>
<p><strong>t&#x68C0;&#x9A8C;</strong></p>
<pre><code class="lang-R">&gt; pairwise.t.test(legLengthData$X, legLengthData$A, p.adjust.method = <span class="hljs-string">&quot;none&quot;</span>)
</code></pre>
<p>&#x5F97;&#x5230;</p>
<pre><code>    Pairwise comparisons using t tests with pooled SD 

data:  legLengthData$X and legLengthData$A 

  1    
2 0.028

P value adjustment method: none
</code></pre><p>&#x62D2;&#x7EDD;&#x539F;&#x5047;&#x8BBE;</p>
<h4 id="&#x65B9;&#x5DEE;&#x9F50;&#x6027;&#x68C0;&#x9A8C;">&#x65B9;&#x5DEE;&#x9F50;&#x6027;&#x68C0;&#x9A8C;</h4>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x662F;&#x68C0;&#x9A8C;&#x65B9;&#x5DEE;&#x662F;&#x5426;&#x76F8;&#x540C;</p>
</blockquote>
<pre><code class="lang-R">&gt; bartlett.test(legLengthData$X~legLengthData$A, data=legLengthData)
</code></pre>
<p>&#x5F97;&#x5230;</p>
<pre><code>    Bartlett test of homogeneity of variances

data:  legLengthData$X by legLengthData$A
Bartlett&apos;s K-squared = 8.1132, df = 1, p-value = 0.004394
</code></pre><p>&#x56E0;&#x800C;&#x65B9;&#x5DEE;&#x5E76;&#x4E0D;&#x4E00;&#x81F4;</p>
<h4 id="kruskal-wallis-&#x79E9;&#x548C;&#x68C0;&#x9A8C;">Kruskal-Wallis &#x79E9;&#x548C;&#x68C0;&#x9A8C;</h4>
<pre><code>&gt; kruskal.test(legLengthData$X,legLengthData$A)
</code></pre><pre><code>    Kruskal-Wallis rank sum test

data:  legLengthData$X and legLengthData$A
Kruskal-Wallis chi-squared = 5.6342, df = 1, p-value = 0.01761
</code></pre><p>&#x53EF;&#x89C1;&#x4F9D;&#x7136;&#x62D2;&#x7EDD;&#x524D;&#x9762;F&#x68C0;&#x9A8C;&#x7684;&#x5047;&#x8BBE;&#xFF08;&#x56E0;&#x4E3A;&#x5C31;&#x4E24;&#x4E2A;&#x53D8;&#x91CF;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x7528;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x800C;&#x5B9E;&#x9645;&#x4E0A;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x662F;<a href="">Wilcoxon&#x79E9;&#x68C0;&#x9A8C;</a>&#x7684;&#x5E7F;&#x4E49;&#x7248;&#x672C;&#xFF09;</p>
<h3 id="&#x53CC;&#x56E0;&#x7D20;">&#x53CC;&#x56E0;&#x7D20;</h3>
<p>&#x7531;&#x4E8E;&#x539F;&#x6570;&#x636E;&#x65E0;&#x6CD5;&#x751F;&#x6210;&#x591A;&#x4E2A;&#x7684;&#x5206;&#x7C7B;&#x53D8;&#x91CF;&#xFF0C;&#x6211;&#x4EEC;&#x65E0;&#x6CD5;&#x8FDB;&#x884C;&#x591A;&#x56E0;&#x7D20;&#x5206;&#x6790;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x4E00;&#x822C;&#x53CC;&#x56E0;&#x7D20;&#x4E00;&#x6837;&#x4F7F;&#x7528;<code>aov</code>&#x51FD;&#x6570;&#xFF0C;&#x8B6C;&#x5982;</p>
<pre><code class="lang-R">&gt; tree&lt;-data.frame(
    Y=c(<span class="hljs-number">23</span>, <span class="hljs-number">25</span>, <span class="hljs-number">21</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">20</span>, <span class="hljs-number">17</span>, <span class="hljs-number">11</span>, <span class="hljs-number">26</span>, <span class="hljs-number">21</span>,
        <span class="hljs-number">16</span>, <span class="hljs-number">19</span>, <span class="hljs-number">13</span>, <span class="hljs-number">16</span>, <span class="hljs-number">24</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">18</span>, <span class="hljs-number">27</span>, <span class="hljs-number">24</span>,
        <span class="hljs-number">28</span>, <span class="hljs-number">30</span>, <span class="hljs-number">19</span>, <span class="hljs-number">17</span>, <span class="hljs-number">22</span>, <span class="hljs-number">26</span>, <span class="hljs-number">24</span>, <span class="hljs-number">21</span>, <span class="hljs-number">25</span>, <span class="hljs-number">26</span>,
        <span class="hljs-number">19</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>, <span class="hljs-number">20</span>, <span class="hljs-number">25</span>, <span class="hljs-number">26</span>, <span class="hljs-number">26</span>, <span class="hljs-number">28</span>, <span class="hljs-number">29</span>, <span class="hljs-number">23</span>,
        <span class="hljs-number">18</span>, <span class="hljs-number">15</span>, <span class="hljs-number">23</span>, <span class="hljs-number">18</span>, <span class="hljs-number">10</span>, <span class="hljs-number">21</span>, <span class="hljs-number">25</span>, <span class="hljs-number">12</span>, <span class="hljs-number">12</span>, <span class="hljs-number">22</span>,
        <span class="hljs-number">19</span>, <span class="hljs-number">23</span>, <span class="hljs-number">22</span>, <span class="hljs-number">14</span>, <span class="hljs-number">13</span>, <span class="hljs-number">22</span>, <span class="hljs-number">13</span>, <span class="hljs-number">12</span>, <span class="hljs-number">22</span>, <span class="hljs-number">19</span>),
    A=gl(<span class="hljs-number">3</span>,<span class="hljs-number">20</span>,<span class="hljs-number">60</span>),
    B=gl(<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">60</span>)
    )
&gt; tree.aov &lt;- aov(Y ~ A+B+A:B, data=tree)
</code></pre>
<p>&#x8FD9;&#x91CC;<code>gl</code>&#x51FD;&#x6570;&#x610F;&#x601D;&#x662F;&#x751F;&#x6210;&#x56E0;&#x7D20;&#xFF0C;&#x5176;&#x4E2D;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x56E0;&#x7D20;&#x4E2A;&#x6570;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x56E0;&#x6570;&#x5BF9;&#x5E94;&#x7684;&#x6C34;&#x5E73;&#x6570;&#x91CF;</p>
<p>&#x6709;&#x7ED3;&#x679C;</p>
<pre><code>Df Sum Sq Mean Sq F value Pr(&gt;F)
A 2 352.53 176.27 8.9589 0.000494 ***
B 3 87.52 29.17 1.4827 0.231077
A:B 6 71.73 11.96 0.6077 0.722890
Residuals 48 944.40 19.67
</code></pre><p>&#x5373;A&#x6709;&#x663E;&#x8457;&#x6027;</p>
<p><code>&#x6B64;&#x5916;&#x534F;&#x65B9;&#x5DEE;&#x5206;&#x6790;&#x5DF2;&#x5728;&#x524D;&#x9762;&#x7ED9;&#x51FA;</code></p>
<h2 id="&#x5224;&#x522B;&#x5206;&#x6790;">&#x5224;&#x522B;&#x5206;&#x6790;</h2>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x7684;&#x5224;&#x522B;&#x5206;&#x6790;&#x53EA;&#x4E3E;&#x4E8C;&#x5206;&#x7C7B;&#xFF0C;&#x7ED9;&#x51FA;&#x4E09;&#x4E2A;&#x7ECF;&#x5178;&#x7684;&#x5224;&#x522B;&#x5206;&#x6790;</p>
</blockquote>
<h3 id="&#x8DDD;&#x79BB;&#x5224;&#x522B;">&#x8DDD;&#x79BB;&#x5224;&#x522B;</h3>
<p>&#x8003;&#x8651;Mahalanobis Distance&#xFF0C;&#x73B0;&#x5728;&#x5047;&#x8BBE;&#x6709;&#x4E24;&#x4E2A;&#x534F;&#x65B9;&#x5DEE;&#x4E00;&#x81F4;&#x7684;&#x5206;&#x5E03;&#x4EE4;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0Aw%28x%29%3Dd%5E2%28x%2CX_2%29-d%5E2%28x%2CX_1%29%3D2%28x-%5Coverline%28%5Cmu%29%29%5ET%5CSigma%5E%7B-1%7D%28%5Cmu_1-%5Cmu_2%29%0A" alt="formula">
&#x5176;&#x4E2D; <img src="https://latex.codecogs.com/gif.latex?%5Cmu%3D%5Cfrac%7B%5Cmu_1%2B%5Cmu%2B2%7D%7B2%7D" alt="formula">&#xFF0C;&#x6211;&#x4EEC;&#x6709;&#x5224;&#x522B;&#x51FD;&#x6570;
<img src="https://latex.codecogs.com/gif.latex?%0AR1%3D%5C%7Bx%7Cw%28x%29%3E0%5C%7D%0A" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AR2%3D%5C%7Bx%7Cw%28x%29%3C0%5C%7D%0A" alt="formula"></p>
<p>&#x5B9E;&#x9645;&#x8BA1;&#x7B97;&#x4E2D;&#x6211;&#x4EEC;&#x7528;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Chat%7B%5Cmu_i%7D%3D%5Coverline%7BX_i%7D%0A" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Chat%7B%5CSigma%7D%3D%5Cfrac%7B1%7D%7Bn_1%2Bn_2-2%7D%28S_1%2BS_2%29%0A" alt="formula"></p>
<p>&#x5982;&#x679C;&#x65B9;&#x5DEE;&#x4E0D;&#x540C;&#xFF0C;&#x5219;w(x)&#x4F30;&#x8BA1;&#x76F4;&#x63A5;&#x5E26;&#x5165;&#x4E0D;&#x540C;&#x5206;&#x5E03;&#x7684;&#x79BB;&#x5DEE;&#x9635;&#x3002;&#x5176;&#x4E2D;
<img src="https://latex.codecogs.com/gif.latex?%0A%5Chat%7B%5CSigma_i%7D%3D%5Cfrac%7B1%7D%7Bn_i-1%7DS_i%0A" alt="formula"></p>
<pre><code class="lang-R">&gt; discriminiant.distance &lt;- <span class="hljs-keyword">function</span>
+ (TrnX1, TrnX2, TstX = <span class="hljs-literal">NULL</span>, var.equal = <span class="hljs-literal">FALSE</span>){
+     <span class="hljs-keyword">if</span> (is.null(TstX) == <span class="hljs-literal">TRUE</span>) TstX &lt;- rbind(TrnX1,TrnX2)
+     <span class="hljs-keyword">if</span> (is.vector(TstX) == <span class="hljs-literal">TRUE</span>) TstX &lt;- t(as.matrix(TstX))
+     <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (is.matrix(TstX) != <span class="hljs-literal">TRUE</span>)
+         TstX &lt;- as.matrix(TstX)
+     <span class="hljs-keyword">if</span> (is.matrix(TrnX1) != <span class="hljs-literal">TRUE</span>) TrnX1 &lt;- as.matrix(TrnX1)
+     <span class="hljs-keyword">if</span> (is.matrix(TrnX2) != <span class="hljs-literal">TRUE</span>) TrnX2 &lt;- as.matrix(TrnX2)
+     nx &lt;- nrow(TstX)
+     blong &lt;- matrix(rep(<span class="hljs-number">0</span>, nx), nrow=<span class="hljs-number">1</span>, byrow=<span class="hljs-literal">TRUE</span>,
+                     dimnames=list(<span class="hljs-string">&quot;blong&quot;</span>, <span class="hljs-number">1</span>:nx))
+     mu1 &lt;- colMeans(TrnX1); mu2 &lt;- colMeans(TrnX2)
+     <span class="hljs-keyword">if</span> (var.equal == <span class="hljs-literal">TRUE</span> || var.equal == <span class="hljs-literal">T</span>){
+      S &lt;- var(rbind(TrnX1,TrnX2))
+     w &lt;- mahalanobis(TstX, mu2, S)
+     - mahalanobis(TstX, mu1, S)
+     }
+     <span class="hljs-keyword">else</span>{
+         S1 &lt; -var(TrnX1); S2 &lt;- var(TrnX2)
+         w &lt;- mahalanobis(TstX, mu2, S2)
+         - mahalanobis(TstX, mu1, S1)
+     }
+     <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:nx){
+         <span class="hljs-keyword">if</span> (w[i] &gt; <span class="hljs-number">0</span>)
+             blong[i] &lt;- <span class="hljs-number">1</span>
+         <span class="hljs-keyword">else</span>
+             blong[i] &lt;- <span class="hljs-number">2</span>
+     }
+     blong
+ }
&gt; discriminiant.distance(filboys2018,filgirls2018, var.equal = <span class="hljs-literal">TRUE</span>)
</code></pre>
<pre><code>      1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35
blong 1 1 1 1 1 1 1 1 1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67
blong  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99
blong  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
      100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118
blong   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
</code></pre><p>&#x53EF;&#x4EE5;&#x89C1;&#x5230;&#x6CA1;&#x6709;&#x6548;&#x679C;...</p>
<h3 id="bayes-&#x5224;&#x522B;&#x6CD5;">Bayes &#x5224;&#x522B;&#x6CD5;</h3>
<p>&#x8BB0;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AECM%28R_1%2CR_2%29%3DL%282%7C1%29P%282%7C1%29P%28X_1%29%2BL%281%7C2%29P%281%7C2%29P%28X_2%29%0A" alt="formula"></p>
<p>&#x5176;&#x4E2D; 2|1 &#x8868;&#x793A;1&#x5206;&#x7C7B;&#x88AB;&#x9519;&#x8BEF;&#x5206;&#x7C7B;&#x6210;2&#x7684;&#x6982;&#x7387;&#xFF0C;L&#x4EE3;&#x8868;&#x635F;&#x5931;&#xFF0C;<img src="https://latex.codecogs.com/gif.latex?P%28X_1%29" alt="formula"> &#x5373;&#x5148;&#x9A8C;&#x5206;&#x5E03;&#xFF0C;&#x4EE4; <img src="https://latex.codecogs.com/gif.latex?p_i%3DP%28X_i%29" alt="formula">&#xFF0C;&#x5E76;&#x4E14;&#x7B26;&#x5408;&#x6B63;&#x6001;&#x5206;&#x5E03; &#x6781;&#x5C0F;&#x5316;&#x8BE5;&#x5F0F;&#x7B49;&#x4EF7;&#x4E8E;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AR_1%3D%5C%7Bx%7C%5Cfrac%7Bf_1%28x%29%7D%7Bf_2%28x%29%7D%5Cge%5Cfrac%7BL%281%7C2%29%2Ap_1%7D%7BL%282%7C1%29%2Ap_2%7D%5C%7D%0A" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AR_2%3D%5C%7Bx%7C%5Cfrac%7Bf_1%28x%29%7D%7Bf_2%28x%29%7D%3C%5Cfrac%7BL%281%7C2%29%2Ap_1%7D%7BL%282%7C1%29%2Ap_2%7D%5C%7D%0A" alt="formula"></p>
<p>&#x7B49;&#x4EF7;&#x4E8E;
<img src="https://latex.codecogs.com/gif.latex?%0AR_1%3D%5C%7Bx%7CW%28x%29%5Cge%5Cbeta%5C%7D%0A" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AR_2%3D%5C%7Bx%7CW%28x%29%3C%5Cbeta%5C%7D%0A" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AW%28x%29%3D%5Cfrac%7B1%7D%7B2%7D%28x-%5Cmu_2%29%5ET%5CSigma_2%5E%7B-1%7D%28x-%5Cmu_2%29-%5Cfrac%7B1%7D%7B2%7D%28x-%5Cmu_1%29%5ET%5CSigma_1%5E%7B-1%7D%28x-%5Cmu_1%29%0A" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Cbeta%3Dln%5Cfrac%7BL%281%7C2%29%2Ap_1%7D%7BL%282%7C1%29%2Ap_2%7D%2B%5Cfrac%7B1%7D%7B2%7Dln%28%5Cfrac%7B%7C%5CSigma_1%7C%7D%7B%7C%5CSigma_2%7C%7D%29%0A" alt="formula"></p>
<pre><code class="lang-R">&gt; discriminiant.bayes &lt;- <span class="hljs-keyword">function</span>
+ (TrnX1, TrnX2, rate = <span class="hljs-number">1</span>, TstX = <span class="hljs-literal">NULL</span>, var.equal = <span class="hljs-literal">FALSE</span>){
+     <span class="hljs-keyword">if</span> (is.null(TstX) == <span class="hljs-literal">TRUE</span>) TstX&lt;-rbind(TrnX1,TrnX2)
+     <span class="hljs-keyword">if</span> (is.vector(TstX) == <span class="hljs-literal">TRUE</span>) TstX &lt;- t(as.matrix(TstX))
+     <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (is.matrix(TstX) != <span class="hljs-literal">TRUE</span>)
+         TstX &lt;- as.matrix(TstX);
+ <span class="hljs-keyword">if</span> (is.matrix(TrnX1) != <span class="hljs-literal">TRUE</span>) TrnX1 &lt;- as.matrix(TrnX1)
+ <span class="hljs-keyword">if</span> (is.matrix(TrnX2) != <span class="hljs-literal">TRUE</span>) TrnX2 &lt;- as.matrix(TrnX2)
+ nx &lt;- nrow(TstX)
+ blong &lt;- matrix(rep(<span class="hljs-number">0</span>, nx), nrow=<span class="hljs-number">1</span>, byrow=<span class="hljs-literal">TRUE</span>,
+                 dimnames=list(<span class="hljs-string">&quot;blong&quot;</span>, <span class="hljs-number">1</span>:nx))
+ mu1 &lt;- colMeans(TrnX1); mu2 &lt;- colMeans(TrnX2)
+ <span class="hljs-keyword">if</span> (var.equal == <span class="hljs-literal">TRUE</span> || var.equal == <span class="hljs-literal">T</span>){
+     S &lt;- var(rbind(TrnX1,TrnX2)); beta &lt;- <span class="hljs-number">2</span>*log(rate)
+     w &lt;- mahalanobis(TstX, mu2, S)
+     - mahalanobis(TstX, mu1, S)
+ }
+ <span class="hljs-keyword">else</span>{
+     S1 &lt;- var(TrnX1); S2 &lt;- var(TrnX2)
+     beta &lt;- <span class="hljs-number">2</span>*log(rate) + log(det(S1)/det(S2))
+     w &lt;- mahalanobis(TstX, mu2, S2)
+     - mahalanobis(TstX, mu1, S1)
+ }
+ <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:nx){
+     <span class="hljs-keyword">if</span> (w[i] &gt; beta)
+         blong[i] &lt;- <span class="hljs-number">1</span>
+     <span class="hljs-keyword">else</span>
+         blong[i] &lt;- <span class="hljs-number">2</span>
+ }
+ blong
+ }
&gt; discriminiant.bayes(filboys2018, filgirls2018, rate=<span class="hljs-number">36</span>/<span class="hljs-number">6</span>, var.equal=<span class="hljs-literal">TRUE</span>)
</code></pre>
<pre><code>      1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
blong 1 1 2 1 1 1 1 1 1  2  1  2  1  1  1  1  1  2  1  2  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  2  1  1  1
      41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77
blong  1  1  2  1  1  1  1  1  1  2  1  1  1  1  2  1  1  1  2  2  2  1  1  1  1  1  1  1  1  2  1  1  2  2  1  1  2
      78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110
blong  1  1  2  2  1  2  2  2  2  2  2  2  1  1  1  2  2  2  2  2  1  2   2   1   2   2   2   2   2   2   2   2   2
      111 112 113 114 115 116 117 118
blong   2   2   1   2   2   2   2   2
</code></pre><p>&#x6CE8;&#x610F;&#x8981;&#x8C03;&#x6574;&#x4E24;&#x4E2A;&#x5148;&#x9A8C;&#x635F;&#x5931;&#x6BD4;&#x503C;&#x5230;&#x6700;&#x4F18;&#xFF0C;&#x8FD9;&#x91CC;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x5927;&#x81F4;rate&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5206;&#x7C7B;&#x6548;&#x679C;&#x6709;&#x4E86;&#x5927;&#x5E45;&#x5EA6;&#x63D0;&#x5347;</p>
<h3 id="fisher-&#x5224;&#x522B;&#x6CD5;">Fisher &#x5224;&#x522B;&#x6CD5;</h3>
<p>&#x4EE5;u(x)&#x4F5C;&#x4E3A;&#x4EE3;&#x66FF;&#x6BCF;&#x4E2A;x&#xFF0C;&#x8BB0;
<img src="https://latex.codecogs.com/gif.latex?%0AW%3D%5Csigma_1%5E2%2B%5Csigma_2%5E2%0A" alt="formula">
<img src="https://latex.codecogs.com/gif.latex?%0AB%3D%28%5Cmu_1-%5Coverline%7B%5Cmu%7D%29%5E2%2B%28%5Cmu_2-%5Coverline%7B%5Cmu%7D%29%5E2%0A" alt="formula">
&#x73B0;&#x5728;&#x8981;&#x6C42;
<img src="https://latex.codecogs.com/gif.latex?%0Amax.I%3D%5Cfrac%7BB%7D%7BW%7D%0A" alt="formula">
&#x56E0;&#x6B64;&#x5224;&#x522B;&#x4E3A;
<img src="https://latex.codecogs.com/gif.latex?%0AR_1%3D%5C%7Bx%7C%7C%5Cmu%28x%29-%5Cmu_1%7C%5Cle%7C%5Cmu%28x%29-%5Cmu_2%7C%5C%7D%0A" alt="formula">
<img src="https://latex.codecogs.com/gif.latex?%0AR_2%3D%5C%7Bx%7C%7C%5Cmu%28x%29-%5Cmu_1%7C%3E%7C%5Cmu%28x%29-%5Cmu_2%7C%5C%7D%0A" alt="formula"></p>
<p>&#x8003;&#x8651; u(x) &#x4E3A;&#x7EBF;&#x6027;&#x51FD;&#x6570;&#x60C5;&#x51B5;&#xFF0C;&#x5373;&#x4EE4;
<img src="https://latex.codecogs.com/gif.latex?%0A%5Cmu%28x%29%3Da%5ETx%0A" alt="formula">
&#x6709;
<img src="https://latex.codecogs.com/gif.latex?%0A%5Chat%7BW%7D%3Da%5ETSa%0A" alt="formula">
<img src="https://latex.codecogs.com/gif.latex?%0A%5Chat%7BB%7D%3D%5Cfrac%7Bn_1n_2%7D%7Bn%7Da%5ET%28%5Csum%20n_i%28%5Coverline%7BX_i%7D-%5Coverline%7BX%7D%29%28%5Coverline%7BX_i%7D-%5Coverline%7BX%7D%29%5ET%29a%0A" alt="formula">
&#x8F6C;&#x5316;&#x4E3A;&#x51F8;&#x95EE;&#x9898;
<img src="https://latex.codecogs.com/gif.latex?%0Amax.%20a%5ET%28%5Csum%20n_i%28%5Coverline%7BX_i%7D-%5Coverline%7BX%7D%29%28%5Coverline%7BX_i%7D-%5Coverline%7BX%7D%29%5ET%29a%0A" alt="formula">
<img src="https://latex.codecogs.com/gif.latex?%0As.t.%20a%5ETSa%3D1%0A" alt="formula">
&#x53EF;&#x4EE5;&#x6C42;&#x5F97;
<img src="https://latex.codecogs.com/gif.latex?%0Aa%3DS%5E%7B-1%7D%28%5Coverline%7BX_2%7D-%5Coverline%7BX_1%7D%29%0A" alt="formula"></p>
<p>&#x4E3A;&#x4E86;&#x533A;&#x5206;&#x5728; <img src="https://latex.codecogs.com/gif.latex?%5Cmu_1" alt="formula"> &#x548C; <img src="https://latex.codecogs.com/gif.latex?%5Cmu_2" alt="formula"> &#x4E2D;&#x7684;&#x53D8;&#x91CF;&#xFF0C;&#x6784;&#x9020;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AW%28X%29%3D%28%5Coverline%7BX_2%7D-%5Coverline%7BX_1%7D%29%5ETS%5E%7B-1%7D%28x-%5Coverline%7Bx%7D%29%0A" alt="formula">
&#x6709;&#x5224;&#x522B;
<img src="https://latex.codecogs.com/gif.latex?%0AR_1%3D%5C%7Bx%7CW%28x%29%5Cle0%5C%7D%0A" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AR_2%3D%5C%7Bx%7CW%28x%29%3E0%5C%7D%0A" alt="formula"></p>
<pre><code class="lang-R">&gt; discriminiant.fisher &lt;- <span class="hljs-keyword">function</span>(TrnX1, TrnX2, TstX = <span class="hljs-literal">NULL</span>){
+     <span class="hljs-keyword">if</span> (is.null(TstX) == <span class="hljs-literal">TRUE</span>) TstX &lt;- rbind(TrnX1,TrnX2)
+     <span class="hljs-keyword">if</span> (is.vector(TstX) == <span class="hljs-literal">TRUE</span>) TstX &lt;- t(as.matrix(TstX))
+     <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (is.matrix(TstX) != <span class="hljs-literal">TRUE</span>)
+         TstX &lt;- as.matrix(TstX)
+     <span class="hljs-keyword">if</span> (is.matrix(TrnX1) != <span class="hljs-literal">TRUE</span>) TrnX1 &lt;- as.matrix(TrnX1)
+     <span class="hljs-keyword">if</span> (is.matrix(TrnX2) != <span class="hljs-literal">TRUE</span>) TrnX2 &lt;- as.matrix(TrnX2)
+     nx &lt;- nrow(TstX)
+     blong &lt;- matrix(rep(<span class="hljs-number">0</span>, nx), nrow=<span class="hljs-number">1</span>, byrow=<span class="hljs-literal">TRUE</span>,
+                     dimnames=list(<span class="hljs-string">&quot;blong&quot;</span>, <span class="hljs-number">1</span>:nx))
+     n1 &lt;- nrow(TrnX1); n2 &lt;- nrow(TrnX2)
+     mu1 &lt;- colMeans(TrnX1); mu2 &lt;- colMeans(TrnX2)
+     S &lt;- (n1-<span class="hljs-number">1</span>)*var(TrnX1) + (n2-<span class="hljs-number">1</span>)*var(TrnX2)
+     mu &lt;- n1/(n1+n2)*mu1 + n2/(n1+n2)*mu2
+     w &lt;- (TstX-rep(<span class="hljs-number">1</span>,nx) %o% mu) %*% solve(S, mu2-mu1);
+     <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:nx){
+         <span class="hljs-keyword">if</span> (w[i] &lt;= <span class="hljs-number">0</span>)
+             blong[i] &lt;- <span class="hljs-number">1</span>
+         <span class="hljs-keyword">else</span>
+             blong[i] &lt;- <span class="hljs-number">2</span>
+     }
+     blong
+ }
&gt; discriminiant.fisher(filboys2018,filgirls2018)
</code></pre>
<pre><code>      1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
blong 1 1 1 1 1 1 1 1 1  2  1  1  1  1  1  1  1  2  1  2  1  1  1  1  1  1  1  1  2  1  1  1  1  1  1  1  1  1  1  1
      41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77
blong  1  1  1  1  1  1  2  1  1  1  1  2  1  1  2  1  2  1  2  2  1  2  1  1  1  1  1  1  1  1  1  1  1  2  1  1  2
      78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110
blong  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2   2   2   2   2   2   2   2   2   2   2   2
      111 112 113 114 115 116 117 118
blong   2   2   2   2   2   2   2   2
</code></pre><p>&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x6548;&#x679C;&#x5F88;&#x597D;</p>
<p><code>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x4EE5;&#x4E0A;&#x5206;&#x6790;&#x90FD;&#x662F;&#x5EFA;&#x7ACB;&#x5728;&#x672C;&#x8EAB;&#x7684;&#x96C6;&#x5408;&#x4E0A;&#x4E5F;&#x5C31;&#x662F;&#x8BAD;&#x7EC3;&#x96C6;&#x4E0A;</code></p>
<h2 id="&#x805A;&#x7C7B;&#x5206;&#x6790;">&#x805A;&#x7C7B;&#x5206;&#x6790;</h2>
<h3 id="&#x8DDD;&#x79BB;&#x548C;&#x76F8;&#x4F3C;&#x5EA6;">&#x8DDD;&#x79BB;&#x548C;&#x76F8;&#x4F3C;&#x5EA6;</h3>
<p>&#x8DDD;&#x79BB;&#x6709;<code>&#x7EDD;&#x5BF9;&#x503C;&#x8DDD;&#x79BB;</code>&#xFF0C;<code>Euclide&#x8DDD;&#x79BB;</code>&#xFF0C;<code>Minkowski&#x8DDD;&#x79BB;</code>&#xFF0C;<code>Chebyshev&#x8DDD;&#x79BB;</code>&#xFF0C;<code>Lance&#x8DDD;&#x79BB;</code>&#xFF0C;<code>Mahalanobis&#x8DDD;&#x79BB;</code>&#xFF0C;<code>&#x5B9A;&#x6027;&#x53D8;&#x91CF;&#x6837;&#x672C;&#x8DDD;&#x79BB;</code></p>
<p>&#x5176;&#x4E2D;<code>Minkowski&#x8DDD;&#x79BB;</code></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0Ad_%7Bij%7D%3D%5B%5Csum%28x_%7Bik%7D-x_%7Bj_k%7D%29%5Eq%5D%5E%7B1-q%7D%0A" alt="formula"></p>
<p><code>Lance&#x8DDD;&#x79BB;</code></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0Ad_%7Bij%7D%3D%5Csum%5Cfrac%7Bx_%7Bik%7D-x_%7Bjk%7D%7D%7Bx_%7Bik%7D%2Bx_%7Bjk%7D%7D%0A" alt="formula"></p>
<p><code>&#x5B9A;&#x6027;&#x53D8;&#x91CF;&#x6837;&#x672C;&#x8DDD;&#x79BB;</code></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0Ad_%7Bij%7D%3D%5Cfrac%7Bm_2%7D%7Bm_1%2Bm_2%7D%0A" alt="formula">
&#x5176;&#x4E2D;m1&#x6307;&#x6837;&#x672C;&#x67D0;&#x56E0;&#x7D20;&#x4E0B;&#x90FD;&#x4E3A;1&#x5373;&#x5339;&#x914D;&#x7684;&#x4E2A;&#x6570;&#xFF0C;m2&#x5373;&#x4E0D;&#x5339;&#x914D;&#x4E2A;&#x6570;&#xFF0C;&#x53E6;&#x5916;m0&#x4E3A;&#x90FD;&#x4E3A;0&#x4E2A;&#x6570;</p>
<p>&#x76F8;&#x5173;&#x7CFB;&#x6570;&#x6709;<code>&#x4F59;&#x5F26;</code>&#x548C;<code>&#x76F8;&#x5173;&#x7CFB;&#x6570;</code></p>
<p>&#x5176;&#x4E2D;<code>&#x4F59;&#x5F26;</code></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0Ac_%7Bij%7D%3D%5Cfrac%7B%5Csum%7Bx_%7Bki%7Dx_%7Bkj%7D%7D%7D%7B%5Csqrt%7B%5Csum%7Bx_%7Bki%7D%5E2%7D%7D%5Csqrt%7B%5Csum%7Bx_%7Bkj%7D%5E2%7D%7D%7D%0A" alt="formula"></p>
<h3 id="&#x7CFB;&#x7EDF;&#x805A;&#x7C7B;&#x6CD5;">&#x7CFB;&#x7EDF;&#x805A;&#x7C7B;&#x6CD5;</h3>
<blockquote>
<p>&#x5B9E;&#x9645;&#x4E0A;&#x8FD9;&#x91CC;&#x5C31;&#x662F;&#x5B9A;&#x4E49;&#x7C7B;&#x522B;&#x95F4;&#xFF0C;&#x70B9;&#x5230;&#x7C7B;&#x522B;&#x7684;&#x8DDD;&#x79BB;&#xFF0C;&#x6784;&#x6210;&#x805A;&#x7C7B;&#x6811;</p>
</blockquote>
<p><code>&#x6700;&#x77ED;&#x8DDD;&#x79BB;</code></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AD_%7BKL%7D%3D%5Cmin%5Climits_%7Bi%5Cin%20G_%7BK%7D%2Cj%5Cin%20G_%7BL%7D%7Dd_%7Bij%7D%0A" alt="formula"></p>
<p><code>&#x6700;&#x957F;&#x8DDD;&#x79BB;&#x6CD5;</code></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AD_%7BKL%7D%3D%5Cmax%5Climits_%7Bi%5Cin%20G_%7BK%7D%2Cj%5Cin%20G_%7BL%7D%7Dd_%7Bij%7D%0A" alt="formula"></p>
<p><code>&#x4E2D;&#x95F4;&#x8DDD;&#x79BB;</code>
&#x7528;Mcquitty&#x8DDD;&#x79BB;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AD_%7BMJ%7D%5E2%3D%5Cfrac%7B1%7D%7B2%7D%28D_%7BKL%7D%5E2%2BD_%7BLJ%7D%5E2%29%0A" alt="formula"></p>
<p><code>&#x7C7B;&#x5E73;&#x5747;&#x6CD5;</code></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AD_%7BKL%7D%3D%5Cfrac%7B1%7D%7Bn_Kn_L%7D%5Csum%5Climits_%7Bi%5Cin%20G_%7BK%7D%2Cj%5Cin%20G_%7BL%7D%7Dd_%7Bij%7D%0A" alt="formula"></p>
<p><code>&#x91CD;&#x5FC3;&#x6CD5;</code></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AD_%7BKL%7D%3D%28%5Coverline%7Bx%7D_K-%5Coverline%7Bx%7D_L%29%5ET%28%5Coverline%7Bx%7D_K-%5Coverline%7Bx%7D_L%29%0A" alt="formula"></p>
<p><code>&#x79BB;&#x5DEE;&#x5E73;&#x65B9;&#x548C;&#x6CD5;(ward)</code></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AD_%7BKL%7D%3DW_M-W_K-W_L%0A" alt="formula">
&#x5176;&#x4E2D;W&#x8868;&#x793A;&#x79BB;&#x5DEE;&#x5E73;&#x65B9;&#x548C;&#xFF0C;M&#x8868;&#x793A;K&#x3001;L&#x5408;&#x5E76;&#x540E;&#x7684;&#x96C6;&#x5408;</p>
<p>&#x4E0B;&#x9762;&#x5229;&#x7528;&#x6B27;&#x5F0F;&#x8DDD;&#x79BB;&#x548C;Mcquitty&#x8DDD;&#x79BB;&#x7ED8;&#x5236;&#x8C31;&#x7CFB;&#x56FE;</p>
<pre><code class="lang-R">&gt; d&lt;-dist(fil2018)
&gt; hc1&lt;-hclust(d, <span class="hljs-string">&quot;mcquitty&quot;</span>)
&gt; plot(hc1)
</code></pre>
<p><img src="img/cluster.png" alt="cluster"></p>
<h3 id="&#x52A8;&#x6001;&#x805A;&#x7C7B;&#x6CD5;">&#x52A8;&#x6001;&#x805A;&#x7C7B;&#x6CD5;</h3>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x6307;Kmean</p>
</blockquote>
<table>
<thead>
<tr>
<th>K-mean Algorithm</th>
</tr>
</thead>
<tbody>
<tr>
<td>1. &#x521D;&#x59CB;&#x5316;k&#x4E2A;&#x7C7B;&#x522B;&#x4E2D;&#x5FC3;ai<br>2. &#x5BF9;&#x6BCF;&#x4E2A;&#x6837;&#x672C;Xi&#x6807;&#x8BB0;&#x4F4D;&#x8DDD;&#x79BB;&#x4E2D;&#x5FC3;aj&#x6700;&#x8FD1;&#x7684;&#x7C7B;&#x522B;j&#xFF0C;&#x5373; <img src="https://latex.codecogs.com/gif.latex?label_i%3D%5Cmin%5Climits_%7B1%5Cle%20j%5Cle%20k%7Ddist%28x_i%2Ca_i%29" alt="formula"><br>3. &#x66F4;&#x65B0;aj&#x4E3A;&#x96B6;&#x5C5E;&#x8BE5;&#x7C7B;&#x522B;&#x6240;&#x6709;&#x503C;&#x5F97;&#x5747;&#x503C;<br>4. &#x8FED;&#x4EE3;2&#xFF0C;3&#xFF0C;&#x76F4;&#x5230;&#x8FBE;&#x5230;&#x7EC8;&#x6B62;&#x6761;&#x4EF6;&#xFF08;&#x8FED;&#x4EE3;&#x6B21;&#x6570;&#x3001;MSE&#x6700;&#x5C0F;&#x7B49;&#xFF09;</td>
</tr>
</tbody>
</table>
<p>&#x7528;&#x5B83;&#x5728;2018&#x5E74;&#x6570;&#x636E;&#x96C6;&#x4E0A;&#x8FDB;&#x884C;&#x805A;&#x7C7B;</p>
<pre><code class="lang-R">&gt; km &lt;- kmeans(scale(fil2018),centers = <span class="hljs-number">2</span>)
</code></pre>
<pre><code>K-means clustering with 2 clusters of sizes 56, 62

Cluster means:
      height    armSpan footLength  legLength     weight
1  0.8085181  0.8143927  0.7943666  0.5233794  0.7105720
2 -0.7302744 -0.7355805 -0.7174924 -0.4727298 -0.6418069

Clustering vector:
  [1] 1 2 1 1 2 1 1 1 2 1 1 2 1 1 1 1 1 2 1 2 1 1 1 2 1 1 1 2 1 2 1 1 1 1 1 2
 [37] 1 1 1 1 1 1 1 1 1 1 2 1 1 1 2 2 1 1 2 1 2 1 2 2 1 2 1 1 1 1 1 1 1 1 1 2
 [73] 1 2 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
[109] 2 2 2 2 2 2 2 2 2 2

Within cluster sum of squares by cluster:
[1] 150.3374 144.0392
 (between_SS / total_SS =  49.7 %)

Available components:

[1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;     &quot;tot.withinss&quot;
[6] &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;         &quot;ifault&quot;
</code></pre><p>&#x6211;&#x4EEC;&#x5BF9;clustering&#x7684;&#x7ED3;&#x679C;&#x5206;&#x6790;&#xFF0C;&#x8FD0;&#x7528;<a href="#Model-Analyse-&amp;-Evaluation">Model Analyse &amp; Evaluation</a>&#x8BC4;&#x4F30;&#x5B9A;&#x4E49;&#x8BA1;&#x7B97;&#x5F97;&#x5230;</p>
<pre><code>&gt; modelroc &lt;- roc(classFil2018$c,km$cluster)
&gt; plot(modelroc, print.auc=TRUE, auc.polygon=TRUE, grid=c(0.1, 0.2),
+      grid.col=c(&quot;green&quot;, &quot;red&quot;), max.auc.polygon=TRUE,
+      auc.polygon.col=&quot;skyblue&quot;, print.thres=TRUE)
</code></pre><p><img src="img/auc.png" alt="auc"></p>
<p>&#x9762;&#x79EF;&#x5360;0.835&#x5373;AUC&#x4E3A;0.835&#xFF0C;&#x6548;&#x679C;&#x4E0D;&#x9519;</p>
<h2 id="&#x4E3B;&#x6210;&#x5206;&#x5206;&#x6790;">&#x4E3B;&#x6210;&#x5206;&#x5206;&#x6790;</h2>
<p><img src="https://latex.codecogs.com/gif.latex?%0AQ%5ET%5CSigma%20Q%3D%5Cbegin%7Bbmatrix%7D%5Clambda_%7B1%7D%20%26%200%20%26%20%5Cddots%20%26%200%5C%5C%0A0%20%26%20%5Clambda_%7B2%7D%20%26%20%5Cddots%20%26%200%5C%5C%0A%5Cvdots%20%26%20%5Cvdots%20%26%20%5Cddots%20%20%26%20%5Cvdots%20%20%5C%5C%0A0%20%26%200%20%26%20%5Cddots%20%26%20%5Clambda_%7Bn%7D%5Cend%7Bbmatrix%7D%3D%5CLambda%0A" alt="formula"></p>
<p>&#x4E14;&#x7279;&#x5F81;&#x503C; <img src="https://latex.codecogs.com/gif.latex?%5Clambda_1%5Cge%5Clambda_2%5Cge...%5Cge%5Clambda_n" alt="formula">&#xFF0C;Q&#x7B2C; i &#x5217;&#x5373;ai&#xFF0C;&#x5219; <img src="https://latex.codecogs.com/gif.latex?Z_i%3Da_i%5ETX" alt="formula"> &#x5373;&#x4E3A;&#x4E3B;&#x6210;&#x5206;</p>
<p>&#x6211;&#x4EEC;&#x5BB9;&#x6613;&#x5F97;&#x5230; <img src="https://latex.codecogs.com/gif.latex?Z%3DQ%5ETX" alt="formula">&#xFF0C;&#x5E76;&#x4E14; <img src="https://latex.codecogs.com/gif.latex?E%28Z%29%3DQ%5ET%5Cmu" alt="formula"> &#x548C; <img src="https://latex.codecogs.com/gif.latex?Var%28Z%29%3D%5CLambda" alt="formula">&#xFF0C;&#x6B64;&#x5916; <img src="https://latex.codecogs.com/gif.latex?tr%28%5CLambda%29%3Dtr%28%5CSigma%29" alt="formula">&#xFF0C;&#x56E0;&#x6B64;&#x4E3B;&#x6210;&#x5206;&#x53EF;&#x4EE5;&#x770B;&#x4F5C;&#x4E00;&#x79CD;&#x8D21;&#x732E;&#x7387;&#xFF0C;&#x5373;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0Ar_%7Bj%5Ccdot1%2C...%2Cm%7D%5E2%3D%5Csum%7Br%5E2%28X_j%2CZ_i%29%7D%3D%5Cfrac%7B%5Clambda_iq_%7Bij%7D%5E2%7D%7B%5Csigma_%7Bjj%7D%7D%0A" alt="formula"></p>
<p>&#x5373;&#x5BF9;Xj&#x7684;&#x8D21;&#x732E;&#x7387;</p>
<p>&#x603B;&#x4F53;&#x6570;&#x636E;&#x5F52;&#x4E00;&#x5316;&#x540E;&#x8FD8;&#x6709;
<img src="https://latex.codecogs.com/gif.latex?%0A%5Csum%5Clambda_i%3D1%0A" alt="formula"></p>
<p>&#x4E00;&#x822C;&#x6765;&#x8BF4;&#x4E0D;&#x4F1A;&#x53D6;&#x6240;&#x6709;&#x7684;&#x7279;&#x5F81;&#x503C;&#xFF0C;&#x800C;&#x4F1A;&#x53D6;&#x524D;k&#x540D;&#x6765;&#x964D;&#x7EF4;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x4F5C;&#x662F;n&#x7EF4;&#x5411;&#x91CF;&#x6295;&#x5F71;&#x5230;k&#x7EF4;&#x7279;&#x5F81;&#x5411;&#x91CF;&#x6784;&#x6210;&#x7684;&#x7A7A;&#x95F4;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x4F5C;&#x662F;&#x6295;&#x5F71;k&#x7EF4;&#x7A7A;&#x95F4;&#x8BA9;<strong>&#x65B9;&#x5DEE;&#x6700;&#x5927;&#x5316;</strong></p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x53D6;&#x7B2C;&#x4E00;&#x4E3B;&#x8F74;&#x8FDB;&#x884C;&#x6295;&#x5F71;&#xFF0C;&#x8BBE;&#x8BE5;&#x4E3B;&#x8F74;&#x5355;&#x7EF4;&#x5411;&#x91CF; <img src="https://latex.codecogs.com/gif.latex?%5Cmu" alt="formula"></p>
<p>&#x8F6C;&#x5316;&#x4E3A;&#x51F8;&#x95EE;&#x9898;
<img src="https://latex.codecogs.com/gif.latex?%0Amax.%20%5Cmu%20S%5ET%5Cmu%0A" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0As.t.%5Cmu%5ET%5Cmu%3D1%0A" alt="formula"></p>
<p>&#x6C42;&#x5BFC;&#x540E;&#x53EF;&#x4EE5;&#x5F97;&#x5230;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Cmu%20S%5ET%5Cmu%3D%5Clambda_1%0A" alt="formula">
&#x4E3B;&#x6210;&#x5206;&#x7684;&#x4F30;&#x8BA1;&#x53EF;&#x4EE5;&#x4ECE;R&#x6216;S&#x5206;&#x89E3;&#x5F97;&#x5230;</p>
<p>&#x6211;&#x4EEC;&#x5206;&#x6790;2018&#x5E74;&#x7537;&#x751F;&#x6570;&#x636E;&#x7684;&#x4E3B;&#x6210;&#x5206;&#x6709;</p>
<pre><code class="lang-R">&gt; student.pr &lt;- princomp(filboys2018, cor = <span class="hljs-literal">TRUE</span>)
&gt; summary(student.pr, loadings=<span class="hljs-literal">TRUE</span>)
</code></pre>
<pre><code>Importance of components:
                          Comp.1    Comp.2    Comp.3     Comp.4     Comp.5
Standard deviation     1.6779599 0.9786991 0.7704042 0.62476182 0.49269547
Proportion of Variance 0.5631099 0.1915704 0.1187045 0.07806547 0.04854976
Cumulative Proportion  0.5631099 0.7546802 0.8733848 0.95145024 1.00000000

Loadings:
           Comp.1 Comp.2 Comp.3 Comp.4 Comp.5
height     -0.528         0.262  0.315  0.743
armSpan    -0.516 -0.190  0.121  0.535 -0.630
footLength -0.415  0.263 -0.867              
legLength  -0.354 -0.735        -0.579       
weight     -0.397  0.596  0.405 -0.524 -0.221
</code></pre><p><code>Proportion of Variance</code>&#x6307;&#x65B9;&#x5DEE;&#x8D21;&#x732E;&#x7387;&#xFF0C;<code>Cumulative Proportion</code>&#x5C06;&#x5176;&#x7D2F;&#x52A0;&#x4E86;&#x8D77;&#x6765;</p>
<pre><code class="lang-R">&gt; predict(student.pr)
</code></pre>
<pre><code>           Comp.1      Comp.2       Comp.3       Comp.4       Comp.5
 [1,]  0.17453006 -0.13413693 -0.132515800 -1.295101592  1.020301985
 [2,]  1.74982067 -0.02823945 -0.586333908  0.520712654 -0.195495411
 [3,]  0.87604580  0.12672015 -0.537484418  0.062848912  0.093557077
 [4,] -1.37377318 -0.56366086 -0.622659241  0.159649096 -0.265971691
 [5,]  1.63967529  1.19907331 -1.006739777 -0.424668997 -0.007844825
 [6,]  0.87982394 -0.17424538 -1.663347523  0.965049979 -0.618151020
 [7,]  0.32151522 -1.42602248 -0.299931423  0.219014049 -0.157092700
 [8,] -1.39433411  0.48366786  0.754957280 -0.872132637  0.622994147
 [9,]  1.81318380  1.16697401  2.166023691 -0.226957587  0.634817698
[10,]  1.10339003 -0.62411930 -0.387028973 -0.483944160 -0.526571907
[11,] -3.37100907 -0.24125106  0.445204808  0.171373815  0.136073490
[12,]  1.71496737  0.30175951  0.034790092  0.123209069 -0.034877503
[13,]  0.70666287  0.04018691  0.012253856  0.025692721  0.781479358
[14,] -3.20897924  1.54589888 -0.035447437  0.210683740 -0.142731632
[15,] -0.83474281  0.64600364  0.432908559 -0.110885173 -0.423545400
[16,] -1.16785417  3.83306647 -0.332409496  0.348550600 -0.191457050
[17,] -1.09313892 -1.33808605  0.434094555 -0.102694741 -0.058171659
[18,]  2.95627277 -0.33199199  0.231082018 -0.646702289 -0.351093880
[19,] -2.85637515  0.30406053 -0.479334756 -1.112046588 -0.365535598
[20,]  1.64115812 -0.89659264  0.659977740  0.092883582  0.479698642
[21,]  0.36585408 -0.16169799 -0.365424948 -0.348048285 -0.392567565
[22,] -2.74349953 -0.80324372  0.016425444 -0.296966612  0.211718973
[23,] -2.52462675 -0.49845443 -0.534252667  0.522672864  0.081330360
[24,]  2.91066389  1.37852524 -1.103814244 -0.071474647  0.528638037
[25,] -2.09988085 -1.09536995 -1.293982756 -0.295159530  0.648005283
[26,] -0.32462089 -0.37472900  1.201450174  0.873226528 -0.226483646
[27,] -2.68828474  0.18923123  0.361217098 -1.050815416  0.418809622
[28,]  1.22622565 -0.57644468  1.798071287  0.991908004  0.129496070
[29,] -0.03082468 -2.14242594  0.211282682 -0.508256530  0.726693450
[30,]  1.36974851  2.79967556  0.067879379  0.147038008  1.096898409
[31,] -0.09655247  1.30959228  1.137557966  1.018324559  0.090782285
[32,] -1.98917259  1.28207513  1.080347879  1.126259715 -0.295742635
[33,]  0.94390648  0.41698015 -0.415413875 -1.182396902 -0.857411982
[34,] -0.23013731 -0.59822409 -0.291857317  0.854691353  0.136412084
[35,]  0.43569856  0.14803275  0.519151338  1.096059242 -0.047767703
[36,]  2.19107809  1.14864202  0.094154281 -0.453600610 -0.482397313
[37,]  0.16244069  0.10975109 -0.189397015 -0.013752091  0.234326899
[38,]  0.46679811  0.22892847 -0.231472115 -0.891179973  0.096470691
[39,] -0.04234541 -0.91880256 -0.907852593  0.342674841 -0.023400179
[40,] -1.38816048  0.94280260 -0.198684006  0.666985438 -0.195580467
[41,] -0.82043648 -1.61945814 -0.250408795  0.104623807  0.297904946
[42,] -1.34772434 -0.21910879 -0.608665235  0.754696563 -1.007557336
[43,]  0.56034946 -0.26975445 -0.486683386 -0.035656393  0.397139973
[44,] -1.72455116  0.44954315  0.279297142  0.693717832 -0.107642299
[45,] -0.45642803  0.13385445  0.052679154  0.590776857 -0.056538170
[46,] -3.08409925  0.05743128 -0.494906698 -0.095112793  0.529774055
[47,]  3.39309311 -0.81170764  0.744154830  0.523134081  0.526439899
[48,] -1.73687518 -0.93539523  0.411395686 -0.217729949  0.020546230
[49,]  0.42743454  0.64145613 -1.925293391 -0.816680819  0.867849538
[50,]  0.05308791 -1.00604989  0.033303065 -0.686763489 -0.093921845
[51,]  3.16974279  0.32495862 -0.642261735  0.591972438  1.284633220
[52,]  1.71535980 -0.46724379 -0.220026747  0.003146501 -0.853959194
[53,] -1.55476587  0.08355068 -0.340214024  0.256873841 -0.063556119
[54,] -0.46511939  0.87222580  0.844516348 -0.904570925 -0.713935219
[55,]  2.89349983 -1.30813316  0.841788289  0.096077752 -0.158603837
[56,] -1.87342713 -0.73879144  0.009349315  0.991310320  1.021866021
[57,]  1.61788573 -0.26155642 -0.989331981 -0.447927896 -0.466626486
[58,] -0.85899255 -0.63170846  0.059711077 -0.074715856 -0.285144634
[59,]  2.11383100 -1.34120197  1.252071399 -0.459766354 -0.128779873
[60,]  2.10462776 -0.30886003 -0.330609922 -0.154946321 -0.475926534
[61,]  0.22012078 -0.48039529 -0.373895554 -0.377197077  0.020937073
[62,]  1.25740831 -0.94387092  0.763320227  0.637529169 -0.059377069
[63,]  0.38163782  0.96708920  0.946004123 -1.003769342 -0.600465881
[64,] -1.93909469 -1.70727863  0.216709252  0.342127710 -0.268463014
[65,]  0.42857752  0.58558563  0.758187084  0.018258410  0.306919382
[66,] -0.27662982  0.43232680  2.052094778 -1.271158989 -0.590907658
[67,] -1.53284400  0.78872855 -0.112143765 -0.122993984 -0.234853579
[68,]  0.71331318 -0.14140556 -0.960510405 -0.571721493 -0.087179577
[69,]  0.76147048 -0.23099369 -0.678121017  0.549613748 -1.117826655
[70,]  0.24241289  0.46743487 -0.112975256 -0.261018742 -0.133764184
[71,] -2.50924304  0.15933759  0.175186899 -0.056005723  0.190344771
[72,]  1.93523039  0.78548144 -0.957166597  1.251152705 -0.267938733
</code></pre><p>&#x7B2C;&#x4E00;&#x4E3B;&#x6210;&#x5206;&#x8F83;&#x5927;&#x7684;&#x4E00;&#x822C;&#x6240;&#x6709;&#x9879;&#x90FD;&#x5F88;&#x5927;</p>
<p>&#x7528;&#x56FE;&#x8868;&#x66F4;&#x52A0;&#x76F4;&#x89C2;</p>
<pre><code class="lang-R">&gt; biplot(student.pr)
</code></pre>
<p><img src="img/PCAa.png" alt="PCAa"></p>
<h2 id="&#x56E0;&#x5B50;&#x5206;&#x6790;">&#x56E0;&#x5B50;&#x5206;&#x6790;</h2>
<p>&#x5B9A;&#x4E49;
<img src="https://latex.codecogs.com/gif.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Barray%7D%7Blr%7D%0AX_1-%5Cmu_1%3Da_%7B11%7Df_1%2Ba_%7B12%7Df_2%2B...%2Ba_%7B1m%7Df_m%2B%5Cepsilon_1%20%5C%5C%0AX_2-%5Cmu_2%3Da_%7B21%7Df_1%2Ba_%7B22%7Df_2%2B...%2Ba_%7B2m%7Df_m%2B%5Cepsilon_2%20%5C%5C%0A%5Cvdots%20%5C%5C%0AX_p-%5Cmu_p%3Da_%7Bp1%7Df_1%2Ba_%7Bp2%7Df_2%2B...%2Ba_%7Bpm%7Df_m%2B%5Cepsilon_p%0A%5Cend%7Barray%7D%0A%5Cright.%0A" alt="formula"></p>
<p>&#x5176;&#x4E2D;f&#x4E3A;&#x516C;&#x5171;&#x56E0;&#x5B50;&#xFF0C;<img src="https://latex.codecogs.com/gif.latex?Var%28F%29%3DI_m" alt="formula"> &#x4E14; <img src="https://latex.codecogs.com/gif.latex?Var%28%5Cepsilon%29%3Ddiag%28%5Csigma_1%5E2%2C%5Csigma_2%5E2%2C...%2C%5Csigma_m%5E2%29" alt="formula"> &#x5B9A;&#x4E49;&#x7C7B;&#x540C;&#x7EBF;&#x6027;&#x56DE;&#x5F52;&#xFF0C;&#x4E0A;&#x5F0F;&#x4E5F;&#x53EF;&#x4EE5;&#x5199;&#x6210;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AX%3D%5Cmu%2BAF%2B%5Cepsilon%0A" alt="formula">
&#x53EF;&#x4EE5;&#x63A8;&#x51FA; <img src="https://latex.codecogs.com/gif.latex?%5CSigma%3DAA%5ET%2BVar%28%5Cepsilon%29" alt="formula">&#xFF0C; <img src="https://latex.codecogs.com/gif.latex?Cov%28X%2CF%29%3DA" alt="formula">&#xFF0C;&#x4EE4;<img src="https://latex.codecogs.com/gif.latex?h_i%5E2%3D%5Csum%5Climits_%7Bj%7D%7Ba_%7Bij%7D%5E2%7D" alt="formula">&#x6709; 
<img src="https://latex.codecogs.com/gif.latex?%0A%5Csigma_%7Bii%7D%3Dh_i%5E2%2B%5Csigma_i%5E2%0A" alt="formula">
&#x53EF;&#x4EE5;&#x5C06; <img src="https://latex.codecogs.com/gif.latex?h_i" alt="formula">&#x4F5C;&#x4E3A;&#x516C;&#x5171;&#x53D8;&#x91CF;&#x5BF9;<img src="https://latex.codecogs.com/gif.latex?X_i" alt="formula">&#x7684;&#x5F71;&#x54CD;&#xFF0C;&#x4EE4; <img src="https://latex.codecogs.com/gif.latex?g_j%5E2%3D%5Csum%5Climits_%7Bi%7Da_%7Bij%7D%5E2" alt="formula"> &#x6709;
<img src="https://latex.codecogs.com/gif.latex?%0A%5Csum%7BVar%28X_i%29%7D%3D%5Csum%20g_j%5E2%2B%5Csum%20%5Csigma%5E2_i%0A" alt="formula">
&#x5176;&#x4E2D; <img src="https://latex.codecogs.com/gif.latex?g_j" alt="formula"> &#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x56E0;&#x5B50;F&#x7684;&#x5EA6;&#x91CF;</p>
<h3 id="&#x4E3B;&#x6210;&#x5206;&#x6CD5;">&#x4E3B;&#x6210;&#x5206;&#x6CD5;</h3>
<blockquote>
<p>&#x65B9;&#x6CD5;&#x548C;&#x4E3B;&#x6210;&#x5206;&#x5206;&#x6790;&#x76F8;&#x540C;</p>
</blockquote>
<pre><code class="lang-R">&gt; scaleBoys2018&lt;-scale(filboys2018,center = <span class="hljs-literal">TRUE</span>, scale = <span class="hljs-literal">TRUE</span>)
&gt; factor.analy1&lt;-<span class="hljs-keyword">function</span>(S, m){
+     p&lt;-nrow(S); diag_S&lt;-diag(S); sum_rank&lt;-sum(diag_S)
+     rowname&lt;-paste(<span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-number">1</span>:p, sep=<span class="hljs-string">&quot;&quot;</span>)
+     colname&lt;-paste(<span class="hljs-string">&quot;Factor&quot;</span>, <span class="hljs-number">1</span>:m, sep=<span class="hljs-string">&quot;&quot;</span>)
+     A&lt;-matrix(<span class="hljs-number">0</span>, nrow=p, ncol=m,
+               dimnames=list(rowname, colname))
+     eig&lt;-eigen(S)
+     <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:m)
+         A[,i]&lt;-sqrt(eig$values[i])*eig$vectors[,i]
+     h&lt;-diag(A%*%t(A))
+     rowname&lt;-c(<span class="hljs-string">&quot;SS loadings&quot;</span>,<span class="hljs-string">&quot;Proportion Var&quot;</span>,<span class="hljs-string">&quot;Cumulative Var&quot;</span>)
+     B&lt;-matrix(<span class="hljs-number">0</span>, nrow=<span class="hljs-number">3</span>, ncol=m,
+               dimnames=list(rowname, colname))
+     <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:m){
+         B[<span class="hljs-number">1</span>,i]&lt;-sum(A[,i]^<span class="hljs-number">2</span>)
+         B[<span class="hljs-number">2</span>,i]&lt;-B[<span class="hljs-number">1</span>,i]/sum_rank
+         B[<span class="hljs-number">3</span>,i]&lt;-sum(B[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>:i])/sum_rank
+     }
+     method&lt;-c(<span class="hljs-string">&quot;Principal Component Method&quot;</span>)
+     list(method=method, loadings=A,
+          var=cbind(common=h, spcific=diag_S-h), B=B)
+ }
&gt; fa&lt;-factor.analy1(cor(scaleBoys2018),m=<span class="hljs-number">2</span>)
&gt; fa
</code></pre>
<pre><code>$method
[1] &quot;Principal Component Method&quot;

$loadings
      Factor1    Factor2
X1 -0.8864698  0.0223708
X2 -0.8653281 -0.1855111
X3 -0.6964148  0.2572174
X4 -0.5935332 -0.7189724
X5 -0.6660726  0.5829707

$var
      common   spcific
X1 0.7863292 0.2136708
X2 0.7832071 0.2167929
X3 0.5511543 0.4488457
X4 0.8692029 0.1307971
X5 0.7835076 0.2164924

$B
                 Factor1   Factor2
SS loadings    2.8155494 0.9578518
Proportion Var 0.5631099 0.1915704
Cumulative Var 0.5631099 0.7546802
</code></pre><p>&#x53EA;&#x53D6;&#x524D;&#x4E24;&#x4E2A;&#x56E0;&#x5B50;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x7D2F;&#x8BA1;&#x65B9;&#x5DEE;(&#x5373; <img src="https://latex.codecogs.com/gif.latex?%5Csum%20g_j%5E2/%5Csum%20Var%28X_i%29" alt="formula">)&#x53EA;&#x5230;&#x4E86;0.75&#xFF0C;&#x5927;&#x81F4;&#x53EF;&#x4EE5;&#x8BF4;&#x660E;&#x524D;&#x4E24;&#x4E2A;&#x56E0;&#x5B50;&#x8D21;&#x732E;&#x4E3A;0.75&#xFF0C;&#x65B0;&#x751F;&#x6210;&#x7684;&#x534F;&#x65B9;&#x5DEE;&#x9635;&#x5E94;&#x8BE5;&#x548C;&#x539F;&#x6765;&#x7684;&#x5DEE;&#x522B;&#x8F83;&#x5C0F;</p>
<pre><code class="lang-R">&gt; E&lt;- cor(filboys2018)-fa$loadings %*% t(fa$loadings)-diag(fa$var[,<span class="hljs-number">2</span>])
&gt; sum(E^<span class="hljs-number">2</span>)
</code></pre>
<pre><code>[1] 0.2054579
</code></pre><p>&#x53EF;&#x89C1;&#x7ED3;&#x679C;&#x4E00;&#x822C;</p>
<h3 id="&#x4E3B;&#x56E0;&#x5B50;&#x6CD5;">&#x4E3B;&#x56E0;&#x5B50;&#x6CD5;</h3>
<p>&#x5BF9;&#x6807;&#x51C6;&#x5316;&#x540E;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x4EE4;
<img src="https://latex.codecogs.com/gif.latex?%0AR-Var%28%5Cepsilon%29%3DAA%5ET%3DR%5E%2A%0A" alt="formula">
&#x4E3A;&#x4FEE;&#x6B63;&#x540E;&#x7684;R&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x65B9;&#x5DEE;</p>
<pre><code class="lang-R">&gt; factor.analy2&lt;-<span class="hljs-keyword">function</span>(R, m, d){
+     p&lt;-nrow(R); diag_R&lt;-diag(R); sum_rank&lt;-sum(diag_R)
+     rowname&lt;-paste(<span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-number">1</span>:p, sep=<span class="hljs-string">&quot;&quot;</span>)
+     colname&lt;-paste(<span class="hljs-string">&quot;Factor&quot;</span>, <span class="hljs-number">1</span>:m, sep=<span class="hljs-string">&quot;&quot;</span>)
+     A&lt;-matrix(<span class="hljs-number">0</span>, nrow=p, ncol=m,
+               dimnames=list(rowname, colname))
+     kmax=<span class="hljs-number">20</span>; k&lt;-<span class="hljs-number">1</span>; h &lt;- diag_R-d
+     <span class="hljs-keyword">repeat</span>{
+         diag(R)&lt;- h; h1&lt;-h; eig&lt;-eigen(R)
+         <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:m)
+             A[,i]&lt;-sqrt(eig$values[i])*eig$vectors[,i]
+         h&lt;-diag(A %*% t(A))
+         <span class="hljs-keyword">if</span> ((sqrt(sum((h-h1)^<span class="hljs-number">2</span>))&lt;<span class="hljs-number">1e-4</span>)|k==kmax) <span class="hljs-keyword">break</span>
+         k&lt;-k+<span class="hljs-number">1</span>
+     }
+ rowname&lt;-c(<span class="hljs-string">&quot;SS loadings&quot;</span>,<span class="hljs-string">&quot;Proportion Var&quot;</span>,<span class="hljs-string">&quot;Cumulative Var&quot;</span>)
+ B&lt;-matrix(<span class="hljs-number">0</span>, nrow=<span class="hljs-number">3</span>, ncol=m,
+           dimnames=list(rowname, colname))
+ <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:m){
+     B[<span class="hljs-number">1</span>,i]&lt;-sum(A[,i]^<span class="hljs-number">2</span>)
+     B[<span class="hljs-number">2</span>,i]&lt;-B[<span class="hljs-number">1</span>,i]/sum_rank
+     B[<span class="hljs-number">3</span>,i]&lt;-sum(B[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>:i])/sum_rank
+ }
+ method&lt;-c(<span class="hljs-string">&quot;Principal Factor Method&quot;</span>)
+ list(method=method, loadings=A,
+      var=cbind(common=h,spcific=diag_R-h),B=B,iterative=k)
+ }
&gt; d&lt;-c(<span class="hljs-number">0.123</span>, <span class="hljs-number">0.112</span>, <span class="hljs-number">0.155</span>, <span class="hljs-number">0.116</span>, <span class="hljs-number">0.073</span>)
&gt; fa&lt;-factor.analy2(cor(scaleBoys2018), m=<span class="hljs-number">2</span>, d); fa
</code></pre>
<pre><code>$method
[1] &quot;Principal Factor Method&quot;

$loadings
      Factor1     Factor2
X1 -0.8706010  0.03492217
X2 -0.8439718 -0.18236881
X3 -0.5721500  0.11626285
X4 -0.5250690 -0.47339608
X5 -0.6181748  0.49428846

$var
      common   spcific
X1 0.7591656 0.2408344
X2 0.7455468 0.2544532
X3 0.3408727 0.6591273
X4 0.4998013 0.5001987
X5 0.6264611 0.3735389

$B
                 Factor1   Factor2
SS loadings    2.4554277 0.5164199
Proportion Var 0.4910855 0.1032840
Cumulative Var 0.4910855 0.5943695

$iterative
[1] 20
</code></pre><pre><code class="lang-R">&gt; E&lt;- cor(scaleBoys2018)-fa$loadings %*% t(fa$loadings)-diag(fa$var[,<span class="hljs-number">2</span>])
&gt; sum(E^<span class="hljs-number">2</span>)
</code></pre>
<pre><code>[1] 0.001347586
</code></pre><h3 id="&#x6781;&#x5927;&#x4F3C;&#x7136;&#x6CD5;">&#x6781;&#x5927;&#x4F3C;&#x7136;&#x6CD5;</h3>
<p>&#x8BBE; <img src="https://latex.codecogs.com/gif.latex?F%20%5Csim%20N_m%280%2CI%29" alt="formula"> &#x4E14; <img src="https://latex.codecogs.com/gif.latex?%5Cepsilon%5Csim%20N_p%280%2CI%29" alt="formula"> &#x4E14; <img src="https://latex.codecogs.com/gif.latex?X_i%5Csim%20N_p%28%5Cmu%2C%5CSigma%29" alt="formula">&#xFF0C;&#x5373;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0Amax.L%28%5Coverline%7BX%7D%2CAA%5ET%2BVar%28%5Cepsilon%29%29%0A" alt="formula"></p>
<p>&#x8BB0; <img src="https://latex.codecogs.com/gif.latex?D%3DVar%28%5Cepsilon%29" alt="formula"> &#x53EF;&#x4EE5;&#x5F97;&#x5230;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Chat%7B%5CSigma%7D%5Chat%7BD%7D%5E%7B-1%7D%5Chat%7BA%7D%3D%5Chat%7BA%7D%28I%2B%5Chat%7BA%7D%5ET%5Chat%7BD%7D%5E%7B-1%7D%5Chat%7BA%7D%29%0A" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Chat%7BD%7D%3Ddiag%28%5Chat%7B%5CSigma%7D-%5Chat%7BA%7D%5Chat%7BA%7D%5ET%29%0A" alt="formula"></p>
<p>&#x5E76;&#x8BBE;&#x7F6E;&#x7EA6;&#x675F;
<img src="https://latex.codecogs.com/gif.latex?%0AA%5ETDA%3Ddiag%0A" alt="formula">
&#x5177;&#x4F53;&#x7B97;&#x6CD5;&#x89E3;&#x7531;&#x8FED;&#x4EE3;&#x6CD5;&#x8BA1;&#x7B97;</p>
<pre><code class="lang-R">&gt; factor.analy3&lt;-<span class="hljs-keyword">function</span>(S, m, d){
+     p&lt;-nrow(S); diag_S&lt;-diag(S); sum_rank&lt;-sum(diag_S)
+     rowname&lt;-paste(<span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-number">1</span>:p, sep=<span class="hljs-string">&quot;&quot;</span>)
+ colname&lt;-paste(<span class="hljs-string">&quot;Factor&quot;</span>, <span class="hljs-number">1</span>:m, sep=<span class="hljs-string">&quot;&quot;</span>)
+ A&lt;-matrix(<span class="hljs-number">0</span>, nrow=p, ncol=m,
+           dimnames=list(rowname, colname))
+ kmax=<span class="hljs-number">20</span>; k&lt;-<span class="hljs-number">1</span>
+ <span class="hljs-keyword">repeat</span>{
+     d1&lt;-d; d2&lt;-<span class="hljs-number">1</span>/sqrt(d); eig&lt;-eigen(S * (d2 %o% d2))
+     <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:m)
+         A[,i]&lt;-sqrt(eig$values[i]-<span class="hljs-number">1</span>)*eig$vectors[,i]
+     A&lt;-diag(sqrt(d)) %*% A
+     d&lt;-diag(S-A%*%t(A))
+     <span class="hljs-keyword">if</span> ((sqrt(sum((d-d1)^<span class="hljs-number">2</span>))&lt;<span class="hljs-number">1e-4</span>)|k==kmax) <span class="hljs-keyword">break</span>
+     k&lt;-k+<span class="hljs-number">1</span>
+ }
+ rowname&lt;-c(<span class="hljs-string">&quot;SS loadings&quot;</span>,<span class="hljs-string">&quot;Proportion Var&quot;</span>,<span class="hljs-string">&quot;Cumulative Var&quot;</span>)
+ B&lt;-matrix(<span class="hljs-number">0</span>, nrow=<span class="hljs-number">3</span>, ncol=m,
+           dimnames=list(rowname, colname))
+ <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:m){
+     B[<span class="hljs-number">1</span>,i]&lt;-sum(A[,i]^<span class="hljs-number">2</span>)
+     B[<span class="hljs-number">2</span>,i]&lt;-B[<span class="hljs-number">1</span>,i]/sum_rank
+     B[<span class="hljs-number">3</span>,i]&lt;-sum(B[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>:i])/sum_rank
+ }
+ method&lt;-c(<span class="hljs-string">&quot;Maximum Likelihood Method&quot;</span>)
+ list(method=method, loadings=A,
+      var=cbind(common=diag_S-d, spcific=d),B=B,iterative=k)
+ }
&gt; fa&lt;-factor.analy3(cor(scaleBoys2018), m=<span class="hljs-number">2</span>, d); fa
</code></pre>
<pre><code>$method
[1] &quot;Maximum Likelihood Method&quot;

$loadings
       Factor1     Factor2
[1,] 0.8230378  0.23603418
[2,] 0.7653671  0.44357989
[3,] 0.5633648  0.08505277
[4,] 0.3910765  0.50104399
[5,] 0.8124306 -0.45102567

$var
              common   spcific
height     0.7331034 0.2668966
armSpan    0.7825500 0.2174500
footLength 0.3246139 0.6753861
legLength  0.4039859 0.5960141
weight     0.8634677 0.1365323

$B
                 Factor1   Factor2
SS loadings    2.3935423 0.7141785
Proportion Var 0.4787085 0.1428357
Cumulative Var 0.4787085 0.6215442

$iterative
[1] 20
</code></pre><pre><code class="lang-R">&gt; E&lt;- cor(scaleBoys2018)-fa$loadings %*% t(fa$loadings)-diag(fa$var[,<span class="hljs-number">2</span>])
&gt; sum(E^<span class="hljs-number">2</span>)
</code></pre>
<pre><code>[1] 0.0005410666
</code></pre><p>&#x53EF;&#x89C1;&#x635F;&#x5931;&#x6BD4;&#x8F83;&#x5C0F;</p>
<h3 id="&#x65B9;&#x5DEE;&#x6700;&#x5927;&#x5316;&#x6B63;&#x4EA4;&#x65CB;&#x8F6C;">&#x65B9;&#x5DEE;&#x6700;&#x5927;&#x5316;&#x6B63;&#x4EA4;&#x65CB;&#x8F6C;</h3>
<p>&#x4E3A;&#x4E86;&#x53D8;&#x91CF;&#x66F4;&#x597D;&#x7684;&#x89E3;&#x91CA;&#x6027;&#xFF0C;&#x4EE4; <img src="https://latex.codecogs.com/gif.latex?Z%3D%5CGamma%5ETF" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AX%3DA%5CGamma%20Z%2B%5Cepsilon%0A" alt="formula"></p>
<p>&#x4E14; <img src="https://latex.codecogs.com/gif.latex?Var%28Z%29%3DI_m" alt="formula"> &#xFF0C;<img src="https://latex.codecogs.com/gif.latex?Cov%28Z%2C%5Cepsilon%29%3D0" alt="formula">&#xFF0C;&#x5BF9;A&#x6765;&#x8BF4;&#xFF0C;&#x5217;&#x65B9;&#x5DEE;&#x8D8A;&#x5927;&#xFF0C;F&#x7ED3;&#x6784;&#x8D8A;&#x8D8B;&#x4E8E;&#x7B80;&#x5355;&#xFF0C;&#x6211;&#x4EEC;&#x5B9A;&#x4E49; <img src="https://latex.codecogs.com/gif.latex?d_%7Bij%7D%5E2%3D%5Cfrac%7Ba_%7Bij%7D%5E2%7D%7Bh_i%5E2%7D" alt="formula"> &#x5176;&#x65B9;&#x5DEE;&#x4E3A;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AV%3D%5Csum%20V_i%3D%5Cfrac%7B1%7D%7Bp%5E2%7D%5Csum%5B%7Bp%5Csum%7B%5Cfrac%7Ba_%7Bij%7D%5E4%7D%7Bh_i%5E4%7D%7D%7D-%28%5Csum%7B%5Cfrac%7Ba_%7Bij%7D%5E2%7D%7Bh_i%5E2%7D%7D%29%5E2%5D%0A" alt="formula"></p>
<p> &#x56E0;&#x6B64;&#x5BF9;&#x4E8E;&#x4E0D;&#x540C;&#x7684;m&#xFF0C;&#x53D6;&#x6B63;&#x4EA4;&#x77E9;&#x9635; <img src="https://latex.codecogs.com/gif.latex?%5CGamma" alt="formula"> &#x505A; <img src="https://latex.codecogs.com/gif.latex?F" alt="formula"> &#x7684;&#x65CB;&#x8F6C;&#xFF0C;&#x4F7F; <img src="https://latex.codecogs.com/gif.latex?V" alt="formula"> &#x6700;&#x5927;&#xFF0C;&#x89E3;&#x6CD5;&#x7565;</p>
<pre><code class="lang-R">&gt; fa&lt;-factor.analy1(cor(scaleBoys2018), m=<span class="hljs-number">2</span>)
&gt; vm1&lt;-varimax(fa$loadings, normalize = <span class="hljs-literal">F</span>); vm1
</code></pre>
<pre><code>$loadings

Loadings:
   Factor1 Factor2
X1 -0.695  -0.550 
X2 -0.546  -0.697 
X3 -0.700  -0.248 
X4         -0.932 
X5 -0.885         

               Factor1 Factor2
SS loadings      2.054   1.720
Proportion Var   0.411   0.344
Cumulative Var   0.411   0.755

$rotmat
           [,1]      [,2]
[1,]  0.7680910 0.6403407
[2,] -0.6403407 0.7680910
</code></pre><p>&#x5F53;&#x7136;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;<code>factanal</code></p>
<pre><code class="lang-R">&gt; fa&lt;-factanal(factors=<span class="hljs-number">2</span>, covmat=cor(scaleBoys2018)); fa
</code></pre>
<pre><code>Call:
factanal(factors = 2, covmat = cor(scaleBoys2018))

Uniquenesses:
    height    armSpan footLength  legLength     weight 
     0.263      0.218      0.672      0.587      0.190 

Loadings:
           Factor1 Factor2
height     0.654   0.556  
armSpan    0.796   0.385  
footLength 0.382   0.427  
legLength  0.642          
weight             0.894  

               Factor1 Factor2
SS loadings      1.628   1.441
Proportion Var   0.326   0.288
Cumulative Var   0.326   0.614

The degrees of freedom for the model is 1 and the fit was 6e-04
</code></pre><p>&#x6BCF;&#x4E2A;&#x56E0;&#x5B50;&#x5B9E;&#x9645;&#x4E0A;&#x5360;&#x6709;&#x7684;&#x5C5E;&#x6027;&#x6210;&#x5206;&#x591A;&#xFF0C;&#x6240;&#x4EE5;&#x6BD4;&#x8F83;&#x96BE;&#x8FDB;&#x884C;&#x5BF9;&#x56E0;&#x5B50;&#x7684;&#x5F52;&#x7C7B;&#xFF0C;&#x53EF;&#x4EE5;&#x5927;&#x81F4;&#x8BA4;&#x4E3A;&#x4E24;&#x4E2A;&#x56E0;&#x5B50;&#x90FD;&#x8BF4;&#x660E;&#x4E86;&#x4EBA;&#x7684;&#x4F53;&#x6001;</p>
<h3 id="&#x56E0;&#x5B50;&#x5F97;&#x5206;">&#x56E0;&#x5B50;&#x5F97;&#x5206;</h3>
<p>&#x6211;&#x4EEC;&#x5F97;&#x5230;&#x56E0;&#x5B50;&#x77E9;&#x9635;&#x540E;&#x53EF;&#x4EE5;&#x53CD;&#x8FC7;&#x6765;&#x8BC4;&#x4F30;&#x6BCF;&#x4E2A;&#x6837;&#x672C;&#x7684;&#x5206;&#x6570;&#xFF0C;&#x73B0;&#x5728;&#x5BF9;&#x56E0;&#x5B50;&#x77E9;&#x9635;&#x8FDB;&#x884C;&#x4F30;&#x8BA1;</p>
<h4 id="&#x6700;&#x5C0F;&#x4E8C;&#x4E58;&#x6CD5;">&#x6700;&#x5C0F;&#x4E8C;&#x4E58;&#x6CD5;</h4>
<p>&#x4EE4;&#x52A0;&#x6743;&#x6700;&#x5C0F;&#x4E8C;&#x4E58;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Cphi%28F%29%3D%28X-AF%29%5ETD%5E%7B-1%7D%28X-AF%29%0A" alt="formula"></p>
<p>&#x6C42;&#x5BFC;&#x540E;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Chat%7BF%7D%3D%28A%5ETD%5E%7B-1%7DA%29%5E%7B-1%7DA%5ETD%5E%7B-1%7DX%0A" alt="formula"></p>
<p>&#x53C8;&#x79F0;&#x4E3A; Bartlett &#x65B9;&#x6CD5;</p>
<h4 id="&#x56DE;&#x5F52;&#x6CD5;">&#x56DE;&#x5F52;&#x6CD5;</h4>
<p>&#x4EE4;&#x5F97;&#x5206;&#x51FD;&#x6570;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AF%3D%5Cbeta%20X%0A" alt="formula"></p>
<p>&#x5BB9;&#x6613;&#x6C42;&#x5F97;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AB%3DA%5ETR%5E%7B-1%7D%0A" alt="formula"></p>
<p>&#x6545;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Chat%7BF%7D%3DA%5ETR%5E%7B-1%7DX%0A" alt="formula"></p>
<p>&#x91C7;&#x53D6;&#x56DE;&#x5F52;&#x6CD5;</p>
<pre><code class="lang-R">&gt; fa&lt;-factanal(~., factors=<span class="hljs-number">2</span>, data=filboys2018, scores=<span class="hljs-string">&quot;regression&quot;</span>)
&gt; plot(fa$scores[, <span class="hljs-number">1</span>:<span class="hljs-number">2</span>], type=<span class="hljs-string">&quot;n&quot;</span>)
&gt; text(fa$scores[,<span class="hljs-number">1</span>], fa$scores[,<span class="hljs-number">2</span>])
</code></pre>
<p><img src="img/F.png" alt="F"></p>
<p>&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x77E5;&#x9053;&#x4E8C;&#x53F7;&#x56E0;&#x5B50;&#x6BD4;&#x8F83;&#x5927;&#x8BF4;&#x660E;&#x4F53;&#x91CD;&#x8EAB;&#x9AD8;&#x90FD;&#x5F88;&#x5927;&#xFF0C;&#x800C;16&#x53F7;&#x4F53;&#x91CD;91.5kg&#xFF0C;&#x5347;&#x9AD8;180cm&#xFF0C;&#x662F;&#x5F88;&#x539A;&#x5B9E;&#x7684;&#x4E00;&#x4E2A;&#x4EBA;</p>
<h2 id="&#x5178;&#x578B;&#x76F8;&#x5173;&#x5206;&#x6790;">&#x5178;&#x578B;&#x76F8;&#x5173;&#x5206;&#x6790;</h2>
<p>&#x5BF9;&#x4E8E;&#x4E24;&#x7EC4;&#x53D8;&#x91CF;<img src="https://latex.codecogs.com/gif.latex?X%3D%28X_1%2CX_2%2C...X_p%29" alt="formula">&#x4E0E;<img src="https://latex.codecogs.com/gif.latex?Y%3D%28Y_1%2CY_2%2C...Y_q%29" alt="formula">&#xFF0C;&#x6211;&#x4EEC;&#x5E0C;&#x671B;&#x80FD;&#x591F;&#x627E;&#x5230;a&#x548C;b&#x80FD;&#x591F;
<img src="https://latex.codecogs.com/gif.latex?%0Amax.r%28a%5ETX%2Cb%5ETY%29%0A" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0As.t.Var%28a%5ETX%29%3D1%0A" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AVar%28b%5ETY%29%3D1%0A" alt="formula"></p>
<p>&#x8BB0; <img src="https://latex.codecogs.com/gif.latex?Z%3D%28X%5Cquad%20Y%29%5ET" alt="formula"> &#x6709;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Cbegin%7Bbmatrix%7D%0A%5CSigma_%7B11%7D%20%26%20%5CSigma_%7B12%7D%5C%5C%0A%5CSigma_%7B21%7D%20%26%20%5CSigma_%7B22%7D%0A%5Cend%7Bbmatrix%7D%0A" alt="formula"></p>
<p>&#x8BBE;Lagrange&#x51FD;&#x6570;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AL%28a%2Cb%2C%5Clambda%29%3Da%5ET%5CSigma_%7B12%7Db-%5Cfrac%7B%5Clambda_1%7D%7B2%7D%28a%5ET%5CSigma_%7B11%7Da-1%29-%5Cfrac%7B%5Clambda_2%7D%7B2%7D%28b%5ET%5CSigma_%7B22%7Db-1%29%0A" alt="formula"></p>
<p>&#x6C42;&#x5BFC;&#x53EF;&#x89E3;&#x5F97; <img src="https://latex.codecogs.com/gif.latex?%5Clambda_1%3D%5Clambda_2%3D%5Clambda" alt="formula">&#xFF0C;&#x6709; <img src="https://latex.codecogs.com/gif.latex?%5Clambda%5E2a%3D%5CSigma_%7B11%7D%5E%7B-1%7D%5CSigma_%7B12%7D%5CSigma_%7B22%7D%5E%7B-1%7D%5CSigma_%7B21%7Da%3DM_1a" alt="formula"> &#x548C; <img src="https://latex.codecogs.com/gif.latex?%5Clambda%5E2b%3D%5CSigma_%7B22%7D%5E%7B-1%7D%5CSigma_%7B21%7D%5CSigma_%7B11%7D%5E%7B-1%7D%5CSigma_%7B12%7Da%3DM_1a" alt="formula"> &#x53E6;&#x4E00;&#x65B9;&#x9762;&#x53EF;&#x6C42;&#x5F97;&#x7EA6;&#x675F; <img src="https://latex.codecogs.com/gif.latex?%7C%7C%5CSigma_%7B11%7D%5E%7B1/2%7Da%7C%7C%3D1" alt="formula"> &#x548C; <img src="https://latex.codecogs.com/gif.latex?%7C%7C%5CSigma_%7B22%7D%5E%7B1/2%7Db%7C%7C%3D1" alt="formula"></p>
<p>&#x73B0;&#x8BA1;&#x7B97;&#x5178;&#x578B;&#x53D8;&#x91CF;&#xFF0C;&#x5BF9; <img src="https://latex.codecogs.com/gif.latex?M_1" alt="formula">&#x7684;&#x7B2C;k&#x7279;&#x5F81; <img src="https://latex.codecogs.com/gif.latex?%5Clambda_k%5E2" alt="formula">&#x548C;&#x7279;&#x5F81;&#x5411;&#x91CF; <img src="https://latex.codecogs.com/gif.latex?a_k" alt="formula">&#x6709; </p>
<p><img src="https://latex.codecogs.com/gif.latex?%0Ab_k%3D%5CSigma_%7B22%7D%5E%7B-1%7D%5CSigma_%7B21%7Da_k%0A" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Calpha_k%3Da_k/%5Csqrt%7Ba_k%5ET%5CSigma_%7B11%7Da_k%7D%0A" alt="formula"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%0A%5Cbeta_k%3Db_k/%5Csqrt%7Bb_k%5ET%5CSigma_%7B22%7Db_k%7D%0A" alt="formula"></p>
<p> &#x8FD9;&#x91CC;&#x8BB0; <img src="https://latex.codecogs.com/gif.latex?%5Clambda_k" alt="formula"> &#x4E3A;&#x5178;&#x578B;&#x76F8;&#x5173;&#x7CFB;&#x6570;&#xFF0C;<img src="https://latex.codecogs.com/gif.latex?U_k%3Da_k%5ETX" alt="formula"> &#x4E0E; <img src="https://latex.codecogs.com/gif.latex?V_k%3Db_k%5ETY" alt="formula"> &#x4E3A;&#x5178;&#x578B;&#x53D8;&#x91CF;</p>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x7528;2018&#x5E74;&#x6807;&#x51C6;&#x5316;&#x7684;&#x7537;&#x751F;&#x6570;&#x636E;&#x524D;&#x56DB;&#x9879;&#xFF08;&#x5404;&#x4E24;&#x9879;&#xFF09;&#x505A;&#x5206;&#x6790;</p>
<pre><code class="lang-R">&gt; ca&lt;-cancor(scaleBoys2018[,<span class="hljs-number">1</span>:<span class="hljs-number">2</span>],scaleBoys2018[,<span class="hljs-number">3</span>:<span class="hljs-number">4</span>])
&gt; ca
</code></pre>
<pre><code>$cor
[1] 0.6564941 0.1045604

$xcoef
              [,1]       [,2]
height  0.04811195  0.1679480
armSpan 0.07878219 -0.1559316

$ycoef
                 [,1]        [,2]
footLength 0.07325025  0.09816096
legLength  0.07700732 -0.09524204

$xcenter
       height       armSpan 
-5.766992e-16  1.776477e-15 

$ycenter
   footLength     legLength 
 9.321247e-16 -2.444033e-16
</code></pre><p>&#x53EF;&#x89C1;&#x7B2C;&#x4E00;&#x5178;&#x578B;&#x53D8;&#x91CF;&#x76F8;&#x5173;&#x7CFB;&#x6570;&#x4E3A;0.65&#xFF0C;&#x7B2C;&#x4E8C;&#x4E3A;0.10&#xFF0C;&#x8FD9;&#x8FB9;&#x753B;&#x51FA;&#x7B2C;&#x4E00;&#x5178;&#x578B;&#x53D8;&#x91CF;&#x7684;&#x6563;&#x70B9;&#x56FE;</p>
<pre><code class="lang-R">&gt; U&lt;-as.matrix(scaleBoys2018[,<span class="hljs-number">1</span>:<span class="hljs-number">2</span>])%*% ca$xcoef
&gt; V&lt;-as.matrix(scaleBoys2018[,<span class="hljs-number">3</span>:<span class="hljs-number">4</span>])%*% ca$ycoef
&gt; plot(U[,<span class="hljs-number">1</span>], V[,<span class="hljs-number">1</span>], xlab=<span class="hljs-string">&quot;U1&quot;</span>, ylab=<span class="hljs-string">&quot;V1&quot;</span>)
</code></pre>
<p><img src="img/dianxing.png" alt="dianxing"></p>
<p>&#x7B26;&#x5408;&#x4E00;&#x5B9A;&#x7684;&#x76F8;&#x5173;&#x5173;&#x7CFB;</p>
<h2 id="model-analyse">Model Analyse</h2>
<blockquote>
<p>&#x5148;&#x7ED9;&#x51FA;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#x7684;&#x5206;&#x7C7B;&#x6A21;&#x578B;&#x5206;&#x6790;&#xFF0C;&#x4EE5;&#x540E;&#x518D;&#x8865;&#x5145;</p>
</blockquote>
<p><code>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x7EDF;&#x4E00;&#x4F7F;&#x7528;&#x76D1;&#x7763;&#x6A21;&#x578B;&#x505A;&#x4E8C;&#x5206;&#x7C7B;&#xFF0C;&#x9996;&#x5148;&#x5BF9;&#x6A21;&#x578B;&#x5B9A;&#x4E49;&#x8BC4;&#x4F30;&#x6807;&#x51C6;&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x662F;&#x7ED9;&#x51FA;&#x5206;&#x7C7B;&#x4E0B;&#x7684;&#x4E00;&#x4E2A;&#x8BC4;&#x4F30;&#x6807;&#x51C6;</code></p>
<p>&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x6240;&#x6709;&#x7684;&#x6A21;&#x578B;&#x4F7F;&#x7528;&#x7559;&#x51FA;&#x6CD5;&#xFF0C;&#x5373;2018&#x5E74;&#x7684;&#x6570;&#x636E;&#x4F5C;&#x4E3A;&#x8BAD;&#x7EC3;&#x96C6;&#xFF0C;2015&#x5E74;&#x7684;&#x6570;&#x636E;&#x4F5C;&#x4E3A;&#x6D4B;&#x8BD5;&#x96C6;</p>
<p><code>&#x6CE8;&#x610F;&#xFF1A;&#x6D4B;&#x8BD5;&#x96C6;&#x7684;&#x5206;&#x7C7B;&#x4E0D;&#x662F;&#x5F88;&#x5747;&#x5300;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x53EF;&#x80FD;&#x4F1A;&#x56E0;&#x4E3A;&#x5927;&#x90E8;&#x5206;&#x90FD;&#x9884;&#x6D4B;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x7C7B;&#x4ECD;&#x6709;&#x5F88;&#x9AD8;&#x7684;&#x5206;&#x6570;</code></p>
<p>&#x6211;&#x4EEC;&#x5C06;&#x8BB0;</p>
<table>
<thead>
<tr>
<th>&#x5B9A;&#x4E49;</th>
<th>&#x89E3;&#x91CA;</th>
</tr>
</thead>
<tbody>
<tr>
<td>TP</td>
<td>&#x6B63;&#x7C7B;&#x9884;&#x6D4B;&#x4E3A;&#x6B63;&#x7C7B;&#x6570;</td>
</tr>
<tr>
<td>FN</td>
<td>&#x6B63;&#x7C7B;&#x9884;&#x6D4B;&#x4E3A;&#x8D1F;&#x7C7B;&#x6570;</td>
</tr>
<tr>
<td>FP</td>
<td>&#x8D1F;&#x7C7B;&#x9884;&#x6D4B;&#x4E3A;&#x6B63;&#x7C7B;&#x6570;</td>
</tr>
<tr>
<td>TN</td>
<td>&#x8D1F;&#x7C7B;&#x9884;&#x6D4B;&#x4E3A;&#x8D1F;&#x7C7B;&#x6570;</td>
</tr>
</tbody>
</table>
<p>&#x7CBE;&#x786E;&#x7387;&#x5B9A;&#x4E49;&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?P%3D%5Cfrac%7BTP%7D%7BTP%2BFP%7D" alt="formula"> &#xFF0C;&#x53EC;&#x56DE;&#x7387;&#x5B9A;&#x4E49;&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?R%3D%5Cfrac%7BTP%7D%7BTP%2BFN%7D" alt="formula"> &#xFF0C;F1-score&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?F_1%3D%5Cfrac%7B2TP%7D%7B2TP%2BFP%2BFN%7D" alt="formula"></p>
<p>&#x8BC4;&#x4F30;&#x4F1A;&#x8F85;&#x4EE5; ROC &#x66F2;&#x7EBF;&#xFF0C;&#x5176;&#x4E2D;&#x6A2A;&#x8F74;&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?TPR%3D%5Cfrac%7BTP%7D%7BTP%2BFN%7D" alt="formula"> &#xFF0C;&#x7EB5;&#x8F74;&#x4E3A; <img src="https://latex.codecogs.com/gif.latex?FPR%3D%5Cfrac%7BFP%7D%7BFP%2BTN%7D" alt="formula"> &#xFF0C;&#x4E00;&#x822C;&#x6765;&#x8BF4;ROC&#x66F2;&#x7EBF;&#x9762;&#x79EF;&#x8D8A;&#x5927;&#x6548;&#x679C;&#x8D8A;&#x597D;&#xFF0C;&#x8FD9;&#x91CC;&#x4E0D;&#x505A;&#x4EE3;&#x4EF7;&#x654F;&#x611F;&#x9519;&#x8BEF;&#x7387;&#x7684;&#x68C0;&#x9A8C;</p>
<p><code>&#x9009;&#x7528;&#x5408;&#x9002;&#x7684;&#x5BF9;&#x4E8E;&#x8FDE;&#x7EED;&#x53D8;&#x91CF;&#x7684;&#x6709;&#x76D1;&#x7763;&#x4E8C;&#x5206;&#x7C7B;&#x6A21;&#x578B;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x8FD9;&#x6837;&#x6A21;&#x578B;&#x548C;&#x6A21;&#x578B;&#x7EC4;&#x5408;&#x5F88;&#x591A;&#x5F88;&#x591A;&#x5F88;&#x591A;&#x5F88;&#x591A;</code></p>
<h3 id="&#x903B;&#x8F91;&#x56DE;&#x5F52;">&#x903B;&#x8F91;&#x56DE;&#x5F52;</h3>
<blockquote>
<p>&#x57FA;&#x672C;&#x6A21;&#x578B;&#x540C;&#x4E0A;&#xFF0C;&#x8FD9;&#x91CC;&#x8FDB;&#x884C;&#x8FDB;&#x4E00;&#x6B65;&#x7684;&#x5206;&#x6790;</p>
</blockquote>
<pre><code class="lang-R">&gt; pre&lt;-predict(glm.sol, data.frame(height=classFil2015$height,footLength=classFil2015$footLength,legLength=classFil2015$legLength))
&gt; ypred&lt;-<span class="hljs-number">1</span>*(pre&gt;<span class="hljs-number">0.5</span>)
&gt; modelroc &lt;- roc(classFil2015$c,ypred)
&gt; plot(modelroc, print.auc=<span class="hljs-literal">TRUE</span>, auc.polygon=<span class="hljs-literal">TRUE</span>, grid=c(<span class="hljs-number">0.1</span>, <span class="hljs-number">0.2</span>),
+      grid.col=c(<span class="hljs-string">&quot;green&quot;</span>, <span class="hljs-string">&quot;red&quot;</span>), max.auc.polygon=<span class="hljs-literal">TRUE</span>,
+      auc.polygon.col=<span class="hljs-string">&quot;skyblue&quot;</span>, print.thres=<span class="hljs-literal">TRUE</span>)
</code></pre>
<p><img src="img/logistics.png" alt="logistics"></p>
<p>AUC&#x8FBE;&#x5230;0.91&#xFF0C;&#x8BF4;&#x660E;&#x5206;&#x7C7B;&#x6548;&#x679C;&#x5F88;&#x597D;</p>
<h3 id="k&#x8FD1;&#x90BB;">K&#x8FD1;&#x90BB;</h3>
<blockquote>
<p>&#x57FA;&#x672C;&#x7B97;&#x6CD5;&#x601D;&#x60F3;&#xFF1A;</p>
<p>1&#xFF09;&#x8BA1;&#x7B97;&#x6D4B;&#x8BD5;&#x6570;&#x636E;&#x4E0E;&#x5404;&#x4E2A;&#x8BAD;&#x7EC3;&#x6570;&#x636E;&#x4E4B;&#x95F4;&#x7684;&#x8DDD;&#x79BB;&#xFF0C;&#x8DDD;&#x79BB;&#x57FA;&#x672C;&#x4E3A;&#x805A;&#x7C7B;&#x4F7F;&#x7528;&#x7684;&#x8DDD;&#x79BB;</p>
<p>2&#xFF09;&#x6309;&#x7167;&#x8DDD;&#x79BB;&#x7684;&#x9012;&#x589E;&#x5173;&#x7CFB;&#x8FDB;&#x884C;&#x6392;&#x5E8F;</p>
<p>3&#xFF09;&#x9009;&#x53D6;&#x8DDD;&#x79BB;&#x6700;&#x5C0F;&#x7684;K&#x4E2A;&#x70B9;</p>
<p>4&#xFF09;&#x786E;&#x5B9A;&#x524D;K&#x4E2A;&#x70B9;&#x6240;&#x5728;&#x7C7B;&#x522B;&#x7684;&#x51FA;&#x73B0;&#x9891;&#x7387;</p>
<p>5&#xFF09;&#x8FD4;&#x56DE;&#x524D;K&#x4E2A;&#x70B9;&#x4E2D;&#x51FA;&#x73B0;&#x9891;&#x7387;&#x6700;&#x9AD8;&#x7684;&#x7C7B;&#x522B;&#x4F5C;&#x4E3A;&#x6D4B;&#x8BD5;&#x6570;&#x636E;&#x7684;&#x9884;&#x6D4B;&#x5206;&#x7C7B;</p>
</blockquote>
<p><code>KNN&#x5B9E;&#x73B0;&#x4E00;&#x822C;&#x4F7F;&#x7528;kd&#x6811;&#xFF0C;&#x8FD9;&#x91CC;&#x4E0D;&#x7ED9;&#x51FA;&#x5B9E;&#x73B0;</code></p>
<pre><code class="lang-R">&gt; model.kknn&lt;-kknn(c~.,classFil2018,classFil2015,distance=<span class="hljs-number">5</span>) <span class="hljs-comment"># &#x9ED8;&#x8BA4;&#x6B27;&#x5F0F;&#x8DDD;&#x79BB;</span>
&gt; fit &lt;- fitted(model.kknn)
&gt; pred&lt;-<span class="hljs-number">1</span>*(fit&gt;<span class="hljs-number">0.5</span>)
&gt; modelroc &lt;- roc(classFil2015$c,pred)
&gt; plot(modelroc, print.auc=<span class="hljs-literal">TRUE</span>, auc.polygon=<span class="hljs-literal">TRUE</span>, grid=c(<span class="hljs-number">0.1</span>, <span class="hljs-number">0.2</span>),
+            grid.col=c(<span class="hljs-string">&quot;green&quot;</span>, <span class="hljs-string">&quot;red&quot;</span>), max.auc.polygon=<span class="hljs-literal">TRUE</span>,
+            auc.polygon.col=<span class="hljs-string">&quot;skyblue&quot;</span>, print.thres=<span class="hljs-literal">TRUE</span>)
</code></pre>
<p><img src="img/knnn.png" alt="knnn"></p>
<p>AUC&#x8FBE;&#x5230;0.895&#xFF0C;&#x53EF;&#x89C1;&#x5206;&#x7C7B;&#x6548;&#x679C;&#x5F88;&#x597D;</p>
<h3 id="&#x51B3;&#x7B56;&#x6811;">&#x51B3;&#x7B56;&#x6811;</h3>
<p><code>&#x8FD9;&#x5757;&#x5185;&#x5BB9;&#x4E5F;&#x975E;&#x5E38;&#x591A;&#xFF0C;&#x9664;&#x4E86;&#x7ECF;&#x5178;&#x7684;&#x51B3;&#x7B56;&#x6811;&#xFF0C;&#x8FD8;&#x6709;&#x63D0;&#x5347;&#x6811;&#x8BF8;&#x5982;GBDT&#x7B49;&#xFF0C;&#x96C6;&#x6210;&#x6BD4;&#x5982;Random Forest&#xFF0C;&#x5EF6;&#x4F38;&#x6682;&#x7565;</code></p>
<p>&#x9996;&#x5148;&#x5148;&#x7ED9;&#x51FA;&#x51E0;&#x4E2A;&#x51B3;&#x7B56;&#x7684;&#x6807;&#x51C6;</p>
<p><strong>&#x4FE1;&#x606F;&#x589E;&#x76CA;</strong></p>
<p>&#x5047;&#x8BBE;&#x7B2C;k&#x7C7B;&#x6240;&#x5360;&#x6BD4;&#x4F8B;pk&#xFF0C;&#x5B9A;&#x4E49;&#x4FE1;&#x606F;&#x71B5;
<img src="https://latex.codecogs.com/gif.latex?%0AEnt%28D%29%3D-%5Csum%7Bp_klog_2p_k%7D%0A" alt="formula">
&#x5176;&#x8868;&#x793A;&#x6570;&#x636E;&#x7EAF;&#x5EA6;&#xFF0C;&#x8BB0;&#x96C6;&#x5408;
<img src="https://latex.codecogs.com/gif.latex?%0AT_a%3D%5C%7B%5Cfrac%7Ba_i%2Ba_%7Bi%2B1%7D%7D%7B2%7D%7C1%5Cle%20i%5Cle%20n-1%5C%7D%0A" alt="formula">
a&#x4E3A;&#x67D0;&#x4E00;&#x5C5E;&#x6027;&#x7684;&#x6240;&#x6709;&#x53D6;&#x503C;&#xFF0C;&#x5B9A;&#x4E49;&#x589E;&#x76CA;&#x7387;&#x4E3A;</p>
<p><img src="https://latex.codecogs.com/gif.latex?%0AGain%28D%2Ca%29%3D%5Cmax%5Climits_%7Bt%5Cin%20T_a%7DGain%28G%2Ca%2Ct%29%3D%5Cmax%5Climits_%7Bt%5Cin%20T_a%7DEnt%28D%29-%5Csum%5Climits_%7B%5Clambda%5Cin%20%5C%7B%2B%2C-%5C%7D%7D%5Cfrac%7B%7CD_t%5E%5Clambda%7C%7D%7B%7CD%7C%7DEnt%28D_t%5E%5Clambda%29%0A" alt="formula"></p>
<p>&#x5176;&#x4E2D; <img src="https://latex.codecogs.com/gif.latex?D%5E%5Clambda_t" alt="formula"> &#x4EE3;&#x8868;&#x5728;&#x70B9;t&#x5DE6;&#x4FA7;&#x6216;&#x53F3;&#x4FA7;&#x7684;&#x6837;&#x672C;&#xFF0C;&#x5373;&#x4EE5;&#x67D0;&#x4E00;&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x591A;&#x6B21;&#x4E8C;&#x5206;&#xFF0C;&#x8BA1;&#x7B97;&#x589E;&#x76CA;&#x7387;&#x6700;&#x5927;&#x7684;&#x4F5C;&#x4E3A;&#x5212;&#x5206;&#x8282;&#x70B9;</p>
<p><strong>&#x589E;&#x76CA;&#x7387;</strong></p>
<p>&#x7528;&#x4EE5;&#x51CF;&#x5C11;&#x53D6;&#x503C;&#x6570;&#x76EE;&#x7684;&#x5F71;&#x54CD;&#xFF0C;&#x5B9A;&#x4E49;&#x4E3A;
<img src="https://latex.codecogs.com/gif.latex?%0AGain%5C_ratio%28D%2Ca%29%3D%5Cfrac%7BGain%28D%2Ca%29%7D%7BIV%28a%29%7D%0A" alt="formula">
&#x5176;&#x4E2D;&#x79BB;&#x6563;&#x5C5E;&#x6027;&#x5B9A;&#x4E49;&#x4E3A;
<img src="https://latex.codecogs.com/gif.latex?%0AIV%28a%29%3D-%5Csum%5Climits_v%5Cfrac%7B%7CD%5Ev%7C%7D%7B%7CD%7C%7Dlog_2%5Cfrac%7B%7CD%5Ev%7C%7D%7B%7CD%7C%7D%0A" alt="formula">
&#x8FD9;&#x91CC; <img src="https://latex.codecogs.com/gif.latex?D%5Ev" alt="formula"> &#x53EF;&#x4EE5;&#x7528;&#x548C;&#x4E0A;&#x9762; <img src="https://latex.codecogs.com/gif.latex?D%5E%5Clambda" alt="formula"> &#x6539;&#x4E3A;&#x8FDE;&#x7EED;&#x503C;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x5206;&#x7BB1;&#x5C06;&#x8FDE;&#x7EED;&#x503C;&#x79BB;&#x6563;&#x5316;&#xFF0C;&#x5373;&#x5C06;&#x5C5E;&#x6027;&#x5206;&#x6210; |V|&#x4E2A;</p>
<p><strong>&#x57FA;&#x5C3C;&#x6307;&#x6570;</strong></p>
<p>&#x5176;&#x4EE3;&#x8868;&#x4E86;&#x4E00;&#x4E2A;&#x603B;&#x4F53;&#x4E2D;&#x968F;&#x673A;&#x62BD;&#x4E24;&#x4E2A;&#x6837;&#x672C;&#x4E0D;&#x4E00;&#x81F4;&#x7684;&#x6982;&#x7387;&#xFF0C;&#x57FA;&#x5C3C;&#x503C;&#x5B9A;&#x4E49;&#x4E3A;
<img src="https://latex.codecogs.com/gif.latex?%0AGini%28D%29%3D%5Csum%5Climits_%7Bk%7D%5Csum%5Climits_%7Bk%27%5Cne%20k%7Dp_kp_%7Bk%27%7D%0A" alt="formula">
&#x56E0;&#x800C;&#x57FA;&#x5C3C;&#x6307;&#x6570;&#x79BB;&#x6563;&#x5F62;&#x5F0F;&#x4E3A;
<img src="https://latex.codecogs.com/gif.latex?%0AGini%5C_index%28D%2Ca%29%3D%5Csum%5Cfrac%7B%7CD%5Ev%7C%7D%7B%7CD%7C%7DGini%28D%5Ev%29%0A" alt="formula"></p>
<p>&#x4E00;&#x822C;&#x7684;&#x51B3;&#x7B56;&#x6811;&#x7B97;&#x6CD5;&#xFF1A;</p>
<ol>
<li>&#x4ECE;&#x6839;&#x8282;&#x70B9;&#x5F00;&#x59CB;&#xFF0C;&#x5BF9;&#x8282;&#x70B9;&#x8BA1;&#x7B97;&#x6240;&#x6709;&#x53EF;&#x80FD;&#x7684;&#x7279;&#x5F81;&#x7684;&#x4FE1;&#x606F;&#x589E;&#x76CA;&#xFF0C;&#x9009;&#x62E9;&#x6700;&#x4F73;&#x7279;&#x5F81;&#x4F5C;&#x4E3A;&#x8282;&#x70B9;&#x7684;&#x5212;&#x5206;&#x7279;&#x5F81;&#xFF1B;</li>
<li>&#x7531;&#x8BE5;&#x7279;&#x5F81;&#x7684;&#x4E0D;&#x540C;&#x53D6;&#x503C;&#x5EFA;&#x7ACB;&#x5B50;&#x8282;&#x70B9;&#xFF1B;</li>
<li>&#x518D;&#x5BF9;&#x5B50;&#x8282;&#x70B9;&#x9012;&#x5F52;&#x5730;&#x8C03;&#x7528;&#x4EE5;&#x4E0A;&#x65B9;&#x6CD5;&#xFF0C;&#x6784;&#x5EFA;&#x51B3;&#x7B56;&#x6811;&#xFF1B;</li>
<li>&#x5230;&#x6240;&#x6709;&#x7279;&#x5F81;&#x7684;&#x4FE1;&#x606F;&#x589E;&#x76CA;&#x90FD;&#x5F88;&#x5C0F;&#x6216;&#x8005;&#x6CA1;&#x6709;&#x7279;&#x5F81;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x4E3A;&#x6B62;&#xFF0C;&#x5F97;&#x5230;&#x6700;&#x7EC8;&#x7684;&#x51B3;&#x7B56;&#x6811;</li>
</ol>
<p><code>&#x51B3;&#x7B56;&#x6811;&#x8FD8;&#x5305;&#x542B;&#x526A;&#x679D;&#x5904;&#x7406;,&#x53EF;&#x4EE5;&#x7528;prune&#x8FDB;&#x884C;&#x526A;&#x679D;</code></p>
<h4 id="c50">C5.0</h4>
<p>&#x4EE5;&#x4FE1;&#x606F;&#x589E;&#x76CA;&#x7387;&#x4E3A;&#x6807;&#x51C6;</p>
<pre><code>&gt; credit_model&lt;-C5.0(x = classFil2018[,1:5],y = as.factor(classFil2018$c))
&gt; credit_pred&lt;-predict(object = credit_model,newdata = classFil2015[,1:5])
&gt; credit&lt;-as.numeric(credit_pred)
&gt; modelroc &lt;- roc(classFil2015$c,credit)
&gt; plot(modelroc, print.auc=TRUE, auc.polygon=TRUE, grid=c(0.1, 0.2),
+                    grid.col=c(&quot;green&quot;, &quot;red&quot;), max.auc.polygon=TRUE,
+                    auc.polygon.col=&quot;skyblue&quot;, print.thres=TRUE)
</code></pre><p><img src="img/C5.0.png" alt="C5.0"></p>
<h4 id="cart">CART</h4>
<p>&#x4EE5;&#x57FA;&#x5C3C;&#x6307;&#x6570;&#x4E3A;&#x6807;&#x51C6;</p>
<pre><code class="lang-R">&gt; dtree&lt;-rpart(c~.,data=classFil2018,method=<span class="hljs-string">&quot;class&quot;</span>, parms=list(split=<span class="hljs-string">&quot;information&quot;</span>))
&gt; predtree&lt;-predict(dtree,newdata=classFil2015[,<span class="hljs-number">1</span>:<span class="hljs-number">5</span>],type=<span class="hljs-string">&quot;class&quot;</span>)
&gt;  modelroc &lt;- roc(classFil2015$c,as.numeric(predtree))
&gt;  plot(modelroc, print.auc=<span class="hljs-literal">TRUE</span>, auc.polygon=<span class="hljs-literal">TRUE</span>, grid=c(<span class="hljs-number">0.1</span>, <span class="hljs-number">0.2</span>),
+                            grid.col=c(<span class="hljs-string">&quot;green&quot;</span>, <span class="hljs-string">&quot;red&quot;</span>), max.auc.polygon=<span class="hljs-literal">TRUE</span>,
+                            auc.polygon.col=<span class="hljs-string">&quot;skyblue&quot;</span>, print.thres=<span class="hljs-literal">TRUE</span>)
</code></pre>
<p><img src="img/tree.png" alt="tree"></p>
<p>&#x53EF;&#x89C1;&#x51B3;&#x7B56;&#x6811;&#x5206;&#x7C7B;&#x6548;&#x679C;&#x5F88;&#x597D;</p>
<h3 id="svm">SVM</h3>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x4E3B;&#x8981;&#x6307;&#x4E8C;&#x5143;SVM</p>
</blockquote>
<p>SVM&#x901A;&#x8FC7;&#x628A;&#x4E24;&#x4E2A;&#x7C7B;&#x522B;&#x6700;&#x63A5;&#x8FD1;&#x7684;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x8FB9;&#x7F18;&#x6700;&#x5927;&#x5316;&#x6765;&#x5BFB;&#x627E;&#x5206;&#x5272;&#x4E24;&#x4E2A;&#x7C7B;&#x522B;&#x7684;&#x6700;&#x4F18;&#x5E73;&#x9762;&#x3002;&#x8D85;&#x5E73;&#x9762;&#x65B9;&#x7A0B;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x4E3A;
<img src="https://latex.codecogs.com/gif.latex?%0A%5Cvec%7Bw%7D%5ET%5Cvec%7Bx%7D%2B%5Cvec%7Bb%7D%3D0%0A" alt="formula">
&#x5B9A;&#x4E49;&#x4E8C;&#x5206;&#x7C7B;&#x6A21;&#x578B;
<img src="https://latex.codecogs.com/gif.latex?%0Af%28%5Cvec%7Bx%7D%29%3Dsign%28%5Cvec%7Bw%7D%5ET%5Cvec%7Bx%7D%2B%5Cvec%7Bb%7D%29%0A" alt="formula">
&#x5219;&#x5F97;&#x5230;Lagrange&#x7EA6;&#x675F;
<img src="https://latex.codecogs.com/gif.latex?%0AL%3D%5Cfrac%7B%7C%7C%5Cvec%7Bw%7D%7C%7C%5E2%7D%7B2%7D-%5Csum%20a_i%28y_i%28%5Cvec%7Bw%7D%5ET%20%5Cvec%7Bx_i%7D%2B%5Cvec%7Bb%7D%29-1%29%0A" alt="formula">
&#x6C42;&#x504F;&#x5BFC;&#x53EF;&#x5F97;&#x5230;
<img src="https://latex.codecogs.com/gif.latex?%0A%5Cvec%7Bw%7D%3D%5Csum%7Ba_i%20y_i%20%5Cvec%7Bx_i%7D%7D%0A" alt="formula">
<img src="https://latex.codecogs.com/gif.latex?%0A%5Csum%20a_i%20y_i%3D0%0A" alt="formula">
&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x5BF9;&#x5076;&#x95EE;&#x9898;
<img src="https://latex.codecogs.com/gif.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Barray%7D%7Blr%7D%0Amax_a.%5Csum%20a_i-%5Csum%20%5Csum%20a_i%20a_j%20y_i%20y_j%20%5Cvec%7Bx_i%7D%5ET%5Cvec%7Bx_j%7D%20%5C%5C%0As.t.%20a_i%5Cge0%2Ci%3D1%2C2...%2Cn%5C%5C%0A%5Csum%20a_iy_i%3D0%0A%5Cend%7Barray%7D%0A%5Cright.%0A" alt="formula"></p>
<p>&#x8FD9;&#x4E2A;&#x662F;&#x4E00;&#x4E2A;&#x89C4;&#x5212;&#x95EE;&#x9898;&#xFF0C;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x4E00;&#x7CFB;&#x5217;&#x8FED;&#x4EE3;&#x7B97;&#x6CD5;&#x8B6C;&#x5982;SMO&#x89E3;&#x51FA;a</p>
<pre><code class="lang-R">&gt; svm.model&lt;-svm(formula=c~.,data=classFil2018,type=<span class="hljs-string">&quot;C-classification&quot;</span>,kernal=<span class="hljs-string">&quot;polynomial&quot;</span>,gamma=<span class="hljs-number">1</span>,cost=<span class="hljs-number">100</span>)
&gt; pred&lt;-predict(svm.model,classFil2015[,<span class="hljs-number">1</span>:<span class="hljs-number">5</span>])
&gt;  modelroc &lt;- roc(classFil2015$c,as.numeric(pred))
&gt;  plot(modelroc, print.auc=<span class="hljs-literal">TRUE</span>, auc.polygon=<span class="hljs-literal">TRUE</span>, grid=c(<span class="hljs-number">0.1</span>, <span class="hljs-number">0.2</span>),
+                            grid.col=c(<span class="hljs-string">&quot;green&quot;</span>, <span class="hljs-string">&quot;red&quot;</span>), max.auc.polygon=<span class="hljs-literal">TRUE</span>,
+                            auc.polygon.col=<span class="hljs-string">&quot;skyblue&quot;</span>, print.thres=<span class="hljs-literal">TRUE</span>)
</code></pre>
<p><img src="img/svm.png" alt="svm"></p>
<p>SVM&#x5728;&#x6B64;&#x6D4B;&#x8BD5;&#x96C6;&#x4E0A;&#x6548;&#x679C;&#x6CA1;&#x6709;&#x51B3;&#x7B56;&#x6811;&#x597D;</p>
<h2 id="&#x53C2;&#x8003;">&#x53C2;&#x8003;</h2>
<ol>
<li>&#x7EDF;&#x8BA1;&#x5EFA;&#x6A21;&#x4E0E;&#xFF32;&#x8F6F;&#x4EF6;</li>
<li>&#x673A;&#x5668;&#x5B66;&#x4E60;&#xFF0C;&#x5468;&#x5FD7;&#x534E;</li>
<li>R&#x8BED;&#x8A00;&#x4E0E;&#x673A;&#x5668;&#x5B66;&#x4E60;</li>
</ol>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: STATISTICS">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="statistics-formulas.html" class="navigation navigation-next " aria-label="Next page: statistics formulas">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"statistics using R","level":"2.1.1","depth":2,"next":{"title":"statistics formulas","level":"2.1.2","depth":2,"path":"statistics/statistics-formulas.md","ref":"statistics/statistics-formulas.md","articles":[]},"previous":{"title":"STATISTICS","level":"2.1","depth":1,"path":"statistics/README.md","ref":"statistics/README.md","articles":[{"title":"statistics using R","level":"2.1.1","depth":2,"path":"statistics/statistics-using-R.md","ref":"statistics/statistics-using-R.md","articles":[]},{"title":"statistics formulas","level":"2.1.2","depth":2,"path":"statistics/statistics-formulas.md","ref":"statistics/statistics-formulas.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"statistics/statistics-using-R.md","mtime":"2020-08-10T07:36:01.707Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-08-23T12:12:28.145Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

